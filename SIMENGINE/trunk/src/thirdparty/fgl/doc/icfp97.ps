%!PS-Adobe-2.0
%%Creator: dvips 5.58 Copyright 1986, 1994 Radical Eye Software
%%Title: fpg.dvi
%%CreationDate: Tue Jul  8 09:05:08 1997
%%Pages: 14
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%EndComments
%DVIPSCommandLine: dvips -o fpg.ps fpg
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1997.07.08:0904
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 39158280 55380996 1000 300 300
(/home/erwig/Papers/Gr/fpg.dvi) @start /Fa 34 122 df<01F8F00607380C0E38
180610180600180600180600FFFFC0180600180600180600180600180600180600180600
1806001806001806001806007E1FC01514809314>11 D<40E06020202040408003097D82
09>44 D<40E04003037D8209>46 D<1F0060C06060F070F030603000700070006000C001
C00180020004000810101020207FE0FFE00C137E9211>50 D<60607FC07F804400400040
0040004F0070C040E0006000700070E070E070E06040E021C01F000C137E9211>53
D<003000003000007800007800007800009C00009C00011E00010E00010E000207000207
0004038007FF800403800801C00801C01000E03800E0FE07FC16147F9319>65
D<FE000FE01E000F00170017001700170017001700138027001380270011C0470011C047
0010E0870010E0870010E087001071070010710700103A0700103A0700101C0700101C07
00381C0700FE083FE01B147F931E>77 D<FC01FC1E007017002017802013802011C02010
E020107020107020103820101C20100E20100F201007201003A01001E01000E01000E038
0060FE002016147F9319>I<7FFFF0607030407010407010807008807008807008007000
00700000700000700000700000700000700000700000700000700000700000700007FF00
15147F9318>84 D<FCFCC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FC
FC061D7E9509>91 D<FCFC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C
FCFC061D809509>93 D<7F00E1C0E0404060006007E038606060C060C064C06461E43E38
0E0D7E8C11>97 D<F00030003000300030003000300033E034103808300C300630063006
30063006300C3808343023E00F147F9312>I<0FE0187020706020C000C000C000C000C0
006000201018200FC00C0D7F8C0F>I<00780018001800180018001800180F9818782038
6018C018C018C018C018C0186018203810580F9E0F147F9312>I<0F80104020206030C0
10FFF0C000C000C0006000201018200FC00C0D7F8C0F>I<03C00CE018E0184018001800
1800FF00180018001800180018001800180018001800180018007F000B1480930A>I<0F
3C30E62040606060606060204030C02F00600060003FE03FF06018C00CC00CC00C601830
300FC00F147F8C11>I<F00030003000300030003000300033E034303818301830183018
301830183018301830183018FC7E0F147F9312>I<2070200000000000F0303030303030
3030303030FC06157F9409>I<F0303030303030303030303030303030303030FC06147F
9309>108 D<F3E1F0343218381C0C30180C30180C30180C30180C30180C30180C30180C
30180C30180CFC7E3F180D7F8C1B>I<F3E0343038183018301830183018301830183018
30183018FC7E0F0D7F8C12>I<0FC0186020106018C00CC00CC00CC00CC00C6018601838
700FC00E0D7F8C11>I<F3E034303808300C30063006300630063006300C3808343033E0
30003000300030003000FC000F137F8C12>I<0F88184820386018C018C018C018C018C0
186018203818580F9800180018001800180018007E0F137F8C11>I<F3C034E038E03040
30003000300030003000300030003000FE000B0D7F8C0D>I<3E806180C080C080E0007E
003F8003C080C080C0C0C0E1809F000A0D7F8C0D>I<10001000100030007000FF803000
30003000300030003000300030803080308011000E0009127F910D>I<F0783018301830
18301830183018301830183018303818580F9E0F0D7F8C12>I<F87C3018301018201820
18200C400C40068006800780030003000E0D7F8C11>I<F87CF870703030582030582018
8840188C40188C400D04800D06800D0680060300060300060300150D7F8C18>I<F87C30
3018600C400C800700030007800CC008E010603030F87C0E0D7F8C11>I<F87C30183010
1820182018200C400C400680068007800300030002000200E600E400E80070000E137F8C
11>I E /Fb 1 84 df<E000001CE000001CE000001CE000001CE000001CE000001CE000
001CE000001CE000001CE000001CE000001CE000001CE000001CE000001CE000001CE000
001CE000001CE000001CE000001CE000001CE000001CE000001CE000001CE000001CE000
001CE000001CE000001CE000001CE000001CE000001CE000001C70000038700000383800
0070380000701C0000E01E0001E00F8007C007E01F8001FFFE00007FF800001FE0001E2A
7E7F23>83 D E /Fc 1 32 df<000001000000030000000600003F860001FFFC0007C07C
000F001E001E003F003C0067803800C3807000C1C0700181C0E00300E0E00300E0E00600
E0E00C00E0E01800E0E01800E0703001C0706001C0386003803CC007801F800F000F001E
0007C07C0007FFF0000C3F80000C00000018000000100000001B1E7E9A20>31
D E /Fd 1 51 df<7FFFF0FFFFF8C00018C00018C00018C00018C00018C00018C00018C0
0018C00018C00018C00018C00018C00018C00018C00018C00018C00018FFFFF8FFFFF815
157D971C>50 D E /Fe 25 122 df<004000800300020006000C001C0018003800380070
00700070007000F000F000F000F000F000F000F000F000F0007000700070007000380038
0018001C000C00060002000300008000400A257C9B11>40 D<800040003000100018000C
000E00060007000700038003800380038003C003C003C003C003C003C003C003C003C003
800380038003800700070006000E000C00180010003000400080000A257E9B11>I<78FC
FCFCFC7806067D850C>46 D<00C003C0FFC0FFC003C003C003C003C003C003C003C003C0
03C003C003C003C003C003C003C003C003C003C07FFE7FFE0F187D9716>49
D<0FF0003FFC00787E00FC1F00FC1F80FC0F80FC0F80780F80001F80001F00001E00003C
0000780000700000E0000180000301800601800C01801003803FFF007FFF00FFFF00FFFF
0011187E9716>I<07F0001FFC00383E007C3E007C1F007C1F007C1F00383F00003E0000
3C0000780007F000003C00001E00001F00001F80781F80FC1F80FC1F80FC1F00F81F0070
3E003FFC000FF00011187E9716>I<001FE02000FFFCE003F80FE007C003E01F8001E01F
0000E03E0000E07E0000607C000060FC000000FC000000FC000000FC000000FC000000FC
000000FC000000FC0000007C0000607E0000603E0000601F0000C01F8000C007C0038003
F80F0000FFFC00001FF0001B1A7E9920>67 D<FFFFF000FFFFFC000F803F000F800F800F
8007C00F8003E00F8003E00F8001F00F8001F00F8001F80F8001F80F8001F80F8001F80F
8001F80F8001F80F8001F80F8001F80F8001F00F8001F00F8003F00F8003E00F8007C00F
800F800F803F00FFFFFE00FFFFF0001D1A7E9922>I<FFFFE000FFFFF8000F807E000F80
3F000F801F000F801F800F801F800F801F800F801F800F801F800F801F000F803E000F80
7C000FFFF8000F8000000F8000000F8000000F8000000F8000000F8000000F8000000F80
00000F8000000F800000FFF80000FFF80000191A7E991E>80 D<7FFFFF807FFFFF80781F
0780701F0380601F0180E01F01C0C01F00C0C01F00C0C01F00C0001F0000001F0000001F
0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F
0000001F0000001F0000001F000007FFFC0007FFFC001A1A7E991F>84
D<0FF0001C3C003E1E003E0E003E0F001C0F00000F0000FF000FCF003E0F007C0F00F80F
00F80F00F80F00F817007C27E01FC3E013117F9015>97 D<03F0000E1C001C0E003C0700
780700780780F80780F80780FFFF80F80000F800007800007800003C01801C03000E0600
03FC0011117F9014>101 D<00FE0003C700078F800F0F800F0F800F07000F00000F0000
0F0000FFF000FFF0000F00000F00000F00000F00000F00000F00000F00000F00000F0000
0F00000F00000F00000F00007FE0007FE000111A80990E>I<FE0000FE00001E00001E00
001E00001E00001E00001E00001E00001E1F001E63C01E81C01F01E01F01E01E01E01E01
E01E01E01E01E01E01E01E01E01E01E01E01E01E01E01E01E0FFCFFCFFCFFC161A7F9919
>104 D<1C003E003E003E003E001C0000000000000000007E007E001E001E001E001E00
1E001E001E001E001E001E001E001E001E00FF80FF80091B7F9A0D>I<FE00FE001E001E
001E001E001E001E001E001E001E001E001E001E001E001E001E001E001E001E001E001E
001E001E00FFC0FFC00A1A7F990D>108 D<FE1F01F000FE63C63C001E81C81C001F01F0
1E001F01F01E001E01E01E001E01E01E001E01E01E001E01E01E001E01E01E001E01E01E
001E01E01E001E01E01E001E01E01E001E01E01E00FFCFFCFFC0FFCFFCFFC022117F9025
>I<FE1F00FE63C01E81C01F01E01F01E01E01E01E01E01E01E01E01E01E01E01E01E01E
01E01E01E01E01E01E01E0FFCFFCFFCFFC16117F9019>I<03F8000E0E003C0780380380
7803C07803C0F803E0F803E0F803E0F803E0F803E0F803E07803C07C07C03C07800E0E00
03F80013117F9016>I<FE7F00FFC3C01F01E01E00F01E00F81E00781E007C1E007C1E00
7C1E007C1E007C1E00781E00F81E00F01F01E01F83C01E7F001E00001E00001E00001E00
001E0000FFC000FFC00016187F9019>I<FC78FC9C1D3E1D3E1E3E1E1C1E001E001E001E
001E001E001E001E001E00FFC0FFC00F117F9012>114 D<1FB020704030C030C030F000
FF807FE03FF807F8003CC00CC00CE00CE008F830CFE00E117F9011>I<06000600060006
000E000E001E003FF0FFF01E001E001E001E001E001E001E001E001E181E181E181E181E
180F3003E00D187F9711>I<FE0FE0FE0FE01E01E01E01E01E01E01E01E01E01E01E01E0
1E01E01E01E01E01E01E01E01E01E01E03E01E03E00F05FC03F9FC16117F9019>I<FF03
F0FF03F01E01801E01801F03800F03000F070007860007860003CC0003CC0001FC0001F8
0001F80000F00000F00000600000600070C000F8C000F9C000F980007300003C00001418
7F9017>121 D E /Ff 1 49 df<081C1C3838383070706060C0C0060D7E8D09>48
D E /Fg 3 111 df<040C0000000000705898983030606464683006127E910B>105
D<71F1F09A1A189C1C18981818181818303030303030303032303062606064606038170B
7E8A1B>109 D<71F09A189C18981818183030303030323062606460380F0B7E8A13>I
E /Fh 4 62 df<0C003C00CC000C000C000C000C000C000C000C000C000C000C000C000C
00FF8009107E8F0F>49 D<1F00618040C08060C0600060006000C00180030006000C0010
2020207FC0FFC00B107F8F0F>I<1F00218060C060C000C0008001800F00008000400060
C060C060804060801F000B107F8F0F>I<FFFF80FFFF80000000000000000000000000FF
FF80FFFF8011087E8917>61 D E /Fi 19 107 df<FFFFFEFFFFFE17027D891E>0
D<60F0F06004047D8A0B>I<8000C0C001C0600300300600180C000C1800063000036000
01C00001C0000360000630000C1800180C00300600600300C001C08000C012127A911E>
I<007FFE03FFFE0780000C0000180000300000600000600000600000C00000C00000C000
00C00000C000006000006000006000003000001800000C000007800003FFFE007FFE0000
000000000000000000000000000000007FFFFE7FFFFE171F7D971E>18
D<00000020000000002000000000100000000008000000000400FFFFFFFF80FFFFFFFF80
00000004000000000800000000100000000020000000002000210C7E8E26>33
D<0000100000000018000000000C000000000C000000000600000000030000FFFFFF8000
FFFFFFE00000000070000000001E0000000007800000001E0000000038000000006000FF
FFFFC000FFFFFF80000000030000000006000000000C000000000C000000001800000000
10000021167E9326>41 D<007FE003FFE00780000C000018000030000030000060000060
0000C00000C00000FFFFE0FFFFE0C00000C000006000006000003000003000001800000C
000007800003FFE0007FE013187D941A>50 D<0000600000600000C00000C00001800001
80000300000300000600000C00000C0000180000180000300000300000600000600000C0
0000C0000180000180000300000300000600000600000C00001800001800003000003000
00600000600000C0000040000013227B9900>54 D<C0C0C0C0C0C0E0E0C0C0C0C0C0C003
0E7E8F00>I<400010C000306000606000606000603000C03000C03000C01801801FFF80
0FFF000C03000C0300060600060600060600030C00030C0001980001980001980000F000
00F00000F000006000006000141A809915>I<0008000000180000001800000018000000
180000001800000018000000180000001800000018000000180000001800000018000000
180000001800000018000000180000001800000018000000180000001800000018000000
18000000180000FFFFFF80FFFFFF80191A7D991F>63 D<0006000001000E000002000E00
0006000F00000E000F00001E001F00003E001700003C001700007C00178000FC00178001
BC00238003BC002380073C0023C00E3C0043C01C380041C038380041C070780081E06078
0081E0C0780080F180780100F7007801007F007802007E007866007C0078FC0030007CFC
0000007FF80000003C7000000000281B7E992E>77 D<400008C00018C00018C00018C000
18C00018C00018C00018C00018C00018C00018C00018C00018C00018C00018C00018C000
186000303000601E03C00FFF8001FC0015167E951A>91 D<400000C00000C00000C00000
C00000C00000C00000C00000C00000C00000C00000C00000FFFFC0FFFFC0C00000C00000
C00000C00000C00000C00000C00000C00000C00000C00000C00000400000121A7E9917>
96 D<007001C0038007000700070007000700070007000700070007000700070007000E
001C00F0001C000E00070007000700070007000700070007000700070007000700070003
8001C000700C257D9B13>102 D<F0001C000E0007000700070007000700070007000700
07000700070007000700038001C0007001C0038007000700070007000700070007000700
070007000700070007000E001C00F0000C257D9B13>I<00800180030003000300060006
000C000C000C0018001800180030003000600060006000C000C000600060006000300030
001800180018000C000C000C00060006000300030003000180008009267D9B0F>I<C000
C000600060006000300030001800180018000C000C000C00060006000300030003000180
0180030003000300060006000C000C000C0018001800180030003000600060006000C000
C00009267E9B0F>I<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C002257C9B0B>I E /Fj 2 122 df<800000C00000600000300000
1C00000E000003000001C00000E000003000001800000E00000700000180000080110F80
8015>70 D<000180000380000600000C0000380000700000C0000180000300000E00001C
0000300000600000C00000800000110F808D15>121 D E /Fk 5
125 df<C0C0C060606060606060606060606060606060C0C0C0400317819500>10
D<8000C0006000300018000C000600060003000180018000C00060006000300030001800
18000C00040E148D9200>20 D<F00000FE00000FC00001F800003E000007800001E00000
7000001C00000C160A958800>34 D<00001C0000780003E0001F8000FC000FE000FF0000
F000001608808600>111 D<000C000C00180018003000300060006000C000C001800300
030006000C00180030006000C00040000E14819200>124 D E /Fl
5 125 df<0004000C00180030006000C0018001800300060006000C0018001800300030
0060006000C00040000E14819200>10 D<606060C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
606060200317829500>20 D<C000C0006000600030003000180018000C000C0006000300
0300018000C0006000300018000C00040E148D9200>34 D<F00000FF00000FE00000FC00
001F800003E000007800001C1608808000>111 D<0000780003F8001F8000FC0003E000
0F00003C0000700000C00000800000150A808800>124 D E /Fm
24 64 df<40C0C0C0C0C0606060303018180C06030810818006>32
D<C000600030001C000F0003E000FF001F100881710F>I<00030006001C003800E00FC0
FF00F000100880710F>I<0103030303030606060C0C18183060C00810818006>I<C06030
18180C0C0606060303030303010810818E06>I<F000FF000FC000E00038001C00060003
100880950F>I<001F00FF03E00F001C0030006000C000100881950F>I<03060C18183030
606060C0C0C0C0C0400810818E06>I<4000C000C000C000C000C0006000600060006000
30003000180018000C0006000600030001800913818007>I<C000006000003000001C00
000F000003C00000FC00003FE00003E01309816E12>I<0000600000C000038000070000
1C0000F80007E000FF0000F800001309806E12>I<008001800180018001800180030003
0003000300060006000C000C001800180030006000C0000913818007>I<C00060003000
180018000C000C0006000600030003000300030001800180018001800180008009138191
07>I<F80000FF000007E00000F800001C000007000003800000C00000601309809912>I<
0003E0003FE000FC0003C0000F00001C0000300000600000C000001309819912>I<0180
0300060006000C0018001800300030006000600060006000C000C000C000C000C0004000
0913819107>I<4000C000C000C000C000C000C000600060006000600030003000300018
0018000C000C00060003000300018000C0006000300C1981800A>56
D<C000000060000000380000001C0000000700000003C0000000F00000003E0000000FE0
000001FF8000001F80190B816817>I<00000100000300000600000C0000380000700001
C0000780003E0003F800FFC000FC0000180C806917>I<00100030003000300030003000
30006000600060006000C000C00180018003000300060006000C001800180030006000C0
000C1981800A>I<C00060003000180018000C0006000600030003000180018000C000C0
006000600060006000300030003000300030003000100C1981970A>I<FC0000FFC00003
F800003E000007800001C000007000003800000C000006000003000001180C80A117>I<
00001F800001FF80000FE000003E000000F0000003C00000070000001C00000038000000
60000000C0000000190B81A117>I<0030006000C001800300030006000C000C00180018
003000300030006000600060006000C000C000C000C000C000C00040000C1981970A>I
E /Fn 77 127 df<60F0F0F0F0F0F0F0F0F0F0F0F0F0600000000060F0F0600417789614
>33 D<071C00071C00071C00071C00071C007FFF00FFFF80FFFF800E38000E38000E3800
0E38000E38000E38000E3800FFFF80FFFF807FFF001C70001C70001C70001C70001C7000
11177F9614>35 D<0700000F800018C00038E00038E00038E00038C00039CF80398F801F
1C001E1C001E38001E38001E38003F7000677000E3F000E3E000E1E380E1E38073F3803F
3F001E1E0011177F9614>38 D<60F0F878181818303060C080050C789614>I<00C001C0
030006000C001C0038003000700070006000E000E000E000E000E000E000E00060007000
7000300038001C000C000600030001C000C00A1D7A9914>I<8000C0006000300018001C
000E000600070007000300038003800380038003800380038003000700070006000E001C
00180030006000C0008000091D7C9914>I<038003800380638CF39EFFFE3FF80FE00FE0
3FF8FFFEF39E638C0380038003800F107E9214>I<01C00001C00001C00001C00001C000
01C00001C000FFFF80FFFF80FFFF8001C00001C00001C00001C00001C00001C00001C000
11117F9314>I<70F8FCFC7C0C1830E0C0060A798414>I<FFFEFFFEFFFE0F037E8C14>I<
70F8F8F8700505798414>I<07C00FE01C7038383018701C701CE00EE00EE00EE00EE00E
E00EE00EE00EE00E701C701C383838381C700FE007C00F177E9614>48
D<0300030007000F003F00F7004700070007000700070007000700070007000700070007
000700070007007FF07FF00C177C9614>I<0FC01FF03838701CE00EE00EE00E400E000E
001C001C00380030007000E001C0030006000C00180E300E7FFE7FFE0F177E9614>I<0F
C01FF03838701C701C201C001C001C0038007007E007F00038001C000E000E400EE00EE0
0E701C78383FF00FC00F177E9614>I<00780000F80001B80001B8000338000338000638
000E38000C38001C3800383800303800703800E03800FFFF80FFFF800038000038000038
0000380000380001FF0001FF0011177F9614>I<3FFC7FFC700070007000700070007000
700077C07FF07838201C000C000E000E400EE00EE01C601C78783FF00FC00F177E9614>
I<70F8F8F87000000000000070F8F8F8700510798F14>58 D<70F8F8F870000000000000
60F0F8F878183070E0800515798F14>I<000E003E007C00F003E007C01F003E00F800F0
00F8003E001F0007C003E000F0007C003E000E0F137E9414>I<FFFF80FFFF807FFF8000
00000000000000007FFF80FFFF80FFFF8011097F8F14>I<4000E000F8007C001E000F80
07C001F000F8003E001E003E00F801F007C00F801E007C00F800E00040000F157E9514>
I<01E007F00E38181C38FC71FC739E739EE70EE70EE70EE70EE70EE70EE70E739C739C71
F838F018060E1E07F801F00F177E9614>64 D<01C00003E00003E0000360000360000770
000770000770000770000630000E38000E38000E38000E38000E38001FFC001FFC001C1C
001C1C003C1E00380E00FE3F80FE3F8011177F9614>I<FFF0FFFC381E380E3807380738
073807380E381E3FFC3FFC381E380E38073807380738073807380E381EFFFCFFF810177F
9614>I<03C60FFE1C3E181E381E700E700E600EE000E000E000E000E000E000E000600E
700E700E380C181C1C380FF003C00F177E9614>I<FFE000FFF800383C00381E00380E00
380700380700380700380380380380380380380380380380380380380380380380380700
380700380E00381E00383C00FFF800FFE00011177F9614>I<FFFF00FFFF003807003807
003807003807003800003800003870003870003FF0003FF0003870003870003800003800
00380000380380380380380380380380FFFF80FFFF8011177F9614>I<FFFFFFFF380738
073807380738003800387038703FF03FF0387038703800380038003800380038003800FF
00FF0010177E9614>I<03C60FFE1C3E181E381E700E700E600EE000E000E000E000E07F
E07FE00E600E700E700E381E181E1C3E0FFE03CE10177F9614>I<FE3F80FE3F80380E00
380E00380E00380E00380E00380E00380E00380E003FFE003FFE00380E00380E00380E00
380E00380E00380E00380E00380E00380E00FE3F80FE3F8011177F9614>I<FFF8FFF807
000700070007000700070007000700070007000700070007000700070007000700070007
00FFF8FFF80D177D9614>I<FF00FF003800380038003800380038003800380038003800
380038003800380038003807380738073807FFFFFFFF10177E9614>76
D<FE0FE0FE0FE03E0F803B1B803B1B803B1B803B1B803BBB803BBB8039B38039B38039B3
8039F38038E38038E380380380380380380380380380380380380380FE0FE0FE0FE01317
809614>I<FE3F80FE3F803E0E003B0E003B0E003B0E003B0E003B8E00398E00398E0039
CE0039CE0039CE0038CE0038CE0038EE00386E00386E00386E00386E00383E00FE3E00FE
3E0011177F9614>I<1FF07FFC783C701CE00EE00EE00EE00EE00EE00EE00EE00EE00EE0
0EE00EE00EE00EE00EE00E701C783C7FFC1FF00F177E9614>I<FFF0FFFC381E380E3807
3807380738073807380E381E3FFC3FF038003800380038003800380038003800FE00FE00
10177F9614>I<FFE000FFF800383C00381C00380E00380E00380E00380E00381C00383C
003FF8003FF000383800381C00381C00381C00381C00381C00381C80381DC0381DC0FE0F
80FE070012177F9614>82 D<0FCC1FFC307C603CE01CE01CE01CE00070007E003FE00FF0
01F8001C001E000E600EE00EE00EF01CF838FFF0C7E00F177E9614>I<7FFF80FFFF80E1
C380E1C380E1C380E1C38001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C0000FF8000FF80011177F9614>I<FE0FE0
FE0FE0380380380380380380380380380380380380380380380380380380380380380380
3803803803803803803803803803801C07001C07000E0E0007FC0001F0001317809614>
I<FC1F80FC1F80380E00380E00380E001C1C001C1C001C1C001C1C001C1C000E38000E38
000E38000E380006300007700007700007700003600003600003E00003E00001C0001117
7F9614>I<FC1F80FC1F8070070070070070070070070070070070070030060031C6003B
EE003BEE003B6E003B6E003B6E003B6E003B6E001B6C001B6C001A2C001E3C001E3C001E
3C0011177F9614>I<FE3F80FE3F80380E003C1E001C1C001E3C000E38000E3800077000
07700003600003E00003E00001C00001C00001C00001C00001C00001C00001C00001C000
07F00007F00011177F9614>89 D<FFE0FFE0E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000FFE0FFE0
0B1D799914>91 D<FFE0FFE000E000E000E000E000E000E000E000E000E000E000E000E0
00E000E000E000E000E000E000E000E000E000E000E000E000E0FFE0FFE00B1D7F9914>
93 D<FFFEFFFEFFFE0F037E7E14>95 D<1FC0007FF000707800201800001C00001C0007
FC001FFC003C1C00701C00E01C00E01C00E01C00707C003FFF800F8F8011107E8F14>97
D<FC0000FC00001C00001C00001C00001C00001C00001CF8001DFE001F07001E03001C03
801C01C01C01C01C01C01C01C01C01C01C01C01C03801E03001F0E001DFC000CF8001217
809614>I<03F80FFC1C1C380870006000E000E000E000E00060007000380E1C1E0FFC03
F00F107E8F14>I<007E00007E00000E00000E00000E00000E00000E0007CE000FFE001C
3E00301E00700E00E00E00E00E00E00E00E00E00E00E00E00E00700E00301E00383E001F
EFC007CFC012177F9614>I<07E00FF01C38301C700CE00EE00EFFFEFFFEE00060007000
380E1C1E0FFC03F00F107E8F14>I<007C00FE01CE03840380038003807FFEFFFE038003
8003800380038003800380038003800380038003807FFC7FFC0F177F9614>I<07CF001F
FF80383B80301800701C00701C00701C003018003838003FF00037C0007000007000003F
F8001FFC003FFE00700F00E00380E00380E00380E003807007003C1E001FFC0007F00011
197F8F14>I<FC0000FC00001C00001C00001C00001C00001C00001C78001DFE001F8600
1E07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C0700FF8FE0
FF8FE01317809614>I<030007800780030000000000000000007F807F80038003800380
038003800380038003800380038003800380FFFCFFFC0E187D9714>I<006000F000F000
6000000000000000001FF01FF00070007000700070007000700070007000700070007000
7000700070007000700070007040E0E0C07F803F000C207E9714>I<FC0000FC00001C00
001C00001C00001C00001C00001DFF801DFF801C3C001C78001CF0001DE0001FC0001FC0
001FE0001EF0001C70001C38001C38001C1C00FE3F80FE3F8011177F9614>I<FF80FF80
038003800380038003800380038003800380038003800380038003800380038003800380
0380FFFEFFFE0F177E9614>I<FB8E00FFDF003CF3803CF38038E38038E38038E38038E3
8038E38038E38038E38038E38038E38038E380FEFBE0FE79E01310808F14>I<FC7800FD
FE001F86001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C
0700FF8FE0FF8FE01310808F14>I<07C01FF03C78701C701CE00EE00EE00EE00EE00EE0
0E701C783C3C781FF007C00F107E8F14>I<FCF800FDFE001F07001E03001C03801C01C0
1C01C01C01C01C01C01C01C01C01C01C03801E03001F0E001DFC001CF8001C00001C0000
1C00001C00001C00001C0000FF8000FF80001218808F14>I<03CE000FFE001C3E00301E
00700E00E00E00E00E00E00E00E00E00E00E00E00E00700E00301E001C3E000FEE0007CE
00000E00000E00000E00000E00000E00000E00007FC0007FC012187F8F14>I<FE1F00FE
7F800EE3800F81000F00000F00000E00000E00000E00000E00000E00000E00000E00000E
0000FFF000FFF00011107F8F14>I<0FD83FF86038C038C038F0007F803FF007F8001C60
06E006F006F81CFFF8CFE00F107E8F14>I<030007000700070007007FFCFFFC07000700
070007000700070007000700070E070E070E070C03FC00F00F157F9414>I<FC3F00FC3F
001C07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C1F
000FFFE003E7E01310808F14>I<FE3F80FE3F801C1C001C1C001C1C001C1C000E38000E
38000E380006300007700007700007700003E00003E00003E00011107F8F14>I<FF7F80
FF7F80380E00380E00380E00380E0039CE0039CE0019CC001B6C001B6C001A6C001A6C00
1E7C000E78000E780011107F8F14>I<7E3F007E3F001E38000E780007700007E00003E0
0001C00003C00003E0000770000E78000E38001C1C00FE3F80FE3F8011107F8F14>I<FE
3F80FE3F801C1C001C1C001C1C000E1C000E38000E380007380007300007300003700003
700001E00001E00001E00001C00001C00001C0000380007380007700007E00003C000011
187F8F14>I<3FFF7FFF700E701C7038007000E001C0038007000E001C0738077007FFFF
FFFF10107F8F14>I<003E00FE01E003800380038003800380038003800380038003807F
00FE007F00038003800380038003800380038003800380038001E000FE003E0F1D7E9914
>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0031D789914>
I<7800FE000F00038003800380038003800380038003800380038001FC00FE01FC038003
80038003800380038003800380038003800F00FE0078000F1D7E9914>I<1C103F38E7E0
41C00D047D9614>I E /Fo 25 121 df<03E0000638101C1820381C20300E20700E4060
0E40E00E80E00E80E00F00E00E00C00E00E00E00603E0020C6401F038014107E8F19>11
D<7E03000E03801C07001C07001C07001C0E00380E00381C0038180038300070600070C0
00718000730000FC0000F0000011107E8F13>23 D<007801C60306070306030E031C071C
071C071C07380E380C381C3818747073C070007000E000E000E000E000C00010177E8F14
>26 D<60F0F06004047D830B>58 D<60F0F07010101020204080040B7D830B>I<000400
0C00180018001800300030003000600060006000C000C000C00180018001800300030003
000600060006000C000C000C00180018001800300030003000600060006000C000C0000E
257E9B13>61 D<01FFFFC0003801C0003800C00038004000700040007000400070004000
70004000E0400000E0400000E0400000E0C00001FF800001C0800001C0800001C0800003
810000038001000380010003800200070002000700040007000C00070018000E007800FF
FFF0001A1A7E991C>69 D<0007E040003C18C000E005C001C003C003800180070001800E
0001801C0001803C000100380001007800000078000000F0000000F0000000F0000000F0
01FF80F0001C00F0001C00F0001C00F0001C007000380030003800380038001C00780007
03900001FC10001A1A7E991E>71 D<01FFC0003800003800003800007000007000007000
00700000E00000E00000E00000E00001C00001C00001C00001C000038000038008038008
0380100700100700300700200700600E01C0FFFFC0151A7E991A>76
D<01FC0007F0003C000F00003C000F00003C001700005C002E00004E002E00004E004E00
004E004E00008E009C00008E011C00008E011C00008E021C00010E023800010E04380001
0E083800010E0838000207107000020710700002072070000207407000040740E0000407
80E000040780E0000C0700E0001C0601C000FF861FFC00241A7E9925>I<000FE0000038
380000E00E0001C00700070007000F0003800E0003801C0003803C0003C0380003C07800
03C0780003C0F0000780F0000780F0000780F0000F00F0000F00F0000E00F0001E00F000
3C0070003800700070003800E0001C03C0000E0F000003F800001A1A7E991D>79
D<01FFFC0000380F000038038000380380007003C0007003C0007003C0007003C000E007
8000E0078000E00F0000E01E0001C0380001FFE00001C0000001C0000003800000038000
000380000003800000070000000700000007000000070000000E000000FFE000001A1A7E
9919>I<001F080060D800803801003803001006001006001006001006000007000007C0
0003FC0001FF00007F800007C00001C00001C00000C02000C02000C06001806001806003
00700600CC0C0083F000151A7E9917>83 D<FFC01FE01E0007001C0006001C0004000E00
08000E0008000E0010000E0020000E0020000E0040000E0080000F008000070100000703
000007020000070400000704000007080000079000000390000003A0000003C0000003C0
00000380000003000000030000001B1A7E9916>86 D<03E006181C183838301070006000
E000E000E000E000C008E010602030C01F000D107E8F11>99 D<1F800380038003800700
0700070007000E000E000E0E0E331C471C831D001E003C003F8039C038E070E270E270E2
70E4E0646038101A7E9914>107 D<3F0707070E0E0E0E1C1C1C1C3838383870707070E4
E4E4E46838081A7E990B>I<383E0F804CC330C08F03C0E08F03C0E08E0380E08E0380E0
1C0701C01C0701C01C0701C01C070380380E0388380E0388380E0708380E0710701C0320
300C01C01D107E8F22>I<383C004CC6008F07008E07008E07008E07001C0E001C0E001C
0E001C1C00381C40381C40383840383880701900300E0012107E8F17>I<070F00099180
11E1C011C0C011C0C011C0C00381C00381C00381C00381C0070380070300070700070600
0E8C000E70000E00000E00001C00001C00001C00001C0000FF00001217818F13>112
D<03E006180818183818301C001FC00FE007F000700030E030E030806040C03F000D107E
8F12>115 D<1C0600260700470E00870E008E0E008E0E000E1C001C1C001C1C001C1C00
3838803838803838801838801C59000F8E0011107E8F16>117 D<1C0C261E470E87068E
068E060E041C041C041C0838083808381018200C4007800F107E8F13>I<1C030626038F
4707078707038E07038E07030E0E021C0E021C0E021C0E04381C04381C04181C081C1C10
0C262007C3C018107E8F1C>I<0F1E11A321E741C341C041C00380038003800380070207
02C702EB04CB0870F010107E8F16>I E /Fp 25 118 df<01F0061C080E100618071C07
180E000E000C001C0038007000600180030006040C0810083FF87FF0FFF010157E9412>
50 D<000100000300000700000780000B80000B800013800013800023C00021C00041C0
0041C00081C00081C00100E001FFE00200E00200E00400E00400700800701C0070FE03FE
17177F961A>65 D<003F0401C08C0300580600380C0018180018380018700018700010E0
0000E00000E00000E00000E00000E00020E00020E000206000407000403000801803000E
0C0003F00016177C9619>67 D<1FFFFE03C00E0380060380060380020380020380020380
8007010007010007030007FF000703000703000E02000E02000E00000E00000E00000E00
001C00001E0000FFC00017177F9617>70 D<003F0200E0C603002C06001C0C000C18000C
38000C70000C700008E00000E00000E00000E00000E007FEE00078E00070E00070600070
7000703000701800E006036001FC2017177C961C>I<1FF803C003800380038003800380
03800700070007000700070007000E000E000E000E000E000E001C001C00FFC00D177E96
0D>73 D<1FFC0003C0000380000380000380000380000380000380000700000700000700
000700000700000700000E00100E00100E00100E00300E00200E00601C00E01C03C0FFFF
C014177F9616>76 D<1FC0003F8003E0005C0002E000780002E000B80002E000B8000270
013800027001380002700238000470047000043804700004380870000438087000043810
7000041C107000081C20E000081C40E000081C40E000080E80E000080E80E000080F00E0
00180E01C000380601C000FE040FF80021177F9620>I<1FC01FE001C0038002E0030002
E00200027002000238020002380200021C0200041C0400040E0400040E04000407040004
078400040384000801C8000801C8000800E8000800E80008007800080078001800300038
001000FE0010001B177F961A>I<1FFFE003C03803801C03800E03800E03800E03800E03
801C07001C0700380700E007FF800700000700000E00000E00000E00000E00000E00000E
00001C00001C0000FF800017177F9618>80 D<00F8400306C00401800C01801800801800
801800801800001C00001FC0000FF80003FC00007E00000F000007000003004003004003
00400200400600E00C00D8180087E00012177E9614>83 D<0FE01C301C18081C001C03F8
1E3838386038E039E079E072E1BA3E3C100E7E8D12>97 D<03F80E1C181C300870007000
E000E000E000E0006008701038600F800E0E7E8D10>99 D<000FC00003C0000380000380
00038000038000038000038000070003E7000E1F00180700300700700700700E00E00E00
E00E00E00E00E00E00600E00701C00387C000F9F8012177E9614>I<03E00C3018183018
701C7FF8E000E000E000E0006008701038600F800E0E7E8D10>I<007801CC039C030C07
000700070007000E007FC00E000E000E000E001C001C001C001C001C001C0038003800FF
000E177F960B>I<03E3C0063CC00C18001C1C001C1C001838001838000C700017C00030
00003000003FF0003FF8003FFC00600E00C00600C00600C00C00C018007070001FC00012
157F8D12>I<0307070600000000003E0E0E0E0E1C1C1C1C1C1C3838FE08177F960A>105
D<1F8007800700070007000700070007000E000E000E000E000E000E001C001C001C001C
001C001C0038003800FF0009177F960A>108 D<3E3E0F800EC330C00F03C0E00E0380E0
0E0380E01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C0380E0380380E0380
FF3FCFF01C0E7F8D1E>I<3E3E000EC3000F03800E03800E03801C07001C07001C07001C
07001C07001C0700380E00380E00FF3FC0120E7F8D14>I<03F00C18180C300E700E600E
E00EE00EE00EE00C601C703838600F800F0E7E8D12>I<3E780E9C0F1C0E080E001C001C
001C001C001C001C0038003800FF000E0E7F8D0E>114 D<0400040004000C001C003800
FF803800380038003800700070007000708070807080710071001E0009147D930E>116
D<F83E380E380E380E380E701C701C701C701C701C703C603870F81F3F100E7D8D14>I
E /Fq 21 117 df<60F0F070101020204040040A7D830A>44 D<FF80FF80090280870C>
I<60F0F06004047D830A>I<03000700FF00070007000700070007000700070007000700
070007000700070007000700070007007FF00C157E9412>49 D<0F8030E040708030C038
E0384038003800700070006000C00180030006000C08080810183FF07FF0FFF00D157E94
12>I<20303FE03FC0240020002000200020002F8030E020700030003800384038E038E0
388030406020C01F000D157E9412>53 D<01F00608080C181C301C70006000E000E3E0EC
30F018F00CE00EE00EE00E600E600E300C3018183007C00F157F9412>I<40007FFE7FFC
7FF8C008801080200040008000800100010003000200060006000E000E000E000E000E00
04000F167E9512>I<07C0183030186018E00CE00CE00EE00EE00E601E301E186E0F8E00
0E000C001C70187018603020C01F800F157F9412>57 D<60F0F06000000000000060F0F0
60040E7D8D0A>I<001000003800003800003800005C00005C00005C00008E00008E0000
8E0001070001070003078002038002038007FFC00401C00401C00800E00800E01800E038
00F0FE03FE17177F961A>65 D<FFE00E000E000E000E000E000E000E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E00FFE00B177F960D>73
D<1FC0386038301038003803F81E3830387038E039E039E07970FF1F1E100E7F8D12>97
D<007E00000E00000E00000E00000E00000E00000E00000E00000E0007CE001C3E00300E
00700E00600E00E00E00E00E00E00E00E00E00600E00700E00301E00182E0007CFC01217
7F9614>100 D<0FC0186030307038E018FFF8E000E000E000600070083010183007C00D
0E7F8D10>I<FC7C1F001D8E63801E0781C01C0701C01C0701C01C0701C01C0701C01C07
01C01C0701C01C0701C01C0701C01C0701C01C0701C0FF9FE7F81D0E808D1E>109
D<FC7C001D8E001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07
001C0700FF9FE0130E808D14>I<FCF8001F0E001C03001C03801C01801C01C01C01C01C
01C01C01C01C01801C03801C07001F0E001CF8001C00001C00001C00001C00001C0000FF
80001214808D14>112 D<FCF01D381E381C101C001C001C001C001C001C001C001C001C
00FF800D0E808D0E>114 D<1F4060C0C040C040E000FF007F801FC001E080608060C060
E0C09F000B0E7F8D0E>I<080008000800180018003800FF803800380038003800380038
00380038403840384038401C800F000A147F930E>I E /Fr 22 120
df<3878783808081010204080050B7E830B>44 D<7070F06004047D830B>46
D<0FFFF000E01C00E00E00E00F00E00701C00701C00F01C00F01C00F01C01E01C03C0380
7803FFF003803803801C03801E03801E07001E07001E07001E07001E07003C07003C0E00
780E01E0FFFF80181A7E991B>66 D<03F807F0060006000600060006000C000C000C000C
000C000C0018001800180018001800180030003000300030003000300060006000600060
0060006000C000C000C000C000FE00FE000D257E9B0B>91 D<03F807F000300030003000
30003000600060006000600060006000C000C000C000C000C000C0018001800180018001
8001800300030003000300030003000600060006000600FE00FE000D25819B0B>93
D<0FC01870383010380038003803F81E7038707070E070E071E0F1E0E263763C3810107D
8F13>97 D<01FC06060C0E1804300070007000E000E000E000E000600070043008183007
C00F107E8F11>99 D<000FC00001C00001C00001C00001C0000380000380000380000380
00038001F380070F000C0700180700300700700700700700E00E00E00E00E00E00E00E00
600E00600E00301C00187E000F9F80121A7E9915>I<01F006181C0C380C300E700E7FFE
E000E000E000E000600060043008183007C00F107E8F11>I<001E006300E701C601C003
8003800380038003803FF00700070007000700070007000E000E000E000E000E000E001C
001E00FFC0101A7F990C>I<00F8E0038F600706000E07000E07000E07000E0E000E0C00
06180009F0001800001800001800001FF8000FFE000FFF00300700600380600180C00300
600300600600381C000FE0001318808F13>I<0FC00001C00001C00001C00001C0000380
00038000038000038000038000039E000763000783800783800703800703800703800E07
000E07000E07000E07000E07000E07001C0E001C0E00FF9FC0121A7F9915>I<018003C0
03C001800000000000000000000000001F800700070007000700070007000E000E000E00
0E000E000E001C001C00FF800A1A80990A>I<0FC001C001C001C001C003800380038003
80038003800700070007000700070007000E000E000E000E000E000E001C001C00FF800A
1A80990A>108 D<1F9F07C0072188600741D0700781E0700701C0700701C0700701C070
0E0380E00E0380E00E0380E00E0380E00E0380E00E0380E01C0701C01C0701C0FF9FE7F8
1D107F8F20>I<1F9E000763000783800783800703800703800703800E07000E07000E07
000E07000E07000E07001C0E001C0E00FF9FC012107F8F15>I<01F0060C1C0618073003
70037003E007E007E007E007600E600C301818700FC010107E8F13>I<1FB8074C079C07
880700070007000E000E000E000E000E000E001C001E00FFC00E107F8F0F>114
D<07EC0C181008300830083C003FC01FE007F00078403840184010E030D0608F800E107F
8F0F>I<02000600040004000C001C003C00FFC038003800380038003800380070007000
7080708070807080710072001C000A177C960F>I<FC7E381C381C381C381C381C381C70
3870387038703870387078707071F81E7E0F107C8F15>I<FF3FCFC03C0F07001C0E0600
1C1604001C1704001C2708001C2708000E4710000E4310000E8320000E83A0000F03C000
0F03C0000603800006018000040100001A107D8F1C>119 D E /Fs
48 124 df<0003FE000E03001C0700180600380000380000700000700000700000700007
FFFC00E01C00E03800E03800E03800E03801C07001C07001C07001C07001C0E403C0E403
80E40380E4038068038030030000070000070000660000E60000CC000078000018218199
16>12 D<FF80FF80FF0009037D880E>45 D<3078F06005047C830C>I<00080018003000
7001F00E7000E000E000E000E001C001C001C001C0038003800380038007000700070007
000F00FFF00D187C9714>49 D<000300000380000700000700000700000E00000E00000E
00001C00001C0000180000300000300000600000C00000C600018E00030E00021C00041C
00081C00101C007FB800807F80003800003800007000007000007000007000006000111F
7F9714>52 D<003E0000C1000100800200C00600C00600C00E018007030007860003CC00
01F00001F800067C000C3E00180E00300700600700600700C00600C00600600C00601800
3070000FC00012187D9714>56 D<060F1E0C00000000000000003078F06008107C8F0C>
58 D<0000200000600000600000E00001E00001E0000270000270000470000870000870
00107000107000207000207000407000807000FFF0010038010038020038040038040038
0C00381C0038FF01FF181A7E991D>65 D<03FFF800700E00700600700700E00700E00700
E00700E00701C00E01C01C01C03801C07003FFE003807003803803801C07001C07001C07
001C07001C0E00380E00380E00700E00E01C03C0FFFF00181A7D991B>I<000F82007062
00C01603801E07000C0E000C1C000C18000C380008300008700000700000E00000E00000
E00000E00000E00020E00020E00020E000406000406000803001001006000C180003E000
171A7A991B>I<03FFF80000700E00007007000070030000E0018000E0018000E0018000
E001C001C001C001C001C001C001C001C001C00380038003800380038003800380030007
0007000700070007000E0007000C000E001C000E0038000E0070000E00E0001C038000FF
FE00001A1A7D991D>I<03FFFF00700700700300700100E00100E00100E00100E00101C0
8001C08001C08001C18003FF000381000381000381000702000700040700040700080E00
080E00180E00100E00301C00E0FFFFE0181A7D991A>I<03FFFF00700700700300700100
E00100E00100E00100E00101C08001C08001C08001C18003FF0003810003810003810007
02000700000700000700000E00000E00000E00000E00001E0000FFE000181A7D9919>I<
000FC100302100C01301800F0700060E00060C0006180006380004300004700000700000
E00000E00000E00000E007FEE00070E00070E00070E000706000E06000E03000E01801E0
0C064003F840181A7A991E>I<01FF800038000038000038000070000070000070000070
0000E00000E00000E00000E00001C00001C00001C00001C0000380000380000380000380
000700000700000700000700000E0000FFE000111A7E990F>73 D<00FFC0000E00000E00
000E00001C00001C00001C00001C00003800003800003800003800007000007000007000
00700000E00000E00000E00000E00061C000E1C000E180008380004700003C0000121A7C
9914>I<03FF8000700000700000700000E00000E00000E00000E00001C00001C00001C0
0001C0000380000380000380000380000700000700100700100700200E00200E00600E00
400E00C01C0380FFFF80141A7D9918>76 D<03F8001FC00078003C000078003C00007800
5C0000B800B80000B800B800009C013800009C013800011C027000011C027000011C0470
00011C087000021C08E000021C10E000021C10E000021C20E000041C41C000041C41C000
041C81C000041C81C000080F038000080F038000080E038000180C038000380C070000FF
083FF000221A7D9922>I<03F007F8007801C00078008000780080009C0100009C010000
9C0100008E0100010E020001060200010702000107020002038400020384000203840002
01C4000401C8000401C8000400E8000400E8000800F00008007000080070001800700038
002000FF0020001D1A7D991D>I<03FFF800701C00700600700700E00700E00700E00700
E00701C00E01C00E01C01C01C03803807003FF8003800003800007000007000007000007
00000E00000E00000E00000E00001C0000FFC000181A7D991A>80
D<003F1000609001807001007003002006002006002006002006000007000007C00003F8
0001FE00007F00000F80000380000180000180200180200180600300600300600600700C
00C8180087E000141A7D9916>83 D<3FFFFC381C0C201C04401C04403804803804803804
80380400700000700000700000700000E00000E00000E00000E00001C00001C00001C000
01C000038000038000038000038000078000FFF800161A79991B>I<FF803F801C001C00
1C0008001C0010001C0010001C0020001C0040001E0040000E0080000E0080000E010000
0E0200000E0200000E0400000E0C00000E0800000E100000071000000720000007400000
074000000780000007800000070000000600000006000000191A78991D>86
D<FF87FC3FC03C00E006001C00E004001C00E004001C01E008001C03E008001C02E01000
1C04E030001C04E020001C08E040001C08E040001C10E080001C10E080001C20E100001C
20E100001C40E200001C40E200001C80E400001D80E400001D00E800001E00F800001E00
F000001C00E000001C00E000001800C000001800C00000221A789926>I<03CC0E2E181C
381C301C701CE038E038E038E038C072C072C07260F261341E180F107C8F14>97
D<7E000E000E000E001C001C001C001C00380038003BC03C307830701870187018E038E0
38E038E038C070C060C0E060C063801E000D1A7C9912>I<01F006080C18183830107000
6000E000E000E000E000E008E010602030C01F000D107C8F12>I<001F80000380000380
000380000700000700000700000700000E00000E0003CE000E2E00181C00381C00301C00
701C00E03800E03800E03800E03800C07200C07200C0720060F2006134001E1800111A7C
9914>I<01E006181C08380870087010FFE0E000E000E000E000E0086010602030C01F00
0D107C8F12>I<000700001980001B80003B000030000030000070000070000070000070
0007FF0000E00000E00000E00000E00000E00001C00001C00001C00001C00001C0000380
00038000038000038000038000070000070000070000660000E40000CC00007000001121
81990C>I<00F300038B800607000E07000C07001C0700380E00380E00380E00380E0030
1C00301C00301C00183C0018780007B800003800003800007000607000E0E000C1C0007F
000011177E8F12>I<1F80000380000380000380000700000700000700000700000E0000
0E00000E7C000F86001E07001E07001C07001C0700380E00380E00380E00381C00701C80
701C80703880703900E01900600E00111A7E9914>I<030706000000000000384C4E8E9C
9C1C3838707272E2E4643808197C980C>I<1F8003800380038007000700070007000E00
0E000E0E0E131C271C431C801F003C003F8039C038E070E270E270E270E4E0646038101A
7E9912>107 D<3F0707070E0E0E0E1C1C1C1C3838383870707070E4E4E4E46830081A7D
990A>I<307C1E00598663009E0783809E0703809C0703809C070380380E0700380E0700
380E0700380E0E00701C0E40701C0E40701C1C40701C1C80E0380C80601807001A107C8F
1F>I<307C005986009E07009E07009C07009C0700380E00380E00380E00381C00701C80
701C80703880703900E01900600E0011107C8F16>I<01F006180C0C180E300E700E600E
E00EE00EE00CE01CE018E030606030C01F000F107C8F14>I<030F000590C009E0C009C0
6009C06009C0600380E00380E00380E00380E00701C00701800703800703000E8E000E78
000E00000E00001C00001C00001C00001C0000FF00001317808F14>I<30F059189E389C
189C009C0038003800380038007000700070007000E00060000D107C8F10>114
D<03E004300830187018601C001F801FC00FE000E00060E060E06080C041803E000C107D
8F10>I<06000E000E000E000E001C001C00FFC01C003800380038003800700070007000
7000E100E100E100E200640038000A177C960D>I<38064C074E0E8E0E9C0E9C0E1C1C38
1C381C381C7039703970393079389A0F0C10107C8F15>I<38184C1C4E1C8E0C9C0C9C0C
1C08380838083808701070107020304018C00F000E107C8F12>I<380C304C0E384E1C38
8E1C189C1C189C1C181C381038381038381038381070702070702070704030704018B880
0F0F0015107C8F19>I<078F0008D18010F38020E18020E00020E00001C00001C00001C0
0001C000038200038200C38200E78400C5880078F00011107E8F12>I<38064C074E0E8E
0E9C0E9C0E1C1C381C381C381C703870387038307838F00F700070006060E0E1C0C18047
003C0010177C8F13>I<FFFF8011017D8914>123 D E /Ft 84 128
df<00FC7C0183C607078E0607040E07000E07000E07000E07000E07000E0700FFFFF00E
07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E
07000E07007F0FF0171A809916>11 D<00FC000182000703000607000E02000E00000E00
000E00000E00000E0000FFFF000E07000E07000E07000E07000E07000E07000E07000E07
000E07000E07000E07000E07000E07000E07007F0FE0131A809915>I<00FF0003870007
07000607000E07000E07000E07000E07000E07000E0700FFFF000E07000E07000E07000E
07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07007F9FE013
1A809915>I<007E1F8001C170400703C060060380E00E0380400E0380000E0380000E03
80000E0380000E038000FFFFFFE00E0380E00E0380E00E0380E00E0380E00E0380E00E03
80E00E0380E00E0380E00E0380E00E0380E00E0380E00E0380E00E0380E00E0380E07F8F
E3FC1E1A809920>I<1C1C3C7060C0800607789913>19 D<60C0F1E0F9F068D008100810
0810102010202040C1800C0B7F9913>34 D<60F0F868080808101020C0050B7D990B>39
D<00800100020004000C00080018003000300030006000600060006000E000E000E000E0
00E000E000E000E000E000E0006000600060006000300030003000180008000C00040002
000100008009267D9B0F>I<8000400020001000180008000C0006000600060003000300
030003000380038003800380038003800380038003800380030003000300030006000600
06000C0008001800100020004000800009267E9B0F>I<000C0000000C0000000C000000
0C0000000C0000000C0000000C0000000C0000000C0000000C0000000C0000000C0000FF
FFFF80FFFFFF80000C0000000C0000000C0000000C0000000C0000000C0000000C000000
0C0000000C0000000C0000000C0000000C0000191A7E951E>43 D<60F0F0701010102020
4080040B7D830B>I<FFC0FFC00A0280880D>I<60F0F06004047D830B>I<0004000C0018
0018001800300030003000600060006000C000C000C00180018001800300030003000600
060006000C000C000C00180018001800300030003000600060006000C000C0000E257E9B
13>I<078018603030303060186018E01CE01CE01CE01CE01CE01CE01CE01CE01CE01CE0
1CE01C6018601870383030186007800E187E9713>I<03000700FF000700070007000700
0700070007000700070007000700070007000700070007000700070007000700FFF00C18
7D9713>I<0F80106020304038803CC01CE01C401C003C003800380070006000C0018001
00020004040804100430083FF87FF8FFF80E187E9713>I<0F8010E02070607870382038
007800700070006000C00F8000E000700038003C003CE03CE03CC03C4038407030E00F80
0E187E9713>I<00300030007000F000F001700370027004700C70087010703070207040
70C070FFFF00700070007000700070007007FF10187F9713>I<30183FF03FE03FC02000
200020002000200027C03860203000380018001C001C401CE01CE01C80184038403030E0
0F800E187E9713>I<01E006100C1818383038300070006000E000E7C0E860F030F018E0
18E01CE01CE01C601C601C701830183030186007C00E187E9713>I<40007FFE7FFC7FFC
400880108010802000400040008001800180010003000300030003000700070007000700
0700070002000F197E9813>I<078018603030201860186018601870103C303E600F8007
C019F030F86038401CC00CC00CC00CC00C6008201018600FC00E187E9713>I<07801860
303070306018E018E018E01CE01CE01C601C603C303C185C0F9C001C0018001800387030
7060604021801F000E187E9713>I<60F0F060000000000000000060F0F06004107D8F0B>
I<60F0F060000000000000000060F0F0701010102020408004177D8F0B>I<FFFFFF80FF
FFFF80000000000000000000000000000000000000000000000000FFFFFF80FFFFFF8019
0A7E8D1E>61 D<1FC020604030C038E038E0380038007000E00180010003000200020002
00020002000200000000000000000006000F000F0006000D1A7E9912>63
D<000C0000000C0000000C0000001E0000001E0000003F00000027000000270000004380
0000438000004380000081C0000081C0000081C0000100E0000100E00001FFE000020070
000200700006007800040038000400380008001C0008001C001C001E00FF00FFC01A1A7F
991D>65 D<FFFF000E01C00E00E00E00700E00780E00780E00780E00780E00780E00F00E
00E00E03C00FFF800E01E00E00700E00780E003C0E003C0E003C0E003C0E003C0E00380E
00780E00F00E01E0FFFF80161A7E991B>I<003F0201C0C603002E0E001E1C000E1C0006
380006780002700002700002F00000F00000F00000F00000F00000F00000700002700002
7800023800041C00041C00080E000803003001C0C0003F00171A7E991C>I<FFFF000E01
C00E00E00E00300E00380E001C0E001C0E000E0E000E0E000F0E000F0E000F0E000F0E00
0F0E000F0E000F0E000F0E000E0E000E0E001E0E001C0E00380E00380E00700E01C0FFFF
00181A7E991D>I<FFFFF00E00700E00300E00100E00180E00080E00080E00080E04000E
04000E04000E0C000FFC000E0C000E04000E04000E04000E00040E00040E00080E00080E
00080E00180E00380E0070FFFFF0161A7E991A>I<FFFFE00E00E00E00600E00200E0030
0E00100E00100E00100E04000E04000E04000E0C000FFC000E0C000E04000E04000E0400
0E00000E00000E00000E00000E00000E00000E00000E0000FFF000141A7E9919>I<003F
020001C0C60003002E000E001E001C000E001C0006003800060078000200700002007000
0200F0000000F0000000F0000000F0000000F0000000F001FFC070000E0070000E007800
0E0038000E001C000E001C000E000E000E000300160001C06600003F82001A1A7E991E>
I<FFE7FF0E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00
700FFFF00E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00
700E0070FFE7FF181A7E991D>I<FFE00E000E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E000E000E000E00FFE00B1A7F990E>
I<1FFC00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E040E0E0E0E0E041C061801E000E1A7D9914>I<FFE07F800E001E000E001800
0E0010000E0020000E0040000E0080000E0100000E0200000E0400000E0800000E1C0000
0E2E00000E4E00000E8700000F0380000E0380000E01C0000E00E0000E00E0000E007000
0E0070000E0038000E001C000E003E00FFE0FF80191A7E991E>I<FFF0000E00000E0000
0E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E00000E00200E00200E00200E00600E00400E00400E00C00E03C0FFFFC0131A7E
9918>I<FF0003FC0F0003C00F0003C00B8005C00B8005C00B8005C009C009C009C009C0
09C009C008E011C008E011C008E011C0087021C0087021C0083841C0083841C0083841C0
081C81C0081C81C0081C81C0080F01C0080F01C0080F01C0080601C01C0601C0FF861FFC
1E1A7E9923>I<FE01FF0F00380F00100B80100B801009C01008E01008E0100870100870
10083810081C10081C10080E10080E100807100803900803900801D00801D00800F00800
700800700800301C0030FF8010181A7E991D>I<007F000001C1C000070070000E003800
1C001C003C001E0038000E0078000F0070000700F0000780F0000780F0000780F0000780
F0000780F0000780F0000780F000078078000F0078000F0038000E003C001E001C001C00
0E0038000700700001C1C000007F0000191A7E991E>I<FFFF000E03C00E00E00E00700E
00700E00780E00780E00780E00780E00700E00700E00E00E03C00FFF000E00000E00000E
00000E00000E00000E00000E00000E00000E00000E00000E0000FFE000151A7E991A>I<
FFFC00000E0780000E01C0000E00E0000E00F0000E00F0000E00F0000E00F0000E00F000
0E00E0000E01C0000E0780000FFC00000E0600000E0300000E0180000E01C0000E01C000
0E01C0000E01E0000E01E0000E01E0000E01E0800E00F0800E007100FFE03E00191A7E99
1C>82 D<0FC21836200E6006C006C002C002C002E00070007E003FE01FF807FC003E000E
00070003800380038003C002C006E004D81887E0101A7E9915>I<7FFFFF00701C070040
1C0100401C0100C01C0180801C0080801C0080801C0080001C0000001C0000001C000000
1C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C000000
1C0000001C0000001C0000001C0000001C000003FFE000191A7F991C>I<FFE1FF0E0038
0E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E0010
0E00100E00100E00100E00100E00100E001006002007002003004001804000C180003E00
181A7E991D>I<FF801FC01E000F001C0006000E0004000E000400070008000700080007
000800038010000380100003C0300001C0200001C0200000E0400000E0400000E0400000
70800000708000003900000039000000390000001E0000001E0000001E0000000C000000
0C00001A1A7F991D>I<FF83FF0FF03C007801C01C007800801C007800800E007801000E
007801000E009C010007009C020007009C020007010E020007010E020003810E04000382
070400038207040001C207080001C403880001C403880000E403900000E403900000E801
D000007801E000007801E000007000E000007000E000003000C0000020004000241A7F99
27>I<FF801FE01E0007000E0006000F000400070008000780080003C0100001C0300001
E0200000F04000007040000078800000388000001D0000001F0000000E0000000E000000
0E0000000E0000000E0000000E0000000E0000000E0000000E0000000E000000FFE0001B
1A7F991D>89 D<7FFFC0780380700380600700400700400E00401C00401C000038000038
0000700000E00000E00001C00001C0000380000700400700400E00400E00401C00C03800
80380180700380700780FFFF80121A7E9917>I<FEFEC0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FEFE07257D9B0B>I<1830204040804080
810081008100B160F9F078F030600C0B7B9913>I<FEFE06060606060606060606060606
0606060606060606060606060606060606060606FEFE0725809B0B>I<3F8070C070E020
700070007007F01C7030707070E070E071E071E0F171FB1E3C10107E8F13>97
D<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001CF8001F0E
001E07001C03801C01801C01C01C01C01C01C01C01C01C01C01C01C01C03801C03001E07
001B0C0010F000121A7F9915>I<07F80C1C381C30087000E000E000E000E000E000E000
7000300438080C1807E00E107F8F11>I<007E00000E00000E00000E00000E00000E0000
0E00000E00000E00000E0003CE000C3E00380E00300E00700E00E00E00E00E00E00E00E0
0E00E00E00E00E00600E00700E00381E001C2E0007CFC0121A7F9915>I<07C01C303018
7018600CE00CFFFCE000E000E000E0006000300438080C1807E00E107F8F11>I<01F003
1807380E100E000E000E000E000E000E00FFC00E000E000E000E000E000E000E000E000E
000E000E000E000E000E007FE00D1A80990C>I<0FCE1873303070387038703870383030
18602FC02000600070003FF03FFC1FFE600FC003C003C003C0036006381C07E010187F8F
13>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001CF800
1D0C001E0E001E0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E00
1C0E001C0E00FF9FC0121A7F9915>I<18003C003C001800000000000000000000000000
FC001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FF80091A8099
0A>I<018003C003C001800000000000000000000000000FC001C001C001C001C001C001
C001C001C001C001C001C001C001C001C001C001C001C001C041C0E180E3007E000A2182
990C>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C3F
801C1E001C18001C10001C20001C40001DC0001FE0001CE0001C70001C78001C38001C1C
001C1E001C1F00FF3FC0121A7F9914>I<FC001C001C001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FF80091A80
990A>I<FC7C1F001D8E63801E0781C01E0781C01C0701C01C0701C01C0701C01C0701C0
1C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C0FF9FE7F81D107F8F
20>I<FCF8001D0C001E0E001E0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E00
1C0E001C0E001C0E001C0E00FF9FC012107F8F15>I<07E01C38300C700E6006E007E007
E007E007E007E0076006700E381C1C3807E010107F8F13>I<FCF8001F0E001E07001C03
801C03801C01C01C01C01C01C01C01C01C01C01C01C01C03801C03001E07001F0C001CF0
001C00001C00001C00001C00001C00001C0000FF800012177F8F15>I<03C2000C260038
1E00300E00700E00E00E00E00E00E00E00E00E00E00E00E00E00700E00700E00381E001C
2E0007CE00000E00000E00000E00000E00000E00000E00007FC012177F8F14>I<FCE01D
701E701E201C001C001C001C001C001C001C001C001C001C001C00FFC00C107F8F0F>I<
1F2060E04020C020C020F0007F003FC01FE000F080708030C030C020F0408F800C107F8F
0F>I<0400040004000C000C001C003C00FFC01C001C001C001C001C001C001C001C001C
201C201C201C201C200E4003800B177F960F>I<FC7E001C0E001C0E001C0E001C0E001C
0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C1E000C2E0007CFC012107F8F
15>I<FF1F803C06001C04001C04001E0C000E08000E080007100007100007900003A000
03A00001C00001C00001C00000800011107F8F14>I<FF3F9F803C0E0700380E06001C16
04001C1704001E170C000E2308000E2388000F239800074190000741D00003C1E0000380
E0000380E0000180C0000100400019107F8F1C>I<FF3F803C1C001C18000E1000072000
07600003C00001C00001E00003E000027000043800083800181C00381E00FC3FC012107F
8F14>I<FF1F803C06001C04001C04001E0C000E08000E080007100007100007900003A0
0003A00001C00001C00001C000008000008000010000010000E10000E20000E400007800
0011177F8F14>I<7FF86070407040E041C041C00380070007000E081C081C0838107010
7030FFF00D107F8F11>I<FFFFC01201808913>I<1C103E2047C083800C047D9813>126
D<6180F3C0F3C061800A047C9913>I E /Fu 43 121 df<387CFEFEFE7C3807077C860F>
46 D<00E00001E0000FE000FFE000F3E00003E00003E00003E00003E00003E00003E000
03E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E000
03E00003E00003E00003E000FFFF80FFFF80111D7C9C1A>49 D<07F0001FFE00383F007C
1F80FE0FC0FE0FC0FE0FE0FE07E07C07E03807E0000FE0000FC0000FC0001F80001F0000
3E0000780000F00000E00001C0000380600700600E00601C00E01FFFC03FFFC07FFFC0FF
FFC0FFFFC0131D7D9C1A>I<01FC0007FF000E0F801E0FC03F07E03F07E03F07E03F07E0
1E0FC0000FC0000F80001F0001FC0001FC00000F800007C00003E00003F00003F83803F8
7C03F8FE03F8FE03F8FE03F0FC03F07807E03C0FC01FFF8003FC00151D7E9C1A>I<0001
C00003C00007C00007C0000FC0001FC0003BC00073C00063C000C3C00183C00383C00703
C00E03C00C03C01803C03803C07003C0E003C0FFFFFEFFFFFE0007C00007C00007C00007
C00007C00007C000FFFE00FFFE171D7F9C1A>I<3803803FFF803FFF003FFE003FFC003F
F0003F800030000030000030000030000033F80037FE003C1F00380F801007C00007C000
07E00007E07807E0FC07E0FC07E0FC07E0FC07C0780FC0600F80381F001FFC0007F00013
1D7D9C1A>I<003F0001FFC007E0E00F81E01F03F01E03F03E03F07C03F07C01E07C0000
FC1000FCFF00FDFFC0FD03E0FE01F0FE01F0FC01F8FC01F8FC01F8FC01F87C01F87C01F8
7C01F83C01F03E01F01E03E00F07C007FF8001FE00151D7E9C1A>I<6000007FFFF87FFF
F87FFFF07FFFE07FFFC0E00180C00300C00300C00600000C000018000038000038000078
0000700000F00000F00001F00001F00001F00001F00003F00003F00003F00003F00003F0
0003F00001E00000C000151E7D9D1A>I<01FC0007FF000F07801E03C01C01E03C01E03C
01E03E01E03F01E03FC3C01FE3801FFF000FFE0007FF8007FFC01FFFE03C3FF0780FF078
03F8F001F8F000F8F00078F00078F000707800707C00E03E03C00FFF8003FC00151D7E9C
1A>I<0000E000000000E000000001F000000001F000000001F000000003F800000003F8
00000006FC00000006FC0000000EFE0000000C7E0000000C7E000000183F000000183F00
0000303F800000301F800000701FC00000600FC00000600FC00000C007E00000FFFFE000
01FFFFF000018003F000018003F000030001F800030001F800060001FC00060000FC000E
0000FE00FFE00FFFE0FFE00FFFE0231F7E9E28>65 D<FFFFFE00FFFFFFC007C007E007C0
03F007C001F807C001FC07C001FC07C001FC07C001FC07C001FC07C001F807C003F807C0
07F007C00FE007FFFF8007FFFFC007C003F007C001F807C001FC07C000FC07C000FE07C0
00FE07C000FE07C000FE07C000FE07C000FC07C001FC07C003F807C007F0FFFFFFE0FFFF
FF001F1F7E9E25>I<0007FC02003FFF0E00FE03DE03F000FE07E0003E0FC0001E1F8000
1E3F00000E3F00000E7F0000067E0000067E000006FE000000FE000000FE000000FE0000
00FE000000FE000000FE0000007E0000007E0000067F0000063F0000063F00000C1F8000
0C0FC0001807E0003803F0007000FE01C0003FFF800007FC001F1F7D9E26>I<FFFFFE00
00FFFFFFC00007E007F00007E001F80007E000FC0007E0007E0007E0003F0007E0003F00
07E0001F8007E0001F8007E0001F8007E0001FC007E0001FC007E0001FC007E0001FC007
E0001FC007E0001FC007E0001FC007E0001FC007E0001FC007E0001F8007E0001F8007E0
001F8007E0003F0007E0003F0007E0007E0007E000FC0007E001F80007E007F000FFFFFF
C000FFFFFE0000221F7E9E28>I<FFFFFFE0FFFFFFE007E007E007E001E007E000E007E0
006007E0007007E0003007E0003007E0603007E0603007E0600007E0E00007E1E00007FF
E00007FFE00007E1E00007E0E00007E0600007E0600007E0600007E0000007E0000007E0
000007E0000007E0000007E0000007E0000007E00000FFFF8000FFFF80001C1F7E9E21>
70 D<0007FC0200003FFF0E0000FE03DE0003F000FE0007E0003E000FC0001E001F8000
1E003F00000E003F00000E007F000006007E000006007E00000600FE00000000FE000000
00FE00000000FE00000000FE00000000FE003FFFE0FE003FFFE07E00007E007E00007E00
7F00007E003F00007E003F00007E001F80007E000FC0007E0007E0007E0003F000FE0000
FE01FE00003FFF8E000007FC0600231F7D9E29>I<FFFFFFFF07E007E007E007E007E007
E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007
E007E007E007E0FFFFFFFF101F7E9E14>73 D<FFFF8000FFFF800007E0000007E0000007
E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007
E0000007E0000007E0000007E0000007E0000007E0000007E000C007E000C007E000C007
E001C007E001C007E001C007E0038007E0038007E00F8007E01F80FFFFFF80FFFFFF801A
1F7E9E1F>76 D<FFE000003FF8FFF000007FF807F000007F0006F80000DF0006F80000DF
0006F80000DF00067C00019F00067C00019F00063E00031F00063E00031F00061F00061F
00061F00061F00060F800C1F00060F800C1F000607C0181F000607C0181F000607C0181F
000603E0301F000603E0301F000601F0601F000601F0601F000600F8C01F000600F8C01F
0006007D801F0006007D801F0006003F001F0006003F001F0006003F001F0006001E001F
00FFF01E03FFF8FFF00C03FFF82D1F7E9E32>I<FFFFFE00FFFFFF8007E00FE007E003F0
07E001F807E001F807E001FC07E001FC07E001FC07E001FC07E001FC07E001F807E001F8
07E003F007E00FE007FFFF8007FFFE0007E0000007E0000007E0000007E0000007E00000
07E0000007E0000007E0000007E0000007E0000007E0000007E00000FFFF0000FFFF0000
1E1F7E9E24>80 D<FFFFF80000FFFFFF000007E01FC00007E007E00007E003F00007E003
F00007E003F80007E003F80007E003F80007E003F80007E003F00007E003F00007E007E0
0007E01FC00007FFFF000007FFFC000007E03E000007E01F000007E00F800007E00F8000
07E00FC00007E00FC00007E00FC00007E00FE00007E00FE00007E00FE00007E00FE03007
E007F03007E003F860FFFF01FFC0FFFF007F80241F7E9E27>82 D<03FC080FFF381E03F8
3800F8700078700038F00038F00018F00018F80000FC00007FC0007FFE003FFF801FFFE0
0FFFF007FFF000FFF80007F80000FC00007C00003CC0003CC0003CC0003CE00038E00078
F80070FE01E0E7FFC081FF00161F7D9E1D>I<FFFF01FFE0FFFF01FFE007E0000C0007E0
000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E000
0C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C
0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0003E0001800
01F000180001F000300000F8006000007E03C000001FFF80000003FC0000231F7E9E28>
85 D<FFFE0FFFC0FFE0FFFE0FFFC0FFE00FC000FC000E000FE000FC000E0007E000FE00
0C0007E000FE000C0003F000FE00180003F001FF00180003F001BF00180001F801BF0030
0001F8031F80300001FC031F80700000FC031F80600000FC060FC06000007E060FC0C000
007E0E0FE0C000007E0C07E0C000003F0C07E18000003F1803F18000003F9803F3800000
1F9803F30000001FB001FB0000000FF001FE0000000FF001FE0000000FE000FE00000007
E000FC00000007C0007C00000007C0007C00000003C00078000000038000380000000180
00300000331F7F9E36>87 D<07FC001FFF003F0F803F07C03F03E03F03E00C03E00003E0
007FE007FBE01F03E03C03E07C03E0F803E0F803E0F803E0FC05E07E0DE03FF8FE0FE07E
17147F9319>97 D<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F
00001F00001F00001F1FC01F7FF01FE0F81F807C1F007E1F003E1F003E1F003F1F003F1F
003F1F003F1F003F1F003F1F003E1F003E1F007C1F807C1EC1F81C7FE0181F8018207E9F
1D>I<01FE0007FF801F0FC03E0FC03E0FC07C0FC07C0300FC0000FC0000FC0000FC0000
FC0000FC00007C00007E00003E00603F00C01F81C007FF0001FC0013147E9317>I<0007
F80007F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F801F8
F80FFEF81F83F83E01F87E00F87C00F87C00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00
F87C00F87C00F87E00F83E01F81F07F80FFEFF03F8FF18207E9F1D>I<01FE0007FF800F
83C01E01E03E00F07C00F07C00F8FC00F8FFFFF8FFFFF8FC0000FC0000FC00007C00007C
00003E00181E00180F807007FFE000FF8015147F9318>I<001F8000FFC001F3E003E7E0
03C7E007C7E007C3C007C00007C00007C00007C00007C000FFFC00FFFC0007C00007C000
07C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C000
07C00007C0003FFC003FFC0013207F9F10>I<01FC3C07FFFE0F079E1E03DE3E03E03E03
E03E03E03E03E03E03E01E03C00F07800FFF0009FC001800001800001C00001FFF800FFF
F007FFF81FFFFC3C007C70003EF0001EF0001EF0001E78003C78003C3F01F80FFFE001FF
00171E7F931A>I<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F
00001F00001F00001F0FC01F3FE01F61F01FC0F81F80F81F00F81F00F81F00F81F00F81F
00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8FFE3FFFFE3FF18207D9F
1D>I<1C003E003F007F003F003E001C00000000000000000000000000FF00FF001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B217E
A00E>I<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F00001F00
001F00001F01FE1F01FE1F00F01F00C01F03801F07001F0C001F18001F7C001FFC001F9E
001F0F001E0F801E07C01E03C01E01E01E01F01E00F8FFC3FFFFC3FF18207E9F1C>107
D<FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B207E9F0E>I<
FE0FE03F80FE1FF07FC01E70F9C3E01E407D01F01E807E01F01F807E01F01F007C01F01F
007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F00
7C01F01F007C01F01F007C01F01F007C01F0FFE3FF8FFEFFE3FF8FFE27147D932E>I<FE
0FC0FE3FE01E61F01EC0F81E80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F
00F81F00F81F00F81F00F81F00F81F00F8FFE3FFFFE3FF18147D931D>I<01FF0007FFC0
1F83F03E00F83E00F87C007C7C007CFC007EFC007EFC007EFC007EFC007EFC007E7C007C
7C007C3E00F83E00F81F83F007FFC001FF0017147F931A>I<FF1FC0FF7FF01FE1F81F80
FC1F007E1F007E1F003E1F003F1F003F1F003F1F003F1F003F1F003F1F003E1F007E1F00
7C1F80FC1FC1F81F7FE01F1F801F00001F00001F00001F00001F00001F00001F0000FFE0
00FFE000181D7E931D>I<FE3E00FE7F801ECFC01E8FC01E8FC01F8FC01F03001F00001F
00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FFF000FFF00012
147E9316>114 D<0FE63FFE701E600EE006E006F800FFC07FF83FFC1FFE03FE001FC007
C007E007F006F81EFFFCC7F010147E9315>I<01800180018003800380038007800F803F
80FFFCFFFC0F800F800F800F800F800F800F800F800F800F800F860F860F860F860F8607
CC03F801F00F1D7F9C14>I<FF07F8FF07F81F00F81F00F81F00F81F00F81F00F81F00F8
1F00F81F00F81F00F81F00F81F00F81F00F81F00F81F01F81F01F80F06F807FCFF03F8FF
18147D931D>I<FFE1FF00FFE1FF000F80700007C0E00007E0C00003E1800001F3800000
FF0000007E0000003E0000003F0000007F8000006F800000C7C0000183E0000381F00007
01F8000E00FC00FF81FF80FF81FF8019147F931C>120 D E /Fv
37 128 df<70F8FCFC74040404080810102040060E7C840D>44 D<FFC0FFC00A027F8A0F
>I<70F8F8F87005057C840D>I<03F0000E1C001C0E001806003807007003807003807003
80700380F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003
C0F003C0F003C07003807003807003807807803807001806001C0E000E1C0003F000121F
7E9D17>48 D<000600000600000E00000E00001E00002E00002E00004E00008E00008E00
010E00020E00020E00040E00080E00080E00100E00200E00200E00400E00C00E00FFFFF0
000E00000E00000E00000E00000E00000E00000E0000FFE0141E7F9D17>52
D<1803001FFE001FFC001FF8001FE00010000010000010000010000010000010000011F0
00161C00180E001007001007800003800003800003C00003C00003C07003C0F003C0F003
C0E00380400380400700200600100E000C380003E000121F7E9D17>I<03F0000C0C0010
06003003002001806001806001806001807001807803003E03003F06001FC8000FF00003
F80007FC000C7E00103F00300F806003804001C0C001C0C000C0C000C0C000C0C0008060
01802001001002000C0C0003F000121F7E9D17>56 D<001F800000E07000010008000600
06000800010008000100100F00802030C0402060404040C0202041C01C2041C01C208180
1C1083801C1083801C1083801C1083801C1083801C1083801C1081801C1041C01C1041C0
1C1040C03C2020605C202030CC40100F0780080000000800000006000070010001C000E0
1F00001FF0001C207D9F23>64 D<FFFFFF000F800F000780030007800300078001000780
0180078000800780008007800080078080800780800007808000078080000781800007FF
800007818000078080000780800007808000078080000780002007800020078000200780
00400780004007800040078000C0078000C0078001800F800F80FFFFFF801B1F7E9E1F>
69 D<FFFFFF000F800F0007800300078003000780010007800180078000800780008007
80008007800080078080000780800007808000078080000781800007FF80000781800007
808000078080000780800007808000078000000780000007800000078000000780000007
80000007800000078000000FC00000FFFE0000191F7E9E1E>I<000FE0200078186000E0
04E0038002E0070001E00F0000E01E0000601E0000603C0000603C0000207C0000207800
0020F8000000F8000000F8000000F8000000F8000000F8000000F8000000F8007FFCF800
03E0780001E07C0001E03C0001E03C0001E01E0001E01E0001E00F0001E0070001E00380
02E000E0046000781820000FE0001E217D9F24>I<FFF8FFF80F800F8007800F0007800F
0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F
0007800F0007FFFF0007800F0007800F0007800F0007800F0007800F0007800F0007800F
0007800F0007800F0007800F0007800F0007800F0007800F0007800F000F800F80FFF8FF
F81D1F7E9E22>I<FFFC0FC0078007800780078007800780078007800780078007800780
0780078007800780078007800780078007800780078007800780078007800FC0FFFC0E1F
7F9E10>I<FF80001FF80F80001F800780001F0005C0002F0005C0002F0005C0002F0004
E0004F0004E0004F000470008F000470008F000470008F000438010F000438010F000438
010F00041C020F00041C020F00041C020F00040E040F00040E040F00040E040F00040708
0F000407080F000407080F000403900F000403900F000401E00F000401E00F000401E00F
000E00C00F001F00C01F80FFE0C1FFF8251F7E9E2A>77 D<FFFFE0000F80780007801C00
07801E0007800F0007800F8007800F8007800F8007800F8007800F8007800F8007800F00
07801E0007801C000780780007FFE0000780000007800000078000000780000007800000
07800000078000000780000007800000078000000780000007800000078000000FC00000
FFFC0000191F7E9E1F>80 D<FFFC3FF80FC007C007800380078001000780010007800100
078001000780010007800100078001000780010007800100078001000780010007800100
078001000780010007800100078001000780010007800100078001000780010007800100
038002000380020001C0020001C0040000E008000070180000382000000FC0001D207E9E
22>85 D<FFF003FE1F8000F80F0000600F800060078000400780004003C0008003C00080
03C0008001E0010001E0010001F0010000F0020000F0020000F806000078040000780400
003C0800003C0800003C0800001E1000001E1000001F3000000F2000000F20000007C000
0007C0000007C000000380000003800000038000000100001F207F9E22>I<1FE0003030
00781800781C00300E00000E00000E00000E0000FE00078E001E0E00380E00780E00F00E
10F00E10F00E10F01E10781E103867200F83C014147E9317>97 D<03F80E0C1C1E381E38
0C70007000F000F000F000F000F000F00070007000380138011C020E0C03F010147E9314
>99 D<000380003F80000380000380000380000380000380000380000380000380000380
00038003E380061B801C0780380380380380700380700380F00380F00380F00380F00380
F00380F003807003807003803803803807801C07800E1B8003E3F815207E9F19>I<03F0
000E1C001C0E00380700380700700700700380F00380F00380FFFF80F00000F00000F000
007000007000003800801800800C010007060001F80011147F9314>I<007C00C6018F03
8F07060700070007000700070007000700FFF00700070007000700070007000700070007
000700070007000700070007000700070007007FF01020809F0E>I<0000E003E3300E3C
301C1C30380E00780F00780F00780F00780F00780F00380E001C1C001E380033E0002000
002000003000003000003FFE001FFF800FFFC03001E0600070C00030C00030C00030C000
306000603000C01C038003FC00141F7F9417>I<0E0000FE00000E00000E00000E00000E
00000E00000E00000E00000E00000E00000E00000E3E000E43000E81800F01C00F01C00E
01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E
01C00E01C0FFE7FC16207F9F19>I<1C001E003E001E001C000000000000000000000000
000E007E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E00FFC00A1F809E0C>I<0E0000FE00000E00000E00000E00000E00000E00000E0000
0E00000E00000E00000E00000E0FF00E03C00E03000E02000E04000E08000E10000E3000
0E70000EF8000F38000E1C000E1E000E0E000E07000E07800E03800E03C00E03E0FFCFF8
15207F9F18>107 D<0E1F01F000FE618618000E81C81C000F00F00E000F00F00E000E00
E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E0
0E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E00FFE7FE7F
E023147F9326>109 D<0E3E00FE43000E81800F01C00F01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFE7FC1614
7F9319>I<01F800070E001C03803801C03801C07000E07000E0F000F0F000F0F000F0F0
00F0F000F0F000F07000E07000E03801C03801C01C0380070E0001F80014147F9317>I<
0E78FE8C0F1E0F1E0F0C0E000E000E000E000E000E000E000E000E000E000E000E000E00
0E00FFE00F147F9312>114 D<1F9030704030C010C010C010E00078007F803FE00FF000
70803880188018C018C018E030D0608F800D147E9312>I<020002000200060006000E00
0E003E00FFF80E000E000E000E000E000E000E000E000E000E000E000E080E080E080E08
0E080610031001E00D1C7F9B12>I<0E01C0FE1FC00E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E03C00603C0030DC0
01F1FC16147F9319>I<FF83F81E01E01C00C00E00800E00800E00800701000701000382
0003820003820001C40001C40001EC0000E80000E8000070000070000070000020001514
7F9318>I<FF9FE1FC3C0780701C0300601C0380200E0380400E0380400E03C0400707C0
800704C0800704E080038861000388710003C8730001D0320001D03A0000F03C0000E01C
0000E01C0000601800004008001E147F9321>I<FF83F81E01E01C00C00E00800E00800E
008007010007010003820003820003820001C40001C40001EC0000E80000E80000700000
7000007000002000002000004000004000004000F08000F08000F100006200003C000015
1D7F9318>121 D<30307878F87C787830300E057C9E17>127 D E
/Fw 18 120 df<FFFFFFFF00FFFFFFFF0007E0003F0003E000070003E000038003E00001
8003E000018003E000008003E000008003E000008003E000008003E000004003E0020040
03E002004003E002000003E002000003E002000003E006000003E00E000003FFFE000003
FFFE000003E00E000003E006000003E002000003E002000003E002000003E002000003E0
02000003E000000003E000000003E000000003E000000003E000000003E000000003E000
000003E000000003E000000003E000000007F0000000FFFFE00000FFFFE0000022297EA8
27>70 D<0000FF00100007FFE030001FC07830003E000C7000F80006F001F00003F003E0
0001F007C00000F00F800000700F800000701F000000303F000000303E000000303E0000
00107E000000107E000000107C00000000FC00000000FC00000000FC00000000FC000000
00FC00000000FC00000000FC00000000FC00000000FC0000FFFF7C0000FFFF7E000003F0
7E000001F03E000001F03E000001F03F000001F01F000001F00F800001F00F800001F007
C00001F003E00001F001F00002F000F80002F0003E000C70001FC038300007FFE0100000
FF8000282B7DA92F>I<FFFFFF8000FFFFFFF00007E000FC0003E0003E0003E0001F0003
E0000F8003E0000FC003E00007C003E00007E003E00007E003E00007E003E00007E003E0
0007E003E00007E003E00007C003E0000FC003E0000F8003E0001F0003E0003E0003E001
F80003FFFFE00003E000000003E000000003E000000003E000000003E000000003E00000
0003E000000003E000000003E000000003E000000003E000000003E000000003E0000000
03E000000003E000000003E000000003E000000007F0000000FFFF800000FFFF80000023
297EA829>80 D<01FC00000E0780001001C0003C00E0003E00F0003E0078001C00780008
007800000078000000780000007800007FF80003E078000F8078001F0078003E0078007C
00780078007820F8007820F8007820F8007820F800F8207C00F8203C013C401F063FC007
F80F001B1A7E991E>97 D<007F8001C0700780080F003C1E007C3C007C3C00387C001078
0000F80000F80000F80000F80000F80000F80000F80000F800007800007C00003C00043C
00041E00080F001007802001C0C0007F00161A7E991B>99 D<0000078001FC1840070721
C00E03C1C01E03C0803C01E0003C01E0007C01F0007C01F0007C01F0007C01F0007C01F0
003C01E0003C01E0001E03C0000E0380001707000011FC00003000000030000000300000
00380000001C0000001FFFC0000FFFF80007FFFC001C003E0030000F0070000700600003
80E0000380E0000380E0000380E0000380700007007000070038000E000C0018000780F0
0000FF80001A287E9A1E>103 D<07800000FF800000FF8000000F800000078000000780
000007800000078000000780000007800000078000000780000007800000078000000780
0000078000000783F800078C1C0007900E0007A0070007A0078007C0078007C007800780
078007800780078007800780078007800780078007800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780FFFCFFFCFFFC
FFFC1E2A7FA921>I<07000F801F801F800F800700000000000000000000000000000000
00000007807F807F800F8007800780078007800780078007800780078007800780078007
800780078007800780078007800780FFF8FFF80D297FA811>I<0780FF80FF800F800780
078007800780078007800780078007800780078007800780078007800780078007800780
07800780078007800780078007800780078007800780078007800780078007800780FFFC
FFFC0E2A7FA911>108 D<0781F800FC00FF860E030700FF98070C03800FA0079003C007
A003D001E007C003E001E007C003E001E0078003C001E0078003C001E0078003C001E007
8003C001E0078003C001E0078003C001E0078003C001E0078003C001E0078003C001E007
8003C001E0078003C001E0078003C001E0078003C001E0078003C001E0078003C001E007
8003C001E0078003C001E0FFFC7FFE3FFFFFFC7FFE3FFF301A7F9933>I<0783F800FF8C
1C00FF900E000FA0070007A0078007C0078007C007800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780078007800780
078007800780078007800780078007800780FFFCFFFCFFFCFFFC1E1A7F9921>I<007F00
0001C1C000070070000E0038001C001C003C001E003C001E0078000F0078000F00F8000F
80F8000F80F8000F80F8000F80F8000F80F8000F80F8000F80F8000F8078000F0078000F
003C001E003C001E001E003C000E0038000700700001C1C000007F0000191A7E991E>I<
0783F000FF8C1C00FFB00F0007A0078007C003C0078003E0078001E0078001F0078001F0
078000F8078000F8078000F8078000F8078000F8078000F8078000F8078000F0078001F0
078001F0078001E0078003C007C003C007C0078007A00E0007983C000787E00007800000
078000000780000007800000078000000780000007800000078000000780000007800000
FFFC0000FFFC00001D267F9921>I<0787C0FF98E0FF91F00FA1F007C1F007C0E007C000
078000078000078000078000078000078000078000078000078000078000078000078000
07800007800007800007800007C000FFFE00FFFE00141A7F9917>114
D<07F8401C06C03001C06000C06000C0E00040E00040F00040F800007E00007FF0003FFE
000FFF0003FF80003FC00007C08001E08001E0C000E0C000E0C000E0E000C0F001C0F801
80C4070083F800131A7E9918>I<00800000800000800000800001800001800001800003
80000380000780000F80001FFF80FFFF8007800007800007800007800007800007800007
800007800007800007800007800007800007800007804007804007804007804007804007
804007804003C08001C08000E100003E0012257FA417>I<07800780FF80FF80FF80FF80
0F800F800780078007800780078007800780078007800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780078007800F80
07800F800380178001C027C000E047FC003F87FC1E1A7F9921>I<FFF1FFC1FFFFF1FFC1
FF0F803E00780F001E003007801E002007801E002007801F002003C03F004003C0270040
03C027804001E067808001E043808001E043C08000F081C10000F081C10000F881E30000
7900E200007900E200007D00F600003E007400003E007400001E007800001C003800001C
003800000C0030000008001000281A7F992B>119 D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 471 42 a Fw(F)-5 b(unctional)19 b(Programming)e(with)k(Graphs)
835 157 y Fv(Martin)15 b(Erwig)481 213 y(F)l(ernUniv)o(ersit\177)-23
b(at)16 b(Hagen,)f(Praktisc)o(he)g(Informatik)g(IV)738
269 y(58084)f(Hagen,)h(German)o(y)735 326 y(erwig@fern)o(uni-hagen.de)
-76 638 y Fu(Abstract)-76 717 y Ft(Graph)k(algorithms)h(expressed)f(in)
g(functional)h(languages)g(often)-76 758 y(su\013er)14
b(from)g(their)g(inherited)i(imp)q(erativ)o(e,)f(state-based)g(st)o
(yle.)k(In)-76 800 y(particular,)d(this)f(imp)q(edes)g(formal)g
(program)g(manipulation)q(.)22 b(W)m(e)-76 841 y(sho)o(w)10
b(ho)o(w)g(to)f(mo)q(del)i(p)q(ersisten)o(t)g(graphs)g(in)f(functional)
i(languages)-76 883 y(b)o(y)21 b(graph)g(constructors.)41
b(This)21 b(pro)o(vides)h(a)e(decomp)q(osition)q(al)-76
924 y(view)g(of)e(graphs)i(whic)o(h)g(is)g(v)o(ery)f(close)h(to)f(that)
g(of)f(data)i(t)o(yp)q(es)-76 966 y(and)13 b(leads)g(to)f(a)g(\\more)g
(functional")j(form)o(ulation)f(of)d(graph)i(algo-)-76
1007 y(rithms.)19 b(Graph)14 b(constructors)g(enable)h(the)e
(de\014nition)j(of)d(general)-76 1049 y(fold)k(op)q(erations)h(for)f
(graphs.)27 b(W)m(e)17 b(presen)o(t)g(a)f(promotion)i(theo-)-76
1090 y(rem)e(for)g(one)h(of)f(these)g(folds)h(that)g(allo)o(ws)g
(program)g(fusion)h(and)-76 1132 y(the)g(eliminati)q(on)j(of)d(in)o
(termediate)i(results.)34 b(F)m(usion)19 b(is)g(not)g(re-)-76
1173 y(stricted)g(to)g(the)f(eliminatio)q(n)j(of)d(tree-lik)o(e)i
(structures,)g(and)f(w)o(e)-76 1215 y(pro)o(v)o(e)12
b(another)h(theorem)f(that)g(facilitates)i(the)e(elimination)j(of)d
(in-)-76 1256 y(termediate)17 b(graphs.)25 b(W)m(e)16
b(describ)q(e)h(an)f(ML-implemen)o(tation)i(of)-76 1298
y(p)q(ersisten)o(t)i(graphs)f(whic)o(h)g(e\016cien)o(tly)h(supp)q(orts)
g(the)e(presen)o(ted)-76 1339 y(fold)i(op)q(erators.)35
b(F)m(or)18 b(example,)k(depth-\014rst-searc)o(h)e(expressed)-76
1381 y(b)o(y)15 b(a)g(fold)h(o)o(v)o(er)f(a)g(functional)i(graph)f(has)
f(the)g(same)g(complexit)o(y)-76 1422 y(as)e(the)g(corresp)q(onding)j
(imp)q(erativ)o(e)f(algorithm.)-76 1535 y Fu(1)53 b(In)o(tro)q(duction)
-76 1614 y Ft(T)m(raditionall)q(y)m(,)19 b(most)d(graph)h(algorithms)h
(are)e(form)o(ulated)h(in)g(an)-76 1655 y(imp)q(erativ)o(e)12
b(manner,)f(for)f(example,)i(in)e(depth-\014rst)h(searc)o(h,)g(no)q
(des)-76 1697 y(are)k Fs(marke)n(d)i Ft(as)d(b)q(eing)i(visited)g(to)e
(prev)o(en)o(t)h(rep)q(etitiv)o(e)h(tra)o(v)o(ersal.)-76
1738 y(Most)11 b(often,)g(this)h(imp)q(erativ)o(e)h(st)o(yle)f(is)f
(carried)i(o)o(v)o(er)e(when)g(imple-)-76 1780 y(men)o(ting)18
b(graph)g(algorithms)i(in)d(functional)j(languages,)g(for)c(ex-)-76
1821 y(ample,)e(a)e(set)h(of)f(visited)j(no)q(des)f(is)f(threaded)h
(through)f(successiv)o(e)-76 1863 y(function)19 b(calls.)31
b(Although)19 b(this)f(strategy)g(can)g(k)o(eep)f(programs)-76
1904 y(free)10 b(of)g(imp)q(erativ)o(e)j(up)q(dates,)f(the)e
(state-based,)i(imp)q(erativ)o(e)g(algo-)-76 1946 y(rithm)f(is)f(still)
i(presen)o(t,)f(just)f(in)g(functional)i(disguise.)19
b(Ho)o(w)o(ev)o(er,)9 b(in)-76 1987 y(order)h(to)g(\014nd)g(program)g
(transformations)i(lik)o(e)f(in)f(the)g(unfold/fold)-76
2029 y(approac)o(h)j(or)e(in)h(the)g(Bird/Meertens)h(formalism,)g(an)f
(in)o(tegration)-76 2070 y(in)f(a)g(truly)h(functional)g(st)o(yle)g(is)
f(needed.)17 b(W)m(e)11 b(follo)o(w)g(Ric)o(hard)h(Bird)-76
2112 y(who)h(recen)o(tly)h(concluded)i([3)o(]:)-14 2191
y Fr(But)11 b(if)g(w)o(e)f(remain)h(within)h(a)f(functional)h
(formalism,)g(then)-14 2233 y(w)o(e)h(need)h(to)f(reform)o(ulate)h
(standard)g(algorithms)h([...])-76 2313 y Ft(The)j(treatmen)o(t)f(of)g
(graphs)i(in)f(functional)i(languages)f(has)f(no)o(w)-76
2354 y(b)q(een)h(addressed)h(in)f(quite)h(di\013eren)o(t)g(w)o(a)o(ys)e
([4,)g(13)q(,)f(7)q(,)h(14],)h(but)p -76 2386 399 2 v
-76 2492 a Fq(In:)c Fp(2nd)c(A)o(CM)i(SIGPLAN)e(Conference)f(on)h(F)m
(unctional)-76 2529 y(Programming)o Fq(,)e(Amsterdam,)g(1997,)h(pp.)h
(52-65.)1020 638 y Ft(there)17 b(is)g(no)f(accepted)h(\\standard")h(y)o
(et.)27 b(W)m(e)17 b(b)q(eliev)o(e)h(that)f(one)1020
680 y(reason)c(for)g(this)g(situation)i(is)e(that)g(the)g(in)o
(tegration)i(often)d(su\013ers)1020 721 y(from)h(the)g(inherited)i(imp)
q(erativ)o(e)g(st)o(yle.)1076 763 y(This)k(has)g(to)f(b)q(e)g(seen)h
(in)g(con)o(trast)g(to)f(tree-lik)o(e)h(structures)1020
804 y(that)10 b(can)h(b)q(e)f(directly)i(represen)o(ted)f(b)o(y)f(data)
h(t)o(yp)q(es)g(whic)o(h)f(presen)o(t)1020 846 y(themselv)o(es)15
b(rather)f(uniformly)i(across)e(di\013eren)o(t)h(functional)h(lan-)1020
887 y(guages:)21 b(the)15 b(notions)h(of)f(data)g(t)o(yp)q(e,)g
(constructor,)h(pattern)f(and)1020 929 y(pattern)j(matc)o(hing)i(are)d
(w)o(ell-kno)o(wn)j(and)e(they)g(are)g(presen)o(t)g(in)1020
970 y(almost)13 b(all)g(mo)q(dern)f(functional)i(languages.)k(Researc)o
(h)13 b(on)f(gener-)1020 1012 y(alized)f(fold)e(op)q(erations,)j(also)e
(called)h(catamorphisms,)g([18,)d(22)q(,)g(10)q(])1020
1053 y(has)14 b(\(among)g(other)f(things\))i(pro)q(duced)g(far-reac)o
(hing)f(opp)q(ortuni-)1020 1095 y(ties)i(for)f(program)h
(transformations.)25 b(In)15 b(particular,)j(the)d(fusion)1020
1136 y(of)d(m)o(ulti-pass)j(algorithms)g([17,)d(24)q(,)g(16,)g(12)q(])g
(is)h(a)g(pro\014table)h(opti-)1020 1178 y(mization)h(tec)o(hnique.)
1076 1219 y(No)o(w)h(it)h(is)g(c)o(hallengin)q(g)i(to)e(reac)o(h)f(a)h
(comparable)h(status)f(for)1020 1261 y(graphs)10 b(and)g(graph)h
(algorithms.)17 b(A)o(t)9 b(this)h(p)q(oin)o(t)h(one)f(migh)o(t)g(ob)r
(ject)1020 1302 y(that)17 b(graphs)g(are)g(application-sp)r(eci)q
(\014c)i(structures)f(rather)f(than)1020 1344 y(a)h(programming)i
(language)f(concept,)h(and)e(they)g(should)i(there-)1020
1385 y(fore)13 b(b)q(e)g(implemen)o(ted)i(b)o(y)e(means)h(of)e
(language)j(features)f(already)1020 1427 y(presen)o(t.)21
b(Ev)o(en)15 b(if)f(this)i(is)e(true,)h(it)f(is)h(nonetheless)i(imp)q
(ortan)o(t)e(to)1020 1468 y(ha)o(v)o(e)10 b(a)g(uniform)g
(comprehension)i(of)d(graphs)i(together)f(with)g(a)f(cor-)1020
1510 y(resp)q(onding)18 b(programming)g(st)o(yle)e(to)g(facilitate)h
(program)g(trans-)1020 1551 y(formation)d(and)f(optimization)j(as)d(it)
g(is)h(kno)o(wn)f(from)g(data)g(t)o(yp)q(es.)1076 1593
y(This)i(pap)q(er)f(suggests)h(a)f(\(de\)comp)q(ositiona)q(l)j(view)d
(of)g(graphs)1020 1634 y(whic)o(h)h(is)f(v)o(ery)h(close)g(to)f(that)g
(of)g(data)g(t)o(yp)q(es.)20 b(This)15 b(giv)o(es)g(a)f(new)1020
1676 y(\015a)o(v)o(or)j(of)f(de\014ning)j(graph)e(algorithms)i(and)e
(clears)g(the)g(w)o(a)o(y)f(for)1020 1717 y(de\014ning)e(general)f
(fold)f(op)q(erations)i(on)e(graphs.)17 b(W)m(e)12 b(sho)o(w)g(ho)o(w)f
(to)1020 1759 y(de\014ne)g(graph)h(algorithms)g(in)g(terms)e(of)g
(graph)h(folds)h(and)f(ho)o(w)f(this)1020 1800 y(facilitates)17
b(program)f(transformations)g(and)g(optimizations.)25
b(An)1020 1842 y(in)o(tegration)19 b(of)e(the)g(prop)q(osed)i(concept)f
(in)o(to)g(a)f(functional)i(lan-)1020 1883 y(guage)d(requires)h(as)e
(its)h(bac)o(kb)q(one)g(an)g(implemen)o(tation)i(of)d(func-)1020
1925 y(tional,)20 b(or)d(p)q(ersisten)o(t,)i(graphs.)30
b(W)m(e)17 b(ha)o(v)o(e)h(implemen)o(ted)h(func-)1020
1967 y(tional)h(graphs)f(together)f(with)h(graph)f(folds)h(in)g(ML,)e
(pro)o(viding)1020 2008 y(e\016cien)o(t)i(implemen)o(tations)j(for)c
(graph)h(op)q(erations)h(lik)o(e)g(depth-)1020 2050 y(\014rst-searc)o
(h.)1076 2091 y(There)10 b(are)h(t)o(w)o(o)f(w)o(a)o(ys)g(to)h(ac)o
(hiev)o(e)g(suc)o(h)g(an)g(in)o(tegration:)18 b(First,)1020
2133 y(as)d(a)f(language)i(extension.)23 b(This)15 b(allo)o(ws)h(the)f
(optimizations)i(de-)1020 2174 y(scrib)q(ed)g(in)g(Section)g(6)f(to)f
(b)q(e)h(used)h(b)o(y)f(a)g(compiler,)h(and)g(it)f(pro-)1020
2216 y(vides)h(a)e(con)o(v)o(enien)o(t)i(w)o(a)o(y)e(of)g(pattern)h
(matc)o(hing)h(\(Section)g(4\))e(to)1020 2257 y(the)f(user.)19
b(On)13 b(the)h(other)g(hand,)g(it)g(is)h(not)e(reasonable)j(to)d(exp)q
(ect)1020 2299 y(a)h(compiler)i(to)d(pro)o(vide)j(all)f(the)f
(di\013eren)o(t)h(graph)g(represen)o(tation)1020 2340
y(that)j(are)g(needed)h(to)e(e\016cien)o(tly)j(deal)f(with)f(graphs)h
(in)g(sp)q(eci\014c)1020 2382 y(situations.)h(Second,)14
b(b)o(y)f(pro)o(viding)j(a)e(graph)g(library)m(.)19 b(With)14
b(this)1020 2423 y(approac)o(h)g(it)e(is)h(m)o(uc)o(h)g(easier)g(to)f
(pro)o(vide)i(\(and)f(extend\))g(di\013eren)o(t)1020
2465 y(graph)f(implemen)o(tations)q(.)19 b(W)m(e)11 b(follo)o(w)h(the)g
(latter)f(approac)o(h)i(since)1020 2506 y(it)i(seems)f(to)h(b)q(e)f
(more)h(promising,)h(but)f(for)f(the)h(con)o(v)o(enien)o(t)h(pre-)1020
2548 y(sen)o(tation)i(of)d(examples)j(in)f(this)g(pap)q(er)g(w)o(e)e
(assume)i(ha)o(ving)h(the)1020 2589 y(pattern)c(matc)o(hing)g
(capabilit)o(y)i(a)o(v)n(ailable.)p eop
%%Page: 2 2
2 1 bop 520 -30 2 46 v 581 -44 a Ft([4])p 682 -30 V 121
w([13)q(])p 863 -30 V 121 w([7])p 1025 -30 V 121 w([14])p
1207 -30 V 121 w([10])p 1388 -30 V 83 w(This)14 b(pap)q(er)p
1616 -30 V 311 -29 1306 2 v 311 -19 V 334 13 a(generalit)o(y)p
520 26 2 46 v 80 w(y)o(es)p 682 26 V 121 w(y)o(es)p 863
26 V 126 w(no)p 1025 26 V 111 w(\(y)o(es\))p 1207 26
V 121 w(no)p 1388 26 V 159 w(y)o(es)p 1616 26 V 311 28
1306 2 v 346 60 a(e\016ciency)p 520 74 2 46 v 84 w(no)p
682 74 V 132 w(no)p 863 74 V 126 w(y)o(es)p 1025 74 V
121 w(y)o(es)p 1207 74 V 136 w(no)p 1388 74 V 159 w(y)o(es)p
1616 74 V 311 75 1306 2 v 355 107 a(pureness)p 520 121
2 46 v 79 w(y)o(es)p 682 121 V 121 w(y)o(es)p 863 121
V 120 w(y)o(es)p 1025 121 V 127 w(no)p 1207 121 V 135
w(y)o(es)p 1388 121 V 154 w(y)o(es)p 1616 121 V 311 123
1306 2 v 350 155 a(clearness)p 520 168 2 46 v 85 w(no)p
682 168 V 112 w(\(y)o(es\))p 863 168 V 105 w(y)o(es)p
1025 168 V 121 w(y)o(es)p 1207 168 V 130 w(y)o(es)p 1388
168 V 154 w(y)o(es)p 1616 168 V 311 170 1306 2 v 340
202 a(reasoning)p 520 216 2 46 v 85 w(no)p 682 216 V
132 w(no)p 863 216 V 132 w(no)p 1025 216 V 111 w(\(y)o(es\))p
1207 216 V 115 w(y)o(es)p 1388 216 V 154 w(y)o(es)p 1616
216 V 311 217 1306 2 v 509 289 a(Figure)h(1:)h(T)m(reatmen)o(t)d(of)g
(graphs)h(in)g(functional)h(languages.)-76 451 y Fu(2)53
b(Related)18 b(W)l(ork)-20 529 y Ft(In)12 b([4])f(the)g(state)h(used)g
(b)o(y)g(graph)g(algorithms)i(is)e(sim)o(ulated)i(b)o(y)-76
571 y(functional)j(arra)o(ys)f(that)f(are)g(threaded)h(through)h
(function)f(calls.)-76 612 y(It)11 b(is)i(sho)o(wn)f(ho)o(w)f(to)h
(directly)h(transfer)f(classical)j(algorithms)e(in)o(to)-76
654 y(a)k(lazy)h(functional)i(language,)g(but)d(no)h(particular)h(use)e
(of)g(func-)-76 695 y(tional)k(languages)g(is)f(made)g(in)g(the)f
(design)i(of)e(the)g(algorithms)-76 737 y(themselv)o(es.)-20
778 y(In)i(con)o(trast,)i(in)f([13])e(algorithms)j(are)e(describ)q(ed)h
(as)f(\014xed)-76 820 y(p)q(oin)o(ts)14 b(of)d(recursiv)o(e)j
(equations)g(whic)o(h)f(essen)o(tially)h(relies)g(on)e(lazy)-76
861 y(ev)n(aluation.)18 b(Though)11 b(b)q(eing)g(\\more)e(functional",)
k(the)c(algorithms)-76 903 y(b)q(ecome)18 b(quite)h(complex)f(and)g
(are)g(rather)g(di\016cult)h(to)e(compre-)-76 944 y(hend.)j(Both)14
b(approac)o(hes)h(do)f(not)f(ac)o(hiev)o(e)i(the)f(asymptotic)h(run-)
-76 986 y(time)f(of)e(imp)q(erativ)o(e)j(algorithms.)-20
1027 y(In)c([7])f(w)o(e)g(ha)o(v)o(e)h(iden)o(ti\014ed)i(some)e
(classes)g(of)g(graph)g(algorithms)-76 1069 y(and)17
b(ha)o(v)o(e)f(in)o(tro)q(duced)i(a)e(few)g(corresp)q(onding)i
(prede\014ned)g(op)q(er-)-76 1110 y(ators.)31 b(A)17
b(graph)i(algorithm)g(is)g(realized)g(b)o(y)f(simply)h(pro)o(viding)-76
1152 y(an)13 b(op)q(erator)h(with)f(some)f(parameter)i(functions)g(and)
f(data)g(struc-)-76 1193 y(tures.)26 b(W)m(e)16 b(b)q(eliev)o(e)i(that)
e(the)g(approac)o(h)h(re\015ects)g(the)f(structure)-76
1235 y(of)g(graph)h(algorithms)i(v)o(ery)e(w)o(ell.)28
b(Ho)o(w)o(ev)o(er,)16 b(lik)o(e)i(the)e(previous)-76
1276 y(t)o(w)o(o)e(approac)o(hes)h(there)f(is)h(not)f(m)o(uc)o(h)h(p)q
(oten)o(tial)h(for)d(formal)i(pro-)-76 1318 y(gram)f(manipulation.)21
b(Moreo)o(v)o(er,)13 b(the)h(op)q(erator)g(approac)o(h)g(lac)o(ks)-76
1359 y(generalit)o(y)m(.)-20 1401 y(In)h(the)f(prop)q(osal)j(of)d([14])
g(the)h(fo)q(cus)g(is)g(on)g(a)f(generated)i(data)-76
1442 y(structure,)c(the)g(depth-\014rst)h(spanning)h(forest,)e(instead)
h(of)e(the)h(un-)-76 1484 y(derlying)j(graph)f(algorithm.)k(This)c
(facilitates)g(formal)g(reasoning,)-76 1525 y(in)k(particular,)i(the)d
(formal)g(dev)o(elopmen)o(t)i(of)e(man)o(y)g(algorithms)-76
1567 y(based)g(on)g(depth-\014rst)g(searc)o(h)g(\(dfs\))f(b)q(ecomes)h
(p)q(ossible.)29 b(More-)-76 1608 y(o)o(v)o(er,)20 b(Launc)o(h)o(bury)h
(sho)o(ws)e(in)h([15])e(ho)o(w)h(phase)h(fusion)g(can)f(b)q(e)-76
1650 y(applied)h(to)d(eliminate)j(in)o(termediate)f(results)f(of)f
(some)h(of)f(these)-76 1691 y(algorithms.)34 b(The)18
b(dfs)g(function)h(itself)g(is)g(realized)h(nicely)f(in)g(a)-76
1733 y(generate-and-prune)13 b(manner.)k(Monads)11 b(are)g(used)g(to)f
(implemen)o(t)-76 1774 y(the)h(state)f(main)o(tained)j(during)f(dfs)e
(\(that)h(is,)g(the)f(v)o(ertices)h(visited\))-76 1816
y(to)j(ac)o(hiev)o(e)i(linear)g(running)g(time.)22 b(A)o(t)14
b(this)h(p)q(oin)o(t)g(the)g(approac)o(h)-76 1857 y(is)g(stuc)o(k)g
(with)g(the)g(imp)q(erativ)o(e)i(programming)f(st)o(yle.)23
b(Although)-76 1899 y(encapsulated)c(and)e(restricted)g(to)g(a)f
(single)i(p)q(oin)o(t,)g(it)f(comes)g(up)-76 1940 y(in)d(the)g(pro)q
(cess)g(of)e(program)i(fusion)h(where)e(transformations)i(b)q(e-)-76
1982 y(come)f(quite)h(complex)g(when)f(functions)h(are)f(mo)o(v)o(ed)g
(across)g(state)-76 2023 y(transformers.)k(As)12 b(y)o(et)h(the)h
(approac)o(h)g(applies)h(just)e(to)g(dfs.)-20 2065 y(F)m(egaras)k(and)g
(Sheard)h(in)o(v)o(estigate)h(in)e([10])f(a)h(generalization)-76
2106 y(of)f(fold)g(op)q(erations)i(to)d(data)i(t)o(yp)q(es)f(with)g(em)
o(b)q(edded)h(functions.)-76 2148 y(As)11 b(one)g(motiv)n(ating)i
(example)f(they)g(sho)o(w)f(ho)o(w)g(to)f(mo)q(del)j(graphs.)-76
2189 y(Ho)o(w)o(ev)o(er,)f(that)h(approac)o(h)h(is)f(somewhat)f
(limited)j(\(it)e(is)g(not)f(clear)-76 2231 y(ho)o(w)f(to)g(de\014ne,)h
(for)f(example,)h(a)f(function)i(for)e(rev)o(ersing)h(all)h(edges)-76
2272 y(in)18 b(a)e(graph\))i(and)f(it)g(lac)o(ks)h(e\016ciency)g(since)
g(direct)f(access)h(to)e(a)-76 2314 y(no)q(de)e(requires,)g(in)g
(general,)g(tra)o(v)o(ersal)g(of)f(the)g(whole)h(graph.)-20
2356 y(Also)j(related)f(is)h(the)f(w)o(ork)f(of)h(Gibb)q(ons)h([11])f
(who)f(considers)-76 2397 y(the)h(de\014nition)i(of)e(graph)h(fold)f
(op)q(erations)i(within)f(an)f(algebraic)-76 2439 y(framew)o(ork.)23
b(But)15 b(he)g(deals)i(only)f(with)f(acyclic)i(graphs,)f(and)g(an)-76
2480 y(implemen)o(tation)e(is)d(not)f(discussed,)j(so)d(that)h(his)g
(approac)o(h)h(is)f(cur-)-76 2522 y(ren)o(tly)j(not)g(usable.)19
b(A)13 b(summary)h(of)f(the)g(preceding)i(comparison)-76
2563 y(is)f(sho)o(wn)f(in)h(Figure)g(1.)-20 2605 y(In)20
b(the)g(next)g(section)h(w)o(e)f(de\014ne)h(graph)f(constructors)i(and)
1020 451 y(sho)o(w)d(their)g(use)g(in)g(buildin)q(g)i(directed)f
(graphs.)35 b(In)18 b(Section)i(4)1020 492 y(w)o(e)15
b(describ)q(e)h(a)g(sp)q(ecial)h(kind)f(of)f(pattern)h(matc)o(hing)h
(for)d(graphs.)1020 534 y(Section)h(5)e(presen)o(ts)i(some)e(fold)i(op)
q(erations.)20 b(Tw)o(o)13 b(theorems)h(are)1020 575
y(giv)o(en)f(in)f(Section)h(6)f(to)g(demonstrate)g(the)g(optimization)j
(of)c(graph)1020 617 y(algorithms)16 b(b)o(y)e(simple)h(program)f
(transformations.)20 b(The)14 b(imple-)1020 658 y(men)o(tation)j(is)g
(describ)q(ed)h(in)f(Section)g(7,)f(and)h(some)f(conclusions)1020
700 y(follo)o(w)e(in)g(Section)g(8.)1020 812 y Fu(3)52
b(A)17 b(Mo)q(del)i(of)e(Directed)h(Graphs)1020 891 y
Ft(W)m(e)13 b(prop)q(ose)h(a)f(\(de\)comp)q(ositional)k(view)c(of)g
(graphs)h(in)f(the)g(st)o(yle)1020 932 y(of)24 b(algebraic)i(data)e(t)o
(yp)q(es)g(found)h(in)f(languages)i(lik)o(e)f(ML)f(or)1020
974 y(Hask)o(ell:)g(a)15 b(graph)h(is)h(either)f(empt)o(y)m(,)g(or)f
(it)h(is)h(constructed)f(b)o(y)g(a)1020 1015 y(graph)c
Fo(G)g Ft(and)g(a)f(new)h(no)q(de)g Fo(v)g Ft(together)h(with)e(edges)i
(from)e Fo(v)h Ft(to)g(its)1020 1057 y(successors)g(in)g
Fo(G)f Ft(and)h(edges)g(from)f(its)g(predecessors)i(in)f
Fo(G)f Ft(leading)1020 1098 y(to)j Fo(v)q Ft(.)k(This)c(view)g(is)g
(closely)i(related)e(to)g(an)g(adjacency)g(represen-)1020
1140 y(tation)h(of)e(graphs.)20 b(The)14 b(main)h(di\013erence)g(to)f
(data)g(t)o(yp)q(es)h(is)f(that)1020 1181 y(predecessors)g(are)f(men)o
(tioned)h(explicitly)n(.)19 b(W)m(e)13 b(presen)o(t)g(our)g(ideas)1020
1223 y(in)h(terms)g(of)f(ML,)g(but)h(a)f(translation)j(to)d(other)h
(languages)i(is)e(not)1020 1264 y(di\016cult.)1020 1373
y Fu(3.1)52 b(Graph)18 b(Constructors)1020 1439 y Ft(There)e(are)g
(quite)h(di\013eren)o(t)g(kinds)h(of)d(graphs,)j(and)e(it)h(is)f
(almost)1020 1480 y(imp)q(ossible)f(to)d(capture)g(all)h(asp)q(ects)g
(in)g(a)e(single)j(t)o(yp)q(e.)j(Therefore)1020 1522
y(w)o(e)f(fo)q(cus)i(in)f(the)g(follo)o(wing)i(on)e(directed,)i(no)q
(de-lab)q(eled)h(m)o(ulti-)1020 1563 y(graphs.)30 b(This,)19
b(on)e(the)g(one)h(hand,)g(includes)i(some)d(non-trivial)1020
1605 y(asp)q(ects,)c(suc)o(h)h(as)f(m)o(ultiple)j(edges)d(b)q(et)o(w)o
(een)g(t)o(w)o(o)g(no)q(des,)g(and,)h(on)1020 1646 y(the)i(other)g
(hand)h(lea)o(v)o(es)g(out)g(other)f(details,)i(for)e(example,)i(edge)
1020 1688 y(lab)q(els,)c(that)e(w)o(ould)h(only)g(mak)o(e)f(examples)h
(longer)g(and)g(more)f(dif-)1020 1729 y(\014cult)g(to)f(read.)16
b(Adaption)d(to)d(other)i(graphs)f(t)o(yp)q(es)h(is)f(straigh)o(tfor-)
1020 1771 y(w)o(ard.)16 b(The)8 b(constructiv)o(e)j(view)f(of)e(graphs)
i(suggests)g(the)f(follo)o(wing)1020 1812 y(t)o(w)o(o)k(constructors:)
1020 1895 y Fn(Empty)n(:)19 b('a)g(graph)1020 1937 y(&:)g('a)g(context)
e(*)i('a)g(graph)e(->)i('a)g(graph)1020 2020 y Ft(The)10
b(t)o(yp)q(e)h(parameter)g Fn('a)e Ft(giv)o(es)i(the)g(t)o(yp)q(e)f(of)
g(no)q(de)h(lab)q(els.)18 b(Distin-)1020 2061 y(guishing)e(b)q(et)o(w)o
(een)e(no)q(des)g(and)h(no)q(de)f(lab)q(els)h(is)f(necessary)h(when-)
1020 2103 y(ev)o(er)j(di\013eren)o(t)i(no)q(des)f(ma)o(y)f(ha)o(v)o(e)h
(the)f(same)h(lab)q(el,)i(see)d(Figure)1020 2145 y(2.)32
b(\(This)18 b(example)i(also)f(sho)o(ws)f(the)g(need)g(for)g(m)o
(ultiple)i(edges)1020 2186 y(b)q(et)o(w)o(een)13 b(t)o(w)o(o)g(no)q
(des.\))1076 2228 y(The)f(con)o(text)g(of)f(a)h(no)q(de)h(is)f(the)g
(no)q(de)g(itself)h(together)f(with)h(its)1020 2269 y(lab)q(el)i(and)f
(the)f(lists)h(of)f(its)h(predecessors)g(\(\014rst)f(comp)q(onen)o(t\))
h(and)1020 2311 y(its)g(successors)g(\(last)f(comp)q(onen)o(t\):)1020
2394 y Fn(type)18 b('a)h(context)e(=)1118 2435 y(node)h(list)g(*)h
(node)g(*)g('a)g(*)g(node)f(list)1020 2518 y Ft(The)c(requiremen)o(ts)i
(on)e(the)g(t)o(yp)q(e)g Fn(node)e Ft(are)i(giv)o(en)i(b)o(y)e(the)g
(signa-)1020 2560 y(ture)k(b)q(elo)o(w.)33 b(In)18 b(particular,)j(w)o
(e)c(ha)o(v)o(e)i(to)f(create)g(no)q(de)h(v)n(alues)961
2747 y(2)p eop
%%Page: 3 3
3 2 bop -76 -34 a Ft(b)q(efore)14 b(w)o(e)f(can)h(build)h(a)f(graph.)19
b(This)14 b(is)g(done)h(b)o(y)e(the)h Fn(gen)e Ft(func-)-76
7 y(tion)g(that)e(generates)i(an)o(y)f(requested)g(n)o(um)o(b)q(er)g
(of)g(di\013eren)o(t)h(no)q(des.)-76 90 y Fn(sig)-37
132 y(eqtype)18 b(node)-37 173 y(val)h(gen)f(:)i(int)e(->)h(node)f
(list)-37 215 y(val)h(new)f(:)i(node)e(list)g(->)h(node)-76
256 y(end)-76 339 y Ft(In)12 b(the)g(subsequen)o(t)i(examples)f(w)o(e)f
(will)h(use)f(the)h(follo)o(wing)h(no)q(des:)-76 381
y Fn(val)19 b([A,B,C,D])d(=)j(gen)f(4)p Ft(.)-20 422
y(The)9 b(function)i Fn(new)d Ft(creates)h(a)g(no)q(de)h(that)g(is)g
(not)f(con)o(tained)i(in)f(a)-76 464 y(giv)o(en)j(list)f(of)f(no)q
(des.)17 b(This)12 b(function)h(is)e(useful)i(when)e(extending)i(a)-76
505 y(graph)e(whose)e(construction)j(history)f(is)f(not)g(kno)o(wn)g
(since)h(w)o(e)e(need)-76 547 y(a)14 b(no)q(de)g(v)n(alue)h(not)f
(already)h(con)o(tained)h(in)e(the)g(graph.)20 b(Ho)o(w)o(ev)o(er,)-76
588 y(to)13 b(apply)i Fn(new)c Ft(w)o(e)i(ha)o(v)o(e)h(to)e(extract)i
(the)f(no)q(des)h(of)f(a)g(graph.)18 b(This)-76 630 y(is)c(done)g(b)o
(y)f(the)g(function)h Fn(nodes)p Ft(:)-76 713 y Fn(val)19
b(nodes:)e('a)i(graph)e(->)i(node)f(list)-76 796 y Ft(As)h(an)g
(example,)j(w)o(e)c(construct)i(a)f(cycle)h(of)e(three)i(no)q(des)g
(and)-76 837 y(extend)13 b(it)g(b)o(y)f(a)g(no)q(de)h(with)f(an)h(edge)
f(to)g(some)h(no)q(de)g(of)e(the)i(cycle.)-76 920 y Fn(val)19
b(cyc)f(=)h(\([C],A,1,[)o(B]\))d(&)j(\([],B,2,[C)o(]\))d(&)120
962 y(\([],C,3,[])o(\))h(&)i(Empty)-76 1003 y(let)g(val)f(N)h(=)h
(nodes)d(cyc)-56 1045 y(in)i(\([],new)e(N,4,[hd)f(N]\))j(&)g(cyc)g(end)
-76 1128 y Ft(The)12 b(D)o(A)o(G)g(for)f(the)h(expression)i(1)6
b(+)g(\(2)g(+)g(2\))13 b(and)f(a)g(graph)h(expres-)-76
1169 y(sion)h(for)f(it)g(are)h(sho)o(wn)f(in)h(Figure)g(2.)384
1297 y Fm(?>=<)-66 b(89:;)402 1308 y Ft(+)310 1386 y
Fl(|)p Fk(|)p Fj(y)325 1374 y(y)341 1361 y(y)356 1348
y(y)371 1336 y(y)525 1385 y Fl(")p Fk(")510 1372 y Fj(F)494
1359 y(F)479 1347 y(F)463 1335 y(F)447 1322 y(F)250 1408
y Fm(?>=<)g(89:;)273 1421 y Ft(1)523 1408 y Fm(?>=<)g(89:;)541
1418 y Ft(+)539 1541 y Fl(\024)p Fk(\024)p 539 1445 2
2 v 539 1446 V 538 1448 V 538 1449 V 537 1450 V 537 1452
V 537 1453 V 536 1454 V 536 1456 V 535 1457 V 535 1458
V 535 1460 V 534 1461 V 534 1462 V 534 1464 V 534 1465
V 533 1466 V 533 1468 V 533 1469 V 533 1470 V 532 1472
V 532 1473 V 532 1474 V 532 1476 V 532 1477 V 532 1478
V 531 1480 V 531 1481 V 531 1482 V 531 1483 V 531 1485
V 531 1486 V 531 1487 V 531 1489 V 531 1490 V 531 1491
V 531 1493 V 531 1494 V 531 1495 V 531 1497 V 531 1498
V 531 1499 V 531 1501 V 531 1502 V 531 1503 V 531 1505
V 531 1506 V 531 1507 V 531 1509 V 532 1510 V 532 1511
V 532 1513 V 532 1514 V 532 1515 V 532 1517 V 533 1518
V 533 1519 V 533 1521 V 533 1522 V 534 1523 V 534 1524
V 534 1526 V 534 1527 V 535 1528 V 535 1530 V 535 1531
V 536 1532 V 536 1534 V 537 1535 V 537 1536 V 537 1538
V 538 1539 V 538 1540 V 539 1542 V 34 w Fl(\012)p Fk(\012)p
572 1445 V 573 1446 V 573 1448 V 573 1449 V 574 1450
V 574 1452 V 575 1453 V 575 1454 V 575 1456 V 576 1457
V 576 1458 V 576 1460 V 577 1461 V 577 1462 V 577 1464
V 578 1465 V 578 1466 V 578 1468 V 578 1469 V 579 1470
V 579 1472 V 579 1473 V 579 1474 V 579 1476 V 579 1477
V 580 1478 V 580 1480 V 580 1481 V 580 1482 V 580 1483
V 580 1485 V 580 1486 V 580 1487 V 580 1489 V 580 1490
V 580 1491 V 580 1493 V 580 1494 V 580 1495 V 580 1497
V 580 1498 V 580 1499 V 580 1501 V 580 1502 V 580 1503
V 580 1505 V 580 1506 V 580 1507 V 580 1509 V 580 1510
V 579 1511 V 579 1513 V 579 1514 V 579 1515 V 579 1517
V 579 1518 V 578 1519 V 578 1521 V 578 1522 V 578 1523
V 577 1524 V 577 1526 V 577 1527 V 576 1528 V 576 1530
V 576 1531 V 575 1532 V 575 1534 V 575 1535 V 574 1536
V 574 1538 V 573 1539 V 573 1540 V 573 1542 V 523 1577
a Fm(?>=<)g(89:;)547 1590 y Ft(2)-35 1690 y Fn(datatype)16
b(int)p 203 1690 12 2 v 13 w(expr)i(=)i(CON)e(of)h(int)312
1731 y(|)39 b(OP)19 b(of)g(int)f(*)i(int)e(->)h(int)-35
1797 y(val)f(exprDag)f(=)43 1839 y(\([],D,OP)g(\(op)h(+\),[B,C]\))e(&)
43 1881 y(\([],C,CON)g(1,[]\))i(&)h(\([],B,OP)e(\(op)h(+\),[A,A]\))e(&)
43 1922 y(\([],A,CON)g(2,[]\))i(&)h(Empty)58 2006 y Ft(Figure)14
b(2:)j(A)c(D)o(A)o(G)g(and)g(its)h(graph)g(expression.)-76
2199 y Fu(3.2)52 b(Seman)o(tics)16 b(of)h(Graph)h(Constructors)-76
2264 y Ft(A)d(graph)h Fo(G)d Ft(=)h(\()p Fo(V)r(;)7 b(E)r(;)f(\027)r
Ft(\))15 b(of)g(t)o(yp)q(e)g Fo(\013)g Ft(consists)h(of)f(a)g(set)g(of)
f(no)q(des)-76 2306 y Fo(V)9 b Ft(,)j(a)f(m)o(ultiset)j(\(or,)d(bag\))i
(of)e(edges)i Fo(E)g Fi(2)d(M)p Ft(\()p Fo(V)15 b Fi(\002)6
b Fo(V)j Ft(\),)i(and)i(a)e(total)-76 2347 y(mapping)16
b Fo(\027)e Ft(:)e Fo(V)21 b Fi(!)13 b Fo(\013)g Ft(de\014ning)j(the)e
(no)q(de)h(lab)q(els.)21 b(Represen)o(ting)-76 2389 y(the)d(edges)h(of)
e(a)h(graph)h(as)e(a)h(bag)h(of)e(no)q(de)i(pairs)g(accoun)o(ts)f(for)
-76 2430 y(m)o(ultiple)e(edges)d(b)q(et)o(w)o(een)g(t)o(w)o(o)g(no)q
(des.)-20 2472 y(The)h(seman)o(tics)i(of)d(the)i(ab)q(o)o(v)o(e)g
(graph)g(constructors)g(with)g(re-)-76 2513 y(sp)q(ect)d(to)g(this)g
(graph)h(mo)q(del)f(is)h(giv)o(en)f(b)o(y)g(inference)h(rules)g(as)f
(used)-76 2555 y(in)j(the)g(de\014nition)i(of)e(Standard)h(ML)e([19],)g
(see)h(Figure)g(3:)20 b(an)15 b(as-)-76 2596 y(sertion)20
b Fo(\032)11 b Fi(`)g Fn(e)f Fi(\))h Fo(v)20 b Ft(sa)o(ys)f(that)g
(expression)i Fn(e)e Ft(ev)n(aluates)h(in)g(the)1020
-34 y(en)o(vironmen)o(t)g Fo(\032)d Ft(to)h(the)g(v)n(alue)h
Fo(v)q Ft(.)32 b(F)m(or)17 b(simplici)q(t)o(y)m(,)k(w)o(e)c(assume)1020
7 y(ha)o(ving)j(bags)f(as)f(seman)o(tic)i(v)n(alues,)g(and)f(w)o(e)f
(denote)h(a)f(bag)h(b)o(y)1020 49 y(writing)f(a)e(sequence)h(of)f(its)h
(elemen)o(ts,)h(that)e(is,)i Fi(h)p Fo(x)1806 53 y Fh(1)1823
49 y Fo(;)6 b(:)g(:)g(:)g(;)g(x)1930 53 y Fg(n)1951 49
y Fi(i)16 b Ft(or)p 1020 69 44 2 v 1020 90 a Fo(x)1042
94 y Fg(n)1076 90 y Ft(for)c(short,)i(disregarding)h(the)f(order)f(of)g
(elemen)o(ts.)18 b(The)12 b(union)1020 132 y(of)i(t)o(w)o(o)g(bags)h
(is)g(written)g(lik)o(e)h(the)f(concatenation)h(of)e(t)o(w)o(o)g(lists)
i Fo(L)1020 173 y Ft(and)e Fo(L)1121 157 y Ff(0)1145
173 y Ft(b)o(y)f Fo(L)c Fi(\001)f Fo(L)1278 157 y Ff(0)1289
173 y Ft(.)1076 215 y(The)i(last)h(t)o(w)o(o)f(rules)h(describ)q(e)h
(exceptional)h(situations:)18 b(trying)1020 256 y(to)e(add)h(a)g(con)o
(text)g(for)f(an)h(already)h(existing)g(no)q(de)f(results)h(in)f(a)1020
298 y Fn(Node)e Ft(exception.)31 b(Lik)o(ewise,)19 b(trying)f(to)f(add)
h(an)f(edge)h(b)q(et)o(w)o(een)1020 339 y(non-existing)k(no)q(des)e
(raises)h(an)f Fn(Edge)d Ft(exception.)38 b(\(Note)19
b(that)1020 381 y(adding)i(a)f(tuple)g(\()p Fo(v)q(;)6
b(w)q Ft(\))19 b(to)g(the)g(edge)h(bag)g(of)f(a)g(graph)i(means)1020
422 y(not)e(only)g(that)g Fo(w)f Ft(is)h(a)f(successor)i(of)e
Fo(v)q Ft(,)h(but)f(also)i(that)e Fo(v)h Ft(is)g(a)1020
464 y(predecessor)14 b(of)f Fo(w)q Ft(.\))1076 505 y(It)k(is)i(not)f
(di\016cult)h(to)f(de\014ne)h(t)o(w)o(o)e(functions)j
Fn(addnode)14 b Ft(and)1020 547 y Fn(addedge)9 b Ft(for)j(adding)i(a)e
(single)h(no)q(de)g(\(without)g(predecessors)g(and)1020
588 y(successors\))k(and)f(a)f(single)i(edge)f(\(b)q(et)o(w)o(een)g(t)o
(w)o(o)f(no)q(des)h(that)g(are)1020 630 y(kno)o(wn)e(to)f(b)q(e)g
(already)h(con)o(tained)h(in)f(the)f(graph\):)1020 713
y Fn(fun)19 b(addnode)d(\(v,l\))i(g)h(=)h(\([],v,l,)o([]\))c(&)j(g)1020
754 y(fun)g(addedge)d(\(v,w\))i(\(\(p,u,l,s\))e(&)j(g\))g(=)1099
796 y(if)f(u=v)h(then)f(\(p,u,l,w:)o(:s\))e(&)j(g)g(else)1099
837 y(if)f(u=w)h(then)f(\(v::p,u,l)o(,s\))e(&)j(g)1236
879 y(else)f(\(p,u,l,s\))e(&)j(\(addedge)e(\(v,w\))g(g\))1020
962 y Ft(These)e(can)g(b)q(e)g(used)g(to)f(build)j(an)o(y)e(graph)g(b)o
(y)g(\014rst)g(inserting)i(all)1020 1003 y(no)q(des)d(and)g(after)e
(that)i(inserting)h(all)f(edges.)k(Hence)13 b(w)o(e)f(kno)o(w:)1020
1083 y Fe(Theorem)j(1)g(\(Completeness\))1020 1125 y
Fs(A)o(ny)e(no)n(de-lab)n(ele)n(d)e(multi-gr)n(aph)h(c)n(an)i(b)n(e)g
(r)n(epr)n(esente)n(d)e(by)h(a)i(gr)n(aph)1020 1166 y(expr)n(ession.)
782 b Fd(2)1020 1279 y Fu(4)52 b(P)o(attern)18 b(Matc)o(hing)g(on)g
(Graphs)1020 1357 y Ft(Regarding)j(the)e(free)f(term)g(algebra)i
(generated)g(b)o(y)f Fn(Empty)d Ft(and)1020 1399 y Fn(&)p
Ft(,)f(pattern)i(matc)o(hing)g(is)f(the)f(same)h(as)g(with)g(other)g
(data)g(t)o(yp)q(es.)1020 1440 y(F)m(or)f(example,)h(w)o(e)f(can)g
(de\014ne)h(a)e(function)j Fn(gmap)c Ft(for)h(mapping)j(a)1020
1482 y(function)d(to)f(all)i(no)q(de)f(lab)q(els)g(of)f(a)g(graph:)1020
1565 y Fn(fun)19 b(gmap)f(f)h(Empty)e(=)j(Empty)1040
1606 y(|)39 b(gmap)18 b(f)h(\(\(p)o(,v)o(,l)o(,s)o(\))h(&)f(g)o(\))h(=)
1236 1648 y(\(p)o(,v)o(,f)f(l,s)o(\))g(&)g(\(gmap)f(f)h(g\))1020
1731 y Ft(The)c(seman)o(tics)h(of)f(graphs,)h(ho)o(w)o(ev)o(er,)g
(suggests)g(that)f(some)g(dis-)1020 1773 y(tinct)20 b(graphs)g(should)h
(b)q(e)f(regarded)g(as)f(equal.)37 b(In)19 b(particular,)1020
1814 y(man)o(y)c(function)i(de\014nitions)g(b)q(ecome)f(more)e(con)o(v)
o(enien)o(t)j(when)e(a)1020 1856 y(kind)e(of)f(pattern)g(matc)o(hing)h
(could)g(b)q(e)f(used)h(that)f(abstracts)g(a)o(w)o(a)o(y)1020
1897 y(the)17 b(order)g(of)f(no)q(de/edge)i(insertions.)30
b(Consider,)19 b(for)d(example,)1020 1939 y(functions)e
Fn(suc)d Ft(and)j Fn(del)d Ft(for)h(selecting)j(the)d(successors)i(of)e
(no)q(de)i Fn(v)1020 1980 y Ft(in)i(a)f(graph)i Fn(g)o
Ft(,)f(resp)q(ectiv)o(ely)m(,)h(for)e(deleting)j Fn(v)c
Ft(from)h Fn(g)p Ft(.)24 b(F)m(unction)1020 2022 y(de\014nitions)c(get)
c(remark)n(ably)j(simple)f(when)f(no)q(de)g Fn(v)f Ft(is)i(inserted)
1020 2063 y(last)d(in)o(to)f Fn(g)p Ft(,)g(that)g(is,)g
Fn(g)e Ft(=)g Fn(\(p)o(,v)o(,l)o(,s\))19 b(&)g(g')o Ft(:)g(then)14
b(w)o(e)f(can)i(sim-)1020 2105 y(ply)h(return)f Fn(s)p
Ft(,)g(resp)q(ectiv)o(ely)m(,)i Fn(g')d Ft(as)h(result.)24
b(It)15 b(is)g(an)g(immediate)1020 2146 y(corollary)i(of)d(Theorem)h(1)
g(that)f(w)o(e)g(can)h(alw)o(a)o(ys)h(reorganize)g Fn(g)e
Ft(to)1020 2188 y(obtain)g(the)f(term)f(ab)q(o)o(v)o(e,)h(since)h(for)e
(an)o(y)i(graph)f Fn(g)f Ft(w)o(e)g(can)h(alw)o(a)o(ys)1020
2229 y(\014nd)h(a)f(term)h(for)f(a)g(graph)h Fn(g')e
Ft(with)i(a)f(sp)q(eci\014c)i(no)q(de)f Fn(v)f Ft(\(and)h(inci-)1020
2271 y(den)o(t)e(edges\))g(remo)o(v)o(ed,)h(so)e(that)h
Fn(g)f Ft(can)h(b)q(e)g(obtained)i(b)o(y)e(inserting)1020
2312 y Fn(v)g Ft(together)i(with)f(its)h(inciden)o(t)h(edges)f(in)o(to)
g Fn(g')p Ft(.)1076 2354 y(Miranda)22 b Fs(laws)h Ft(and)e(the)g
Fs(views)i Ft(mec)o(hanism)f(prop)q(osed)g(b)o(y)1020
2395 y(W)m(adler)e([23])d(allo)o(w)j(pattern)f(matc)o(hing)h(on)e
(non-free)h(algebraic)1020 2437 y(data)e(t)o(yp)q(es)h(b)o(y)f(mapping)
h(data)f(t)o(yp)q(e)g(terms)g(to)g(canonical)i(rep-)1020
2478 y(resen)o(tations.)40 b(F)m(or)20 b(our)h(purp)q(oses)g(instead)h
(of)e(mapping)i(to)e(a)1020 2520 y(canonical)k(represen)o(tation)f(w)o
(e)d(rather)i(need)f(to)g(select)h(a)f(sp)q(e-)1020 2561
y(ci\014c)f(represen)o(tation)h(\(among)e(sev)o(eral)h(equiv)n(alen)o
(t\))h(via)f(a)f(pat-)1020 2603 y(tern,)11 b(namely)g(one)g(with)g(a)f
(certain)h(no)q(de)g(inserted)h(last.)17 b(With)11 b(the)961
2747 y(3)p eop
%%Page: 4 4
4 3 bop 746 -36 426 2 v 769 -7 a Fo(\032)10 b Fi(`)h
Fn(Empty)e Fi(\))i Ft(\()p Fc(\037)p Fo(;)6 b Fi(hi)p
Fo(;)g Fc(\037)p Ft(\))279 70 y Fo(\032)k Fi(`)h Fn(g)g
Fi(\))g Ft(\()p Fo(V)r(;)6 b(E)r(;)h(\027)r Ft(\))90
b Fo(\032)10 b Fi(`)h Fn(p)f Fi(\))p 796 49 41 2 v 11
w Fo(p)815 74 y Fg(n)927 70 y Fo(\032)g Fi(`)h Fn(v)f
Fi(\))i Fo(v)90 b(\032)11 b Fi(`)g Fn(l)f Fi(\))h Fo(l)91
b(\032)10 b Fi(`)h Fn(s)g Fi(\))p 1570 49 48 2 v 11 w
Fo(s)1588 74 y Fg(m)433 113 y Fo(v)16 b(=)-23 b Fi(2)10
b Fo(V)621 83 y Fb(S)655 93 y Fg(n)655 127 y(i)p Fh(=1)714
113 y Fi(f)p Fo(p)752 117 y Fg(i)765 113 y Fi(g)h(\022)g
Ft(\()p Fo(V)17 b Fi([)8 b(f)p Fo(v)q Fi(g)p Ft(\))1087
83 y Fb(S)1122 93 y Fg(m)1122 127 y(i)p Fh(=1)1180 113
y Fi(f)p Fo(s)1217 117 y Fg(i)1230 113 y Fi(g)j(\022)f
Ft(\()p Fo(V)18 b Fi([)8 b(f)p Fo(v)q Fi(g)p Ft(\))p
218 128 1482 2 v 218 157 a Fo(\032)j Fi(`)g Fn(\(p)o(,v)o(,l)o(,s\))19
b(&)g(g)10 b Fi(\))h Ft(\()p Fo(V)18 b Fi([)8 b(f)p Fo(v)q
Fi(g)p Fo(;)e(E)11 b Fi(\001)d(h)p Ft(\()p Fo(p)868 161
y Fh(1)886 157 y Fo(;)e(v)q Ft(\))p Fo(;)g(:)g(:)g(:)g(;)g
Ft(\()p Fo(p)1057 161 y Fg(n)1079 157 y Fo(;)g(v)q Ft(\))p
Fo(;)g Ft(\()p Fo(v)q(;)g(s)1218 161 y Fh(1)1235 157
y Ft(\))p Fo(;)g(:)g(:)g(:)g(;)g Ft(\()p Fo(v)q(;)g(s)1405
161 y Fg(m)1434 157 y Ft(\))p Fi(i)p Fo(;)g(\027)11 b
Fi([)d(f)p Ft(\()p Fo(v)q(;)e(l)q Ft(\))p Fi(g)p Ft(\))603
240 y Fo(\032)k Fi(`)h Fn(g)g Fi(\))g Ft(\()p Fo(V)r(;)6
b(E)r(;)h(\027)r Ft(\))77 b Fo(\032)10 b Fi(`)h Fn(v)g
Fi(\))g Fo(v)90 b(v)12 b Fi(2)e Fo(V)p 580 255 758 2
v 719 284 a(\032)h Fi(`)g Fn(\(p)o(,v,l)o(,s)o(\))19
b(&)g(g)11 b Fi(\))g Ft([)p Fn(Node)n Ft(])88 362 y Fo(\032)f
Fi(`)i Fn(g)e Fi(\))h Ft(\()p Fo(V)r(;)6 b(E)r(;)h(\027)r
Ft(\))77 b Fo(\032)10 b Fi(`)i Fn(p)e Fi(\))p 593 341
41 2 v 11 w Fo(p)612 366 y Fg(n)710 362 y Fo(\032)h Fi(`)g
Fn(v)f Fi(\))h Fo(v)78 b(\032)10 b Fi(`)h Fn(s)g Fi(\))p
1095 341 48 2 v 11 w Fo(s)1113 366 y Fg(m)1219 362 y
Ft(\()1234 332 y Fb(S)1268 342 y Fg(n)1268 376 y(i)p
Fh(=1)1326 362 y Fi(f)p Fo(p)1364 366 y Fg(i)1378 362
y Fi(g)e([)1440 332 y Fb(S)1475 342 y Fg(m)1475 376 y(i)p
Fh(=1)1533 362 y Fi(f)p Fo(s)1570 366 y Fg(i)1583 362
y Fi(g)p Ft(\))i Fi(6\022)f Ft(\()p Fo(V)18 b Fi([)8
b(f)p Fo(v)q Fi(g)p Ft(\))p 66 377 1787 2 v 719 406 a
Fo(\032)j Fi(`)g Fn(\(p)o(,v,l)o(,s)o(\))19 b(&)g(g)11
b Fi(\))g Ft([)p Fn(Edge)n Ft(])612 526 y(Figure)j(3:)j(Seman)o(tics)d
(of)f(graph)h(constructors.)-76 687 y(ab)q(o)o(v)o(e)i(graph)g(seman)o
(tics)g(w)o(e)f(can)g(easily)i(de\014ne)f(suc)o(h)g(a)f(pattern)-76
729 y(as)k(a)f(language)i(primitiv)o(e.)36 b(W)m(e)18
b(write)h(an)g(en)o(vironmen)o(t)h(map-)-76 770 y(ping)e(v)n(ariables)p
175 749 44 2 v 18 w Fo(x)197 774 y Fg(n)234 770 y Ft(to)f(v)n(alues)p
402 749 40 2 v 17 w Fo(v)421 774 y Fg(n)458 770 y Ft(as)g
Fi(f)p Fo(x)550 774 y Fh(1)578 770 y Fi(7!)11 b Fo(v)646
774 y Fh(1)663 770 y Fo(;)6 b(:)g(:)g(:)g(;)g(x)770 774
y Fg(n)802 770 y Fi(7!)11 b Fo(v)870 774 y Fg(n)891 770
y Fi(g)p Ft(,)-76 812 y(and)k(an)f(assertion)h Fo(\032;)6
b(v)12 b Fi(`)f Fn(p)f Fi(\))h Fo(\032)416 796 y Ff(0)441
812 y Ft(sa)o(ys)k(that)f(pattern)g Fn(p)g Ft(matc)o(hed)-76
854 y(against)19 b(v)n(alue)g Fo(v)g Ft(in)f(the)g(en)o(vironmen)o(t)i
Fo(\032)d Ft(results)i(in)f(the)g(bind-)-76 895 y(ing\(s\))k(\(that)e
(is,)j(v)n(ariable)g(en)o(vironmen)o(t\))f Fo(\032)620
879 y Ff(0)651 895 y Ft([19].)39 b(Let)20 b Fo(G)k Ft(=)-76
937 y(\()p Fo(V)r(;)7 b(E)14 b Fi(\001)d(h)p Ft(\()p
Fo(v)q(;)6 b(s)130 941 y Fh(1)147 937 y Ft(\))p Fo(;)g(:)g(:)g(:)g(;)h
Ft(\()p Fo(v)q(;)f(s)318 941 y Fg(n)339 937 y Ft(\))p
Fo(;)g Ft(\()p Fo(p)405 941 y Fh(1)422 937 y Fo(;)g(v)q
Ft(\))p Fo(;)g(:)g(:)g(:)g(;)h Ft(\()p Fo(p)594 941 y
Fg(m)623 937 y Fo(;)f(v)q Ft(\))p Fi(i)p Fo(;)g(\027)14
b Fi([)d(f)p Ft(\()p Fo(v)q(;)c(l)q Ft(\))p Fi(g)p Ft(\).)-76
978 y(Then:)329 1049 y Fo(\032)k Fi(`)g Fn(v)f Fi(\))h
Fo(v)p -45 1064 935 2 v -45 1093 a(\032;)6 b(G)k Fi(`)i
Fn(\(p)o(,v)o(,l)o(,s\))19 b(&)p 263 1100 20 2 v 19 w(g)10
b Fi(\))109 1134 y(f)p Fn(s)g Fi(7!)p 207 1113 40 2 v
11 w Fo(s)225 1138 y Fg(n)246 1134 y Fo(;)c Fn(p)11 b
Fi(7!)p 343 1113 49 2 v 11 w Fo(p)362 1138 y Fg(m)391
1134 y Fo(;)6 b Fn(l)11 b Fi(7!)g Fo(l)q(;)6 b Fn(g)k
Fi(7!)h Ft(\()p Fo(V)17 b Fi(\000)9 b(f)p Fo(v)q Fi(g)p
Fo(;)d(E)r(;)h(\027)r Ft(\))p Fi(g)-76 1215 y Ft(This)19
b(rule)g(sa)o(ys)f(that)g(the)h(un)o(b)q(ound)h(v)n(ariables)g
Fn(p)o Ft(,)f Fn(l)p Ft(,)f(and)h Fn(s)e Ft(of)-76 1256
y(the)i(pattern)f(are)h(b)q(ound)g(to)g(the)f(corresp)q(onding)j(v)n
(alues)f(of)e Fo(v)q Ft('s)-76 1298 y(con)o(text.)32
b(If)17 b Fo(v)24 b(=)-24 b Fi(2)19 b Fo(V)9 b Ft(,)18
b(a)g(sp)q(ecial)h(seman)o(tic)g(ob)r(ject)f(F)l(AIL)f(is)i(re-)-76
1339 y(turned)h([19].)35 b(F)l(AIL)18 b(is)i(not)f(a)h(v)n(alue,)h(its)
f(only)g(purp)q(ose)h(is)e(to)-76 1381 y(direct)f(pattern)f(matc)o
(hing)h(to)e(the)h(next)g(case.)27 b(If)16 b(the)h(last)g(case)-76
1422 y(returns)i(F)l(AIL,)e(a)i Fn(Match)d Ft(exception)k(is)f(raised.)
34 b(The)19 b(notation)-76 1464 y(in)g(the)f(rule)h(assumes)g(that)f
Fo(n)g Ft(and)h Fo(m)f Ft(are)g(c)o(hosen)h(maximally)m(,)-76
1505 y(that)13 b(is,)g(all)i(edges)e(inciden)o(t)i(to)e
Fo(v)h Ft(are)f(selected.)18 b(Moreo)o(v)o(er,)13 b(writ-)-76
1547 y(ing)h(successors)h(preceding)g(predecessors)g(in)f(the)f(ab)q(o)
o(v)o(e)h(edge)g(list)-76 1588 y(matc)o(hes)f(self)h(lo)q(ops)g(as)f
(successor-based,)h(that)f(is,)g(matc)o(hing)h(the)-76
1630 y(pattern)k Fn(\(p,A,l,s\))e(&)j(g)d Ft(to)h(the)g(expression)i
Fn(\([A],A,1,)o([]\))d(&)-76 1671 y(Empty)9 b Ft(binds)j(no)q(de)f
Fn(A)f Ft(in)i(list)f Fn(s)f Ft(ev)o(en)i(though)f(it)g(w)o(as)g
(placed)h(in)f(the)-76 1713 y(predecessor)k(list.)j(One)13
b(could)i(think)f(of)f(binding)j Fn(A)c Ft(in)i(b)q(oth)g(lists,)-76
1755 y Fn(s)c Ft(and)h Fn(p)o Ft(,)g(but)f(this)h(w)o(ould)g(con)o
(tradict)h(the)f(in)o(tuition)i(that)d(the)g(rule)-76
1796 y Fn(\(p,A,l,s\))16 b(&)p 120 1803 20 2 v 20 w(g)j(=>)g
(\(p,A,l,s\))d(&)j(g)14 b Ft(denotes)i(the)f(iden)o(tit)o(y)i(on)-76
1838 y(graphs.)h(T)m(o)11 b(see)i(this)g(consider)g(the)g(application)i
(to)d(a)g(graph)h(con-)-76 1879 y(sisting)20 b(of)d(just)g(one)h(no)q
(de)h(with)f(an)g(edge)g(to)f(itself.)32 b(If)17 b Fn(A)g
Ft(w)o(ere)-76 1921 y(b)q(ound)f(in)e Fn(p)g Ft(and)g
Fn(s)p Ft(,)g(the)g(result)h(expression)h(w)o(ould)f(add)f(t)o(w)o(o)g
(self)-76 1962 y(lo)q(ops)h(to)d Fn(A)p Ft(.)-20 2004
y(As)18 b(another)i(example,)h(consider)f(matc)o(hing)g
Fn(\(\(p,B,l,s\))c(&)p 901 2011 V -76 2045 a(g\))c Ft(to)h(the)g
(expression)h Fn(exprDag)p Ft(.)g(W)m(e)f(get)g Fn(l)f
Ft(=)g Fn(op)19 b(+)p Ft(,)12 b Fn(p)g Ft(=)h Fn([D])p
Ft(,)e Fn(s)-76 2092 y Ft(=)g Fn([A,A])p Ft(,)e(and)j
Fn(g)f Ft(=)231 2082 y Fm('&\045$)-42 b( !"#)242 2095
y Ft(1)378 2082 y Fm(/.-,)-50 b(\(\)*+)388 2092 y Ft(+)275
2083 y Fl(o)p Fk(o)p 275 2084 101 2 v 533 2082 a Fm('&\045$)-42
b( !"#)544 2095 y Ft(2)576 2092 y(.)16 b(Th)o(us)c(w)o(e)f(can)g
(de\014ne)-76 2138 y Fn(suc)h Ft(and)h Fn(del)f Ft(b)o(y:)-76
2221 y Fn(fun)19 b(suc)f(v)h(\(\(p)o(,v)o(,l,s)o(\))g(&)p
336 2228 20 2 v 19 w(g\))g(=)g(s)-76 2263 y(fun)g(del)f(v)h(\(\(p)o(,v)
o(,l,s)o(\))g(&)p 336 2270 V 19 w(g\))g(=)g(g)-76 2346
y Ft(Since)13 b(the)f(describ)q(ed)h(pattern)f(matc)o(hing)h(pro)q
(cess)g(not)f(only)g(com-)-76 2387 y(putes)g(bindings,)i(but)e(also)g
(p)q(erforms)g(an)f(implicit)j(reorganization)-76 2429
y(of)e(the)g(matc)o(hed)h(v)n(alue,)g(w)o(e)e(call)i
Fn(&)p 419 2436 V 12 w Ft(an)f Fs(active)f(p)n(attern)p
Ft(.)j(Note)e(that)-76 2470 y(this)18 b(is)f(not)g(p)q(ossible)i(with)e
(la)o(ws/views)h(\(since)g(computation)h(is)-76 2512
y(guided)e(b)o(y)f(external)h(v)n(alues,)h(that)d(is,)i(from)e(the)h
(outside)h(of)e(the)-76 2553 y(pattern\);)21 b(in)f([21])d(a)i(similar)
h(feature)f(is)g(describ)q(ed)h(for)e Fo(n)13 b Ft(+)f
Fo(k)q Ft(-)-76 2595 y(patterns)i(in)g(Hask)o(ell.)1076
687 y(The)i(use)h(of)f(activ)o(e)i(patterns)f(is)g(actually)h(not)f
(restricted)g(to)1020 729 y(graphs,)d(and)g(it)f(is)h(an)f(in)o
(teresting)j(language)f(concept)f(in)f(its)h(o)o(wn)1020
770 y(righ)o(t)j(with)f(man)o(y)g(subtleties)i(\(the)e(reader)g(migh)o
(t)g(ha)o(v)o(e)h(noticed)1020 812 y(the)e(non-linear)j(patterns\),)e
(for)f(further)g(details)i(see)f([8].)22 b(W)m(e)16 b(do)1020
854 y(not)11 b(require)h Fn(&)p 1213 861 V 10 w Ft(as)f(a)f(language)j
(extension,)g(instead)f(w)o(e)e(can)h(alw)o(a)o(ys)1020
895 y(replace)j(a)f(function)i(de\014nition)1020 978
y Fn(fun)k(f)g Fo(:)6 b(:)g(:)26 b Fn(v)19 b Fo(:)6 b(:)g(:)26
b Fn(\(\(p)n(,v,l)o(,s)o(\))19 b(&)p 1534 985 V 20 w(g)o(\))g(=)h(e)
1020 1061 y Ft(b)o(y)e(using)h(a)e(prede\014ned)i(op)q(eration)g
Fn(context)c Ft(for)i(computing)i(a)1020 1103 y(no)q(de's)14
b(con)o(text:)1020 1186 y Fn(fun)19 b(f)g Fo(:)6 b(:)g(:)26
b Fn(v)19 b Fo(:)6 b(:)g(:)26 b Fn(g')18 b(=)1099 1227
y(let)g(val)g(\(\(p)o(,v)o(,l,s)o(\))h(&)g(g\))g(=)g(context)e
(\(v,g'\))1118 1269 y(in)i(e)g(end)1020 1352 y Ft(The)13
b(translation)j(of)e(activ)o(e)g(patterns)g(in)h(the)e(general)i(case)f
(when)1020 1393 y(a)f(function)h(has)g(more)f(than)h(one)f(rule)h(can)f
(b)q(e)h(found)f(in)h([8].)1076 1435 y(In)f(the)g(sequel,)g(ho)o(w)o
(ev)o(er,)g(w)o(e)g(k)o(eep)g(using)h(the)f(activ)o(e)g(pattern)1020
1476 y Fn(&)p 1020 1483 V 12 w Ft(for)g(syn)o(tactic)i(con)o(v)o
(enience.)1020 1589 y Fu(5)52 b(Graph)18 b(F)l(olding)1020
1667 y Ft(Whereas)f(for)e(data)h(t)o(yp)q(es)f(the)h(fold)g(op)q
(eration)h(has)f(a)g(canonical)1020 1709 y(form,)c(reducing)j(graphs)f
(can)g(b)q(e)f(done)h(in)g(quite)g(di\013eren)o(t)g(w)o(a)o(ys.)1020
1818 y Fu(5.1)52 b(Unordered)17 b(F)l(old)1020 1883 y
Ft(A)27 b(\014rst)g(approac)o(h)i(is)f(to)f(de\014ne)h(graph)g(folding)
h(in)f(strong)1020 1925 y(analogy)c(to)e(data)g(t)o(yp)q(es,)i(that)f
(is,)h(giv)o(en)f(a)f(binary)i(function)1020 1966 y Fn(f)19
b(:)39 b('a)19 b(context)e(*)i('b)g(->)g('b)o Ft(,)12
b(unordered)j(fold)f(is)f(de\014ned:)1020 2049 y Fn(fun)19
b(ufold)e(f)i(u)h(Empty)57 b(=)19 b(u)1040 2091 y(|)39
b(ufold)17 b(f)i(u)h(\(c)e(&)i(g\))f(=)g(f)g(\(c,ufold)e(f)i(u)g(g\))
1020 2174 y Ft(Note)9 b(that)h(w)o(e)f(do)g(not)h(use)g(the)f(activ)o
(e)h(pattern)g Fn(&)p 1721 2181 V Ft(.)16 b(W)m(e)9 b(can)h(emplo)o(y)
1020 2215 y Fn(ufold)h Ft(to)h(implemen)o(t)j(some)e(basic)h
(functions,)f(suc)o(h)h(as)f(rev)o(ersing)1020 2257 y(edges,)h(the)g
(function)h Fn(gmap)c Ft(from)j(ab)q(o)o(v)o(e,)g(or)f(testing)i(no)q
(de)f(mem-)1020 2298 y(b)q(ership:)1020 2381 y Fn(val)19
b(grev)f(=)1099 2423 y(ufold)f(\(fn)i(\(\(p,v,l,s)o(\),)o(g\)=)o(>\()o
(s,v)o(,l,)o(p\))d(&)j(g\))g(Empty)1020 2464 y(fun)g(gmap)f(f)h(=)1079
2506 y(ufold)f(\(fn)g(\(\(p,v,l,s\))o(,g)o(\)=>)o(\(p)o(,v,)o(f)f
(l,s\))h(&)h(g\))g(Empty)1020 2547 y(fun)g(gmember)d(v)k(=)1099
2589 y(ufold)d(\(fn)i(\(\(_,w,_,_)o(\),)o(b\)=)o(>v)o(=w)d(orelse)i
(b\))g(false)961 2747 y Ft(4)p eop
%%Page: 5 5
5 4 bop -76 -34 a Ft(Ho)o(w)o(ev)o(er,)16 b(the)g(scop)q(e)g(of)f
Fn(ufold)f Ft(is)i(somewhat)g(limited.)27 b(This)17 b(is)-76
7 y(mainly)c(b)q(ecause)g(w)o(e)e(ha)o(v)o(e)h(no)f(con)o(trol)i(ab)q
(out)f(the)f(order)h(of)f(graph)-76 49 y(decomp)q(osition,)k(but)e
(this)f(actually)j(seems)d(to)g(b)q(e)g(of)g(high)h(imp)q(or-)-76
90 y(tance)g(to)f(man)o(y)h(graph)g(algorithms)h(\(already)g(indicated)
h(b)o(y)d(their)-76 132 y(name:)17 b Fs(depth-\014rst)p
Ft(,)10 b Fs(br)n(e)n(adth-\014rst)p Ft(,)f Fs(b)n(est-\014rst)p
Ft(,)i(and)i(so)g(on\).)-76 240 y Fu(5.2)52 b(Linear)19
b(Graph)e(F)l(old)-76 306 y Ft(When)12 b(folding)g(a)f(data)g(t)o(yp)q
(e)g(v)n(alue)h(one)f(alw)o(a)o(ys)g(mo)o(v)o(es)g(\\forw)o(ard")-76
348 y(from)h(the)g(curren)o(t)g(constructor)h(\(no)q(de\))g(to)f(the)g
(con)o(tained)i(v)n(alues)-76 389 y(\(that)j(is,)g(successors\).)28
b(In)16 b(con)o(trast,)h(the)f(graph)i(constructor)f
Fn(&)-76 431 y Ft(also)c(pro)o(vides)h(access)e(to)g(a)g(no)q(de's)h
(predecessors.)18 b(So)12 b(w)o(e)g(ha)o(v)o(e)g(to)-76
472 y(determine)18 b(the)e(fold)h(direction)h(within)f(the)f(fold)h(op)
q(erator.)27 b(W)m(e)-76 514 y(do)12 b(this)h(b)o(y)f(a)f(parameter)i
(function)g Fn(f)p Ft(,)e(computing)i(from)f(a)g(no)q(de's)-76
555 y(con)o(text)j(the)e(list)j(of)d(no)q(des)i(\()p
Fn(l)o Ft(\))f(whic)o(h)h(are)f(to)f(b)q(e)h(accessed,)h(that)-76
597 y(is,)h(folded,)h(next.)24 b(Tw)o(o)15 b(suc)o(h)g(functions)i
(whic)o(h)f(will)h(b)q(e)f(used)f(in)-76 638 y(the)f(sequel)h(direct)g
(fold)f(to)g(the)f(successors,)i(resp)q(ectiv)o(ely)m(,)h(prede-)-76
680 y(cessors:)-76 763 y Fn(fun)j(fwd)f(\(p)o(,v,l)o(,s)o(\))h(=)g(s)
-76 804 y(fun)g(bwd)f(\(p)o(,v,l)o(,s)o(\))h(=)g(p)-76
887 y Ft(No)o(w)d(fold)i(op)q(erates)f(on)g(a)g(no)q(de)h
Fn(v)e Ft(in)h(t)o(w)o(o)g(steps:)25 b(\014rst,)17 b(fold)h(is)-76
929 y(recursiv)o(ely)13 b(applied)g(to)d(the)h(list)g(of)f(no)q(des,)i
Fn(l)o Ft(,)f(whic)o(h)g(is)g(computed)-76 970 y(b)o(y)i
Fn(f)g Ft(from)f Fn(v)p Ft('s)g(con)o(text,)h(yielding)j(a)d(list)h(of)
f(results)h Fn(l')p Ft(.)i(Since,)d(in)-76 1012 y(general,)e(the)e
(length)h(of)f Fn(l)f Ft(is)h(v)n(arying,)i(the)e(results)h(in)g
Fn(l')e Ft(ha)o(v)o(e)h(to)g(b)q(e)-76 1053 y(accum)o(ulated)16
b(in)e(some)g(w)o(a)o(y)m(.)k(This)c(is)g(ac)o(hiev)o(ed)h(b)o(y)f(a)g
(parameter)-76 1095 y(function)i Fn(b)e Ft(whic)o(h)i(is)f(\(list-\))g
(folded)h(along)g Fn(l')p Ft(,)e(yielding)j(a)e(v)n(alue)-76
1136 y Fn(r)p Ft(.)21 b(A)14 b(further)g(parameter)h(function)h
Fn(d)e Ft(is)h(\014nally)h(applied)h(to)e Fn(lab)-76
1178 y Ft(\(the)e(lab)q(el)i(of)e Fn(v)o Ft(\))g(and)h
Fn(r)o Ft(.)-20 1219 y(Another)j(parameter)g(is)h(the)e(\\linearit)o
(y")k(of)c(no)q(des,)i(that)f(is,)-76 1261 y(whether)g(a)g(no)q(de)h(v)
n(alue)g(can)f(b)q(e)g(used)h(only)g(once)f(in)h(a)f(compu-)-76
1302 y(tation)e(or)f(if)f(it)i(migh)o(t)f(b)q(e)g(used)g(m)o(ultiple)j
(times)d(\(when)g(reac)o(hed,)-76 1344 y(for)f(example,)i(from)e
(di\013eren)o(t)i(predecessors\).)k(W)m(e)14 b(\014rst)g(consider)-76
1385 y(the)j(former)g(option:)25 b(once)18 b(w)o(e)e(ha)o(v)o(e)h(matc)
o(hed)g(a)g(no)q(de)h(con)o(text)-76 1427 y Fn(\(p)o(,v,l)o(,s)o(\))h
(&)h(g)14 b Ft(w)o(e)h(pro)q(ceed)i(with)f(just)f(graph)h
Fn(g)p Ft(,)g(th)o(us)f(forget-)-76 1468 y(ting)j Fn(v)p
Ft(.)28 b(This)18 b(is)g(a)f(bit)g(dangerous)i(since)f
Fn(v)e Ft(migh)o(t)i(b)q(e)f(tried)h(to)-76 1510 y(b)q(e)13
b(matc)o(hed)g(in)g Fn(g)f Ft(later)h(\(coming)h(from)e(a)h(di\013eren)
o(t)h(predecessor\))-76 1551 y(th)o(us)i(causing)h(a)f
Fn(Match)d Ft(exception.)27 b(Being)16 b(a)o(w)o(are)g(of)f(that)h
(fact,)-76 1593 y(ho)o(w)o(ev)o(er,)11 b(w)o(e)f(can)h(reco)o(v)o(er)g
(from)g(exceptions)h(b)o(y)f(giving)i(meaning-)-76 1634
y(ful)i(defaults.)20 b(In)14 b(fact,)f(this)i(is)f(done)h(in)g(the)f
(follo)o(wing)i(de\014nition)-76 1676 y(of)e Fn(gfold)n
Ft(.)21 b(W)m(e)14 b(\014rst)h(de\014ne)g(t)o(w)o(o)f(functions)i(for)e
(p)q(erforming)h(fold)-76 1717 y(from)e(just)g(one)g(no)q(de,)h(resp)q
(ectiv)o(ely)m(,)h(from)d(a)h(list)i(of)d(no)q(des.)-76
1800 y Fn(fun)19 b(gfold1)e(f)i(d)g(b)h(u)f(v)218 1842
y(\(\(c)g(as)g(\(_,v,lab,)o(_\))o(\))e(&)p 611 1849 20
2 v 19 w(g\))i(=)3 1884 y(let)f(val)h(\(r,g1\))e(=)i(gfoldn)e(f)j(d)f
(b)g(u)g(\(f)g(c\))g(g)22 1925 y(in)g(\(d)g(\(lab,r\),g)o(1\))d(end)-76
2008 y(and)j(gfoldn)e(_)i(_)g(_)h(u)f([])97 b(g)19 b(=)h(\(u,g\))-56
2050 y(|)39 b(gfoldn)17 b(f)i(d)g(b)h(u)f(\(v::l\))e(g)i(=)3
2091 y(let)f(val)h(\(x,g1\))e(=)i(gfold1)e(f)j(d)f(b)g(u)g(v)g(g)81
2133 y(val)g(\(y,g2\))e(=)i(gfoldn)e(f)j(d)f(b)g(u)g(l)g(g1)22
2174 y(in)g(\(b)g(\(x,y\),g2\))d(end)3 2216 y(handle)h(Match)h(=>)g
(gfoldn)g(f)h(d)g(b)g(u)h(l)f(g)-76 2299 y Ft(In)c(addition)j(to)d(the)
h(accum)o(ulated)h(v)n(alue,)g(b)q(oth)f(functions)h(ha)o(v)o(e)-76
2340 y(as)g(a)g(result)g(the)g(reduced)h(graph.)29 b(P)o(erforming)18
b(successiv)o(e)g(fold)-76 2382 y(calls)12 b(alw)o(a)o(ys)g(on)e(these)
h(reduced)h(graphs)f(essen)o(tially)j(ensures)d(that)-76
2423 y(no)q(des)16 b(are)f(visited)i(only)g(once.)24
b(In)15 b(a)g(sense,)h(the)f(graphs)h(passed)-76 2465
y(around)c(represen)o(t)f(the)f(progressiv)o(e)i(consumption)h(of)d(no)
q(des)h(from)-76 2506 y(the)k(original)i(graph.)22 b(The)14
b(exception)i(handling)h(in)e Fn(gfoldn)d Ft(cap-)-76
2548 y(tures)h(the)g(follo)o(wing)h(case:)j(when)c(a)f(no)q(de)i
(passed)f(to)g Fn(gfoldn)d Ft(has)-76 2589 y(already)15
b(b)q(een)e(consumed)h(b)o(y)g(a)e(recursiv)o(e)j(call)f(to)f
Fn(gfold1)d Ft(at)j(the)1020 -34 y(time)j(it)h(is)f(to)g(b)q(e)g(pro)q
(cessed,)h(it)g(causes)f(a)g Fn(Match)e Ft(exception)j(\(in)1020
7 y Fn(gfold1)n Ft(\).)27 b(In)17 b(that)f(case)h Fn(gfoldn)d
Ft(simply)19 b(tak)o(es)e(the)f(next)h(no)q(de)1020 49
y(in)f(the)g(list.)26 b(\(Those)16 b(who)f(do)h(not)g(lik)o(e)h
(programming)g(with)f(ex-)1020 90 y(ceptions)f(migh)o(t)e(note)h(that)f
(their)h(use)f(is)h(not)f(essen)o(tial)i(here.)i(Al-)1020
132 y(ternativ)o(ely)m(,)j(w)o(e)d(execute)h(the)f(second)h(RHS)g(of)f
Fn(gfoldn)d Ft(only)19 b(if)1020 173 y Fn(gmember)e(v)i(g)e
Ft(is)g(true,)h(otherwise)g(w)o(e)f(call)h Fn(gfoldn)g(f)h(d)g(b)g(u)h
(l)1020 215 y(g)p Ft(.\))c(No)o(w)10 b Fn(gfold)g Ft(p)q(erforms)h
Fn(gfoldn)e Ft(and)j(drops)g(the)f(graph)h(result:)1020
298 y Fn(fun)19 b(gfold)e(f)i(d)h(b)f(u)g(l)g(g)h(=)f(#1)g(\(gfoldn)e
(f)i(d)g(b)g(u)g(l)h(g\))1020 381 y Ft(In)9 b(essence,)i
Fn(gfold)18 b(fwd)8 b Ft(p)q(erforms)h(depth-\014rst)i(searc)o(h)f(on)f
(graphs.)1020 422 y(As)h(demonstrated)i(in)f([14],)f(man)o(y)h(graph)g
(problems)h(can)f(b)q(e)f(easily)1020 464 y(solv)o(ed)15
b(b)o(y)e(\014rst)h(computing)h(a)e(depth-\014rst)h(spanning)i(tree)d
(of)g(the)1020 505 y(graph.)19 b(So)14 b(w)o(e)f(sho)o(w)h(ho)o(w)f(to)
h(compute)g(it)g(with)g Fn(gfold)n Ft(.)k(W)m(e)c(will)1020
547 y(represen)o(t)d(trees)g(of)f(v)n(ariable)j(degree)e(b)o(y)g(the)f
(follo)o(wing)j(data)e(t)o(yp)q(e:)1020 630 y Fn(datatype)17
b('a)h(tree)g(=)i(Branch)d(of)i('a)g(*)g('a)g(tree)f(list)1020
713 y Ft(No)o(w,)12 b Fn(dfs)g Ft(is)h(simply)i(giv)o(en)g(b)o(y)e
(\(with)g Fn(val)19 b(Cons)f(=)h(op)g(::)p Ft(\):)1020
796 y Fn(fun)g(dfs)f(l)h(g)g(=)h(gfold)d(fwd)i(Branch)e(Cons)h([])h(l)g
(g)1020 879 y Ft(This)d(de\014nition)j(for)c(depth-\014rst)i(searc)o(h)
g(is)f(v)o(ery)g(di\013eren)o(t)h(from)1020 920 y(the)12
b(Hask)o(ell)i(implemen)o(tation)i(presen)o(ted)d(in)g([14].)j(In)c
(particular,)1020 962 y(the)e(w)o(a)o(y)g(of)f(main)o(taining)k(the)d
(dfs-state)g(is)g(distinctiv)o(e:)18 b(instead)11 b(of)1020
1003 y(using)h(state)e(transformers,)h(remem)o(b)q(ering)h(already)f
(visited)h(no)q(des)1020 1045 y(is)j(implicit)i(in)f(the)e(graph)i
(decomp)q(osition)h(ac)o(hiev)o(ed)g(b)o(y)d(pattern)1020
1086 y(matc)o(hing.)1184 1071 y Fh(1)1227 1086 y Ft(Note)h(that)g(w)o
(e)g(ha)o(v)o(e)h(delib)q(erately)i(omitted)f(a)e(case)1020
1128 y(lik)o(e)1020 1211 y Fn(fun)k(gfold1)e(f)i(d)g(b)g(u)h(v)f(Empty)
f(=)h(u)1020 1294 y Ft(from)13 b(the)g(de\014nition)i(of)e
Fn(gfold1)e Ft(to)h(obtain)j(a)e(more)g(general)h(t)o(yp-)1020
1336 y(ing.)k(As)13 b Fn(gfold)e Ft(is)i(actually)i(of)e(t)o(yp)q(e)
1020 1419 y Fn(\('a)19 b(context)d(->)j(node)f(list\))g(->)1020
1460 y(\('a)h(*)g('b)g(->)f('c\))h(->)g(\('c)f(*)h('b)g(->)g('b\))g(->)
f('b)h(->)1020 1502 y(node)f(list)g(->)h('a)g(graph)f(->)g('b)1020
1585 y Ft(adding)h(the)f(ab)q(o)o(v)o(e)h(case)e(w)o(ould)i(result)f
(in)h(a)e(uni\014cation)k(of)c Fn('b)1020 1626 y Ft(with)e
Fn('c)e Ft(en)o(tailing)k(some)e(e\013ort)g(to)f(adjust)h
(de\014nitions)i(lik)o(e)f(that)1020 1668 y(of)c Fn(dfs)p
Ft(.)k(The)c(similarit)o(y)j(of)d Fn(gfold)f Ft(to)h(dfs)g(mak)o(es)h
(it)g(the)g(basis)g(for)1020 1709 y(man)o(y)f(graph)g(algorithms.)19
b(Since)12 b(w)o(e)f(can)h(establish)i(general)f(la)o(ws)1020
1751 y(for)d Fn(gfold)d Ft(\(see)j(Section)h(6\))f(graph)g(algorithms)i
(b)q(ecome)e(amenable)1020 1792 y(to)j(program)h(optimization.)1076
1834 y(Linear)k(fold)f(is)g(di\013eren)o(t)h(from)e(fold)h(on)g(data)g
(t)o(yp)q(es:)24 b(there,)1020 1875 y(m)o(ultiple)12
b(threads)e(to)g(a)f(v)n(alue)i(are)e(p)q(ossible)j(via)f(the)e(use)h
(of)f(sharing)1020 1917 y(v)n(ariables.)19 b(In)11 b(a)h(decomp)q
(osition)j(of)c(a)h(v)n(alue)g(con)o(taining)j(m)o(ultiple)1020
1958 y(threads,)g(sa)o(y)m(,)f(to)g(a)g(sub)o(v)n(alue)i
Fo(v)q Ft(,)d Fo(v)i Ft(is)g(pro)q(cessed)g(as)f(man)o(y)g(times)1020
2000 y(as)h(there)h(are)f(threads)h(leading)h(to)e(it.)24
b(This)16 b(is)f(not)h(the)f(case)g(for)1020 2041 y Fn(gfold)c
Ft(whic)o(h)j(pro)q(cesses)g(just)f(one)g(thread.)1020
2150 y Fu(5.3)52 b(Multiple)19 b(Access)e(Graph)g(F)l(old)1020
2216 y Ft(An)d(ob)o(vious)j(generalization)h(of)c Fn(gfold)e
Ft(is)j(to)g(allo)o(w)g(for)g(m)o(ultiple)1020 2257 y(accesses)d(to)f
(no)q(des)h(whic)o(h)g(can)f(b)q(e)h(accomplished)i(b)o(y)d
(re-inserting)1020 2299 y(the)g(curren)o(tly)i(matc)o(hed)e(no)q(de)h
Fn(v)f Ft(with)g(only)h(incoming)i(edges)d(\(ex-)1020
2340 y(cept)17 b(the)f(one)h(via)h(whic)o(h)f Fn(v)f
Ft(is)h(reac)o(hed\);)i(m)o(ultiple)g(accesses)e(to)1020
2382 y(the)e(no)q(de)i(are)e(then)h(p)q(ossible)h(through)g(successor)f
(lists)h(of)e(other)1020 2423 y(no)q(des)g(that)f(ha)o(v)o(e)g(not)g(b)
q(een)h(pro)q(cessed)g(y)o(et.)20 b(No)q(de)14 b(sharing)h(and)1020
2465 y(lo)q(ops)e(\(edges)f(from)f(a)h(no)q(de)g(to)f(itself)s(\))i
(require)g(careful)f(treatmen)o(t)1020 2506 y(within)f(the)f(fold)h(op)
q(erator:)16 b(when)10 b(a)g(no)q(de)g Fn(v)f Ft(is)i(pro)q(cessed,)g
(that)f(is,)p 1020 2536 399 2 v 1062 2563 a Fh(1)1080
2576 y Fa(Actually)m(,)i(these)f(no)q(des)g(are)g(forgotten)f(and)h
(not)g(remem)o(b)q(ered.)961 2747 y Ft(5)p eop
%%Page: 6 6
6 5 bop -76 -34 a Ft(a)13 b(function)h Fn(d)d Ft(is)j(applied)h(to)d
Fn(v)p Ft('s)g(lab)q(el)i Fn(lab)d Ft(and)i(a)g(v)n(alue)h
Fn(r)d Ft(result-)-76 7 y(ing)j(from)e(reducing)i(the)f(curren)o(tly)h
(remaining)g(graph,)g(the)e(result)-76 49 y Fn(d)19 b(\(lab,r\))7
b Ft(is)j(not)f(just)h(returned)g(as)f(a)h(v)n(alue,)h(but)f(is)f(also)
i(inserted)-76 90 y(as)i Fn(v)o Ft('s)g(lab)q(el)h(in)o(to)f(the)g
(graph)g(to)g(b)q(e)g(reduced.)k(This)d(ensures)f(that)-76
132 y(the)j(v)n(alue)i(is)e(a)o(v)n(ailable)j(at)d(later)h(stages)f(of)
g(the)g(reduction,)j(and)-76 173 y(it)c(furthermore)g(a)o(v)o(oids)h
(its)f(recomputation.)24 b(This)15 b(accoun)o(ts)g(for)-76
215 y(no)q(des)h(reac)o(hed)h(via)f(more)f(than)h(one)g(predecessor.)25
b(When)17 b(fold-)-76 256 y(ing)e(a)f(no)q(de)h Fn(v)f
Ft(that)g(con)o(tains)i(an)e(edge)h(to)f(itself,)h Fn(v)e
Ft(is)i(among)g(its)-76 298 y(o)o(wn)g(successors,)i(and)e(ev)o(en)o
(tually)j(fold)e(is)f(applied)j(to)d(it.)23 b(Th)o(us,)-76
339 y Fn(v)14 b Ft(m)o(ust)g(b)q(e)g(presen)o(t)h(in)g(the)f(argumen)o
(t)g(graph)h(passed)g(to)f(the)h(re-)-76 381 y(cursiv)o(e)g(fold)f
(call,)g(that)f(is,)h Fn(v)e Ft(m)o(ust)h(b)q(e)h(re-inserted)g(in)o
(to)g Fn(g)f Fs(b)n(efor)n(e)-76 422 y Ft(the)e(recursiv)o(e)h(call)g
(with)g(its)f(original)j(lab)q(el)e Fn(lab)e Ft(and)h(without)h(an)o(y)
-76 464 y(predecessors)j(and)e(successors)h(\(this)g(guaran)o(tees)g
(termination\).)-20 505 y(Since)i(the)f(result)h(t)o(yp)q(e)f(of)g(the)
g(fold)g(is,)h(in)f(general,)i(di\013eren)o(t)-76 547
y(from)h(the)g(t)o(yp)q(e)g(of)g(no)q(de)h(lab)q(els)h(w)o(e)d
(actually)j(ha)o(v)o(e)f(to)e(pro)q(cess)-76 588 y(a)c(heterogeneous)h
(graph)g(where)e(no)q(des)i(lab)q(els)g(are)f(either)g(tagged)-76
630 y Fn(SRC)c Ft(\(not)h(pro)q(cessed)i(y)o(et\))e(or)g
Fn(DEST)e Ft(\(no)q(de)j(carries)g(a)f(result)h(v)n(alue\).)-76
671 y(W)m(e)i(therefore)h(use)f(the)g(follo)o(wing)i(union)g(t)o(yp)q
(e:)-76 754 y Fn(datatype)i(\('a,'b\))g(hybrid)g(=)i(SRC)g(of)f('a)h(|)
g(DEST)g(of)f('b)-76 837 y Ft(No)o(w)10 b(w)o(e)g(can)g(de\014ne)h(the)
g(function)g Fn(mfold)n Ft(.)16 b(In)10 b Fn(mfold1)e
Ft(w)o(e)i(ha)o(v)o(e)g(to)-76 879 y(remo)o(v)o(e)g(in)h(eac)o(h)f
(step)g(exactly)h(one)f(edge)g({)g(the)f(edge)i(b)o(y)f(whic)o(h)g(the)
-76 920 y(curren)o(t)h(no)q(de)h Fn(v)e Ft(w)o(as)g(reac)o(hed.)17
b(W)m(e)11 b(therefore)f(ha)o(v)o(e)i(to)e(pass)h(as)g(an)-76
962 y(additional)k(parameter)c(the)h(no)q(de)g Fn(z)e
Ft(from)h(whic)o(h)h Fn(v)f Ft(w)o(as)g(accessed.)-76
1003 y(Since)16 b(there)f(is)g(no)g(suc)o(h)h(no)q(de)f(for)f(an)o(y)i
(of)e(the)h(argumen)o(t)g(no)q(des)-76 1045 y(initiall)q(y)h(passed)e
(to)f Fn(mfold)e Ft(w)o(e)h(use)i(the)f Fn(option)d Ft(data)k(t)o(yp)q
(e:)-76 1128 y Fn(datatype)j('a)i(option)e(=)i(SOME)f(of)h('a)g(|)g
(NONE)-76 1211 y Ft(and)14 b(apply)h(the)e Fn(SOME)f
Ft(constructor)i(to)f(paren)o(t)h(no)q(des)g(and)g(pass)g(a)-76
1253 y(n)o(ullary)k Fn(NONE)13 b Ft(to)i(the)g(initial)j(call)f(of)e
Fn(mfoldn)n Ft(.)23 b(\(This)16 b(also)g(hides)-76 1294
y(the)f(parameter)h(from)e(the)h(in)o(terface)h(of)e
Fn(mfold)n Ft(.\))22 b(F)m(or)15 b(simplicit)o(y)-76
1336 y(w)o(e)k(omit)h(the)f(parameter)h Fn(f)f Ft(\(recall)i(the)e
(de\014nition)j(of)d Fn(gfold)n Ft(\))-76 1377 y(and)e(consider)g(only)
g(a)f(forw)o(ard)g(fold,)h(that)f(is,)h(w)o(e)e(alw)o(a)o(ys)i(mo)o(v)o
(e)-76 1419 y(to)e(successors.)24 b(Th)o(us,)16 b(when)f(reac)o(hing)i
(a)e(no)q(de)h Fn(v)f Ft(with)g(a)g Fn(DEST)p Ft(-)-76
1460 y(lab)q(el,)e(w)o(e)d(can)h(simply)h(re-insert)g
Fn(v)e Ft(with)h(its)g(curren)o(t)g(predecessors)-76
1502 y(except)j Fn(z)o Ft(.)-76 1585 y Fn(fun)19 b(mfold1)e(d)i(b)g(u)h
(\(z,v\))d(\(\(p,v,lab,)o(s\))f(&)p 630 1592 20 2 v 19
w(g\))j(=)3 1626 y(case)f(lab)g(of)h(DEST)f(w)h(=>)297
1668 y(\(w,\(drop)d(z)k(p,v,DEST)c(w,[]\))i(&)h(g\))199
1709 y(|)g(SRC)f(w)39 b(=>)3 1751 y(let)18 b(val)h(\(r,g1\))e(=)i
(mfoldn)e(d)j(b)f(u)g(\(SOME)f(v,s\))473 1792 y(\(\([],v,SRC)e(w,[]\))i
(&)h(g\))81 1834 y(val)g(new)77 b(=)19 b(d)g(\(w,r\))22
1875 y(in)g(\(new,\(drop)d(z)j(p,v,DEST)e(new,[]\))f(&)k(del)e(v)h
(g1\))3 1917 y(end)-76 2000 y(and)g(mfoldn)e(_)i(_)g(u)h(\(_,[]\))56
b(g)19 b(=)h(\(u,g\))-56 2041 y(|)39 b(mfoldn)17 b(d)i(b)g(u)h
(\(z,v::l\))c(g)j(=)3 2083 y(let)f(val)h(\(x,g1\))e(=)i(mfold1)e(d)j(b)
f(u)g(\(z,v\))f(g)81 2124 y(val)h(\(y,g2\))e(=)i(mfoldn)e(d)j(b)f(u)g
(\(z,l\))f(g1)22 2166 y(in)h(\(b)g(\(x,y\),g2\))d(end)-76
2249 y Ft(\()p Fn(drop)i(\(SOME)g(x\))h(p)11 b Ft(remo)o(v)o(es)i(one)g
(o)q(ccurrence)g(of)f(the)h(elemen)o(t)g Fn(x)-76 2290
y Ft(from)h(list)h Fn(p)p Ft(,)f(and)h Fn(drop)j(NONE)g(p)13
b Ft(=)h Fn(p)p Ft(.\))20 b(No)o(w)14 b Fn(mfold)e Ft(\014rst)i(wraps)
-76 2332 y(up)f(the)f(no)q(des)h(of)f(the)h(graph)g(with)g
Fn(SRC)p Ft(,)d(then)j(reduces)g(the)f(graph)-76 2373
y(b)o(y)h(means)f(of)g Fn(mfoldn)n Ft(,)f(and)i(\014nally)h(drops)f
(the)f(graph)h(part)f(of)g(the)-76 2415 y(result:)-76
2498 y Fn(fun)19 b(mfold)e(d)j(b)f(u)g(l)g(g)g(=)3 2539
y(#1)f(\(mfoldn)f(d)j(b)f(u)g(\(NONE,l\))e(\(gmap)g(SRC)i(g\)\))-76
2622 y Ft(As)10 b(an)f(example,)j(an)e(ev)n(aluator)h(for)e(expression)
j(D)o(A)o(Gs)e(is)g(giv)o(en)h(b)o(y)1020 -34 y(the)16
b(function)h Fn(evalDag)p Ft(.)k(\(The)15 b(expression)j
Fn(filter)f(p)i(l)c Ft(selects)1020 7 y(all)k(elemen)o(ts)g(of)e(the)h
(list)g Fn(l)g Ft(for)f(whic)o(h)h(the)g(predicate)h
Fn(p)e Ft(yields)1020 49 y(true.\))1020 132 y Fn(fun)i(pred)f(v)h
(\(\(p,v,_,_)o(\))e(&)p 1452 139 V 19 w(_\))i(=)g(p)1020
173 y(fun)g(roots)e(g)i(=)h(filter)d(\(fn)h(v=>pred)f(v)j(g=[]\))d
(\(nodes)h(g\))1020 215 y(fun)h(evalNode)d(\(CON)i(i,_\))g(=)h(i)1040
256 y(|)39 b(evalNode)16 b(\(OP)i(f,[x,y]\))f(=)i(f)g(\(x,y\))1020
298 y(fun)g(evalDag)d(g)k(=)1099 339 y(mfold)d(evalNode)g(Cons)h([])h
(\(roots)e(g\))i(g)1020 422 y Ft(It)g(seems)g(there)g(are)h(only)g(few)
e(applicatio)q(ns)k(of)d Fn(mfold)n Ft(:)29 b(there)1020
464 y(m)o(ust)12 b(b)q(e)f(a)h(need)f(to)h(fold)g(along)h(all)f(edges)g
(\(folding)h(along)g(a)f(span-)1020 505 y(ning)20 b(tree)e(can)h(b)q(e)
f(done)h(with)g Fn(gfold)n Ft(\),)g(and)g(the)f(order)h(of)f(de-)1020
547 y(comp)q(osition)g(m)o(ust)d(b)q(e)g(imp)q(ortan)o(t)i(\(otherwise)
f Fn(ufold)c Ft(could)17 b(b)q(e)1020 588 y(used\).)24
b(Ho)o(w)o(ev)o(er,)15 b(some)g(adv)n(anced)i(examples)g(can)e(b)q(e)g
(found)h(in)1020 630 y(the)d(translation)j(of)c(visual)j(programs)f
([9].)1020 739 y Fu(5.4)52 b(Graph)18 b(Bac)o(ktrac)o(king)1020
804 y Ft(By)13 b(passing)h(the)e(v)o(ery)h(same)g(graph)g(to)f(all)i
(recursiv)o(e)f(fold)h(calls)f(of)1020 846 y(one)g(successor)h(list)h
(w)o(e)d(obtain)j(a)e(bac)o(ktrac)o(king)i(op)q(erator:)1020
929 y Fn(fun)k(backtrac)o(k1)d(d)j(b)h(u)f(v)g(\(\(_,v,lab,)o(s\))d(&)p
1726 936 V 19 w(g\))j(=)1099 970 y(d)g(\(lab,back)o(tr)o(ack)d(d)j(b)g
(u)h(s)f(\(\([],v,la)o(b,[)o(]\))d(&)j(g\)\))1020 1053
y(and)g(backtrac)o(k)e(d)i(b)g(u)g(nil)g(g)g(=)g(u)1040
1095 y(|)39 b(backtrac)o(k)17 b(d)i(b)g(u)g(\(v::l\))f(g)h(=)1099
1136 y(b)g(\(backtrac)o(k1)d(d)j(b)h(u)f(v)g(g,backtrac)o(k)36
b(d)19 b(b)g(u)h(l)f(g\))1020 1219 y Ft(With)f Fn(backtrack)c
Ft(w)o(e)i(can)i(compute,)g(for)f(example,)i(all)f(simple)1020
1261 y(paths)c(in)g(a)f(graph)g(\(let)h Fn(val)k(append)g(=)h(op)g(@)p
Ft(\):)1020 1344 y Fn(fun)g(conspath)o(s)e(\(v,l\))g(=)j(map)e(\(fn)g
(p=>v::p\))f(l)1020 1385 y(fun)i(pathsfro)o(m)e(s)i(g)g(=)1099
1427 y(backtrac)o(k)e(conspaths)f(append)h([nil])h([s])g(g)1020
1468 y(fun)h(allpaths)d(g)j(=)g(fold)g(append)1099 1510
y(\(map)f(\(fn)g(v=>pathsfr)o(om)e(v)j(g\))g(\(nodes)e(g\)\))i([])1020
1593 y Ft(\(Actually)m(,)f(the)d(list)i(of)f(paths)g(returned)h(b)o(y)f
Fn(allpaths)d Ft(con)o(tains)1020 1634 y Fi(j)p Fo(V)c
Fi(j)p Ft(-times)k(the)g(empt)o(y)g(path.\))1020 1747
y Fu(6)52 b(Program)15 b(F)l(usion)1020 1826 y Ft(A)g(p)q(opular)i
(optimization)i(tec)o(hnique)e(for)e(functional)j(languages)1020
1867 y(is)11 b(to)g(eliminate)h(in)o(termediate)h(results)f(of)e(m)o
(ulti-pass)i(algorithms.)1020 1909 y(Concerning)18 b(graph)f
(algorithms,)i(Launc)o(h)o(bury)g([15])c(giv)o(es)j(some)1020
1950 y(examples)d(of)d(ho)o(w)h(to)g(fuse)g(op)q(erations)i(based)f(on)
g(dfs.)1076 1992 y(The)j(follo)o(wing)i(theorem)e(sho)o(ws)g(that)g
(program)g(fusion)h(also)1020 2033 y(applies)c(to)d(algorithms)j(sp)q
(eci\014ed)f(b)o(y)f(graph)h(folds.)k(\(The)12 b(pro)q(of)g(is)1020
2075 y(giv)o(en)i(in)g(the)f(App)q(endix.\))1020 2154
y Fe(Theorem)i(2)g(\(Promotion)f(Theorem\))19 b Fs(If)12
b Fn(M)g Fs(and)f Fn(N)h Fs(ar)n(e)g(func-)1020 2196
y(tions)g(such)g(that)1099 2229 y Fn(M)19 b(\(d)g(\(x,y\)\))11
b Ft(=)j Fn(e)19 b(\(x,N)f(y\))1099 2271 y(N)h(\(b)g(\(x,y\)\))11
b Ft(=)j Fn(f)19 b(\(M)g(x,N)f(y\))1255 2312 y(N)i(u)13
b Ft(=)h Fn(u')1020 2355 y Fs(then:)1099 2395 y Fn(N)19
b(\(gfold)e(h)i(d)g(b)h(u)f(l)g(g\))13 b Ft(=)h Fn(gfold)j(h)j(e)f(f)g
(u')g(l)g(g)1020 2476 y Ft(As)c(an)h(application)j(example)d(consider)h
(the)f(de\014nition)i(of)d(top)q(o-)1020 2517 y(logical)h(sorting)e(as)
f(giv)o(en)h(in)g([14,)f(15]:)961 2747 y(6)p eop
%%Page: 7 7
7 6 bop -76 -34 a Fn(fun)19 b(postorder)d(\(Branch)h(\(v,f\)\))g(=)i
(postorderf)d(f)j(@)g([v])-76 7 y(and)g(postorder)o(f)d([])98
b(=)19 b([])-56 49 y(|)39 b(postorder)o(f)16 b(\(t::f\))i(=)h
(postorder)d(t)j(@)g(postorderf)d(f)-76 90 y(fun)j(topsort)e(g)i(=)3
132 y(rev)f(\(postorder)o(f)e(\(dfs)j(\(nodes)e(g\))i(g\)\))-76
215 y Ft(After)13 b(unfolding)k(the)c(de\014nition)k(of)c
Fn(dfs)g Ft(w)o(e)g(can)h(apply)h(the)f(pro-)-76 256
y(motion)k(theorem)g(to)f(obtain)i(a)e(v)o(ersion)h(of)f
Fn(topsort)d Ft(that)k(do)q(es)-76 298 y(not)f(build)h(an)e(in)o
(termediate)j(tree)d(structure.)27 b(First,)17 b(w)o(e)f(matc)o(h)-76
339 y(v)n(ariables)f(of)d(the)g(theorem:)17 b Fn(h)12
b Ft(=)g Fn(fwd)p Ft(,)f Fn(d)h Ft(=)g Fn(Branch)n Ft(,)g
Fn(b)f Ft(=)h Fn(Cons)o Ft(,)g Fn(u)-76 381 y Ft(=)h
Fn([])p Ft(,)f(and)h Fn(N)g Ft(=)f Fn(rev)19 b(o)g(postorder)o(f)p
Ft(.)-20 422 y(Next)9 b(w)o(e)f(ha)o(v)o(e)i(to)f(in)o(v)o(en)o(t)h(v)n
(alues)g(for)f(the)g(remaining)i(v)n(ariables:)-76 464
y Fn(e)17 b Ft(=)g Fn(Cons)o Ft(,)h Fn(f)e Ft(=)h Fn(fn)i(\(x,y\)=>y@x)
14 b Ft(\(app)q(end)k(\014rst)g(argumen)o(t)g(to)-76
505 y(second\),)12 b Fn(u')e Ft(=)h Fn([])p Ft(,)f(and)i
Fn(M)e Ft(=)h Fn(rev)19 b(o)g(postorder)o Ft(.)14 b(No)o(w)c(w)o(e)h(c)
o(hec)o(k)-76 547 y(the)h(premises)i(of)e(the)g(theorem:)17
b(it)12 b(is)h(clear)g(that)f Fn(N)19 b(u)12 b Ft(=)g
Fn([])f Ft(=)h Fn(u')p Ft(.)-76 588 y(Moreo)o(v)o(er:)18
653 y Fn(M)19 b(\(d)g(\(x,y\)\))18 694 y Ft(=)25 b Fn(rev)18
b(\(postorder)e(\(Branch)h(\(x,y\)\)\))18 736 y Ft(=)25
b Fn(rev)18 b(\(postorderf)e(y)j(@)g([x]\)\))18 777 y
Ft(=)25 b Fn([x])18 b(@)i(\(rev)e(\(postorde)o(rf)e(y\)\))18
819 y Ft(=)25 b Fn(x::\(rev)17 b(o)i(postorderf)o(\))e(y)18
860 y Ft(=)25 b Fn(e)19 b(\(x,N)f(y\))18 942 y(N)h(\(b)g(\(x,y\)\))18
983 y Ft(=)25 b Fn(rev)18 b(\(postorderf)e(\(x::y\)\))18
1025 y Ft(=)25 b Fn(rev)18 b(\(postorder)e(x)j(@)h(postorder)o(f)c
(y\)\))18 1066 y Ft(=)25 b Fn(rev)18 b(\(postorderf)e(y\))j(@)g(rev)f
(\(postorder)e(x\))18 1108 y Ft(=)25 b Fn(\(rev)18 b(o)h(postorderf)o
(\))e(y)i(@)g(\(rev)f(o)h(postorder\))d(x)18 1149 y Ft(=)25
b Fn(f)19 b(\(M)g(x,N)g(y\))-76 1223 y Ft(Th)o(us)13
b(w)o(e)f(obtain)i(the)e(follo)o(wing)j(optimized)f(v)o(ersion)g(of)e
Fn(topsort)p Ft(:)-76 1306 y Fn(fun)19 b(topsort)e(g)i(=)g(gfold)f(fwd)
g(Cons)g(\(fn)h(\(x,y\)=>y@)o(x\))356 1348 y([])g(\(nodes)e(g\))i(g)-76
1431 y Ft(Theorem)f(2)f(facilitates)i(the)f(elimination)j(of)c(in)o
(termediate)i(tree)-76 1472 y(structures)f(whic)o(h)g(certainly)i(has)d
(man)o(y)h(application)q(s.)32 b(Y)m(et,)18 b(it)-76
1514 y(is)d(c)o(hallengin)q(g)i(to)d(in)o(v)o(estigate)j(unfold/fold)g
(transformations)f(to)-76 1555 y(sa)o(v)o(e)10 b(in)o(termediate)h
(graph)f(structures,)g(to)q(o;)g(according)h(to)e(W)m(adler)-76
1597 y([24])20 b(w)o(e)f(could)i(call)h(this)f Fs(de)n(gr)n(aphatio)o
(n)p Ft(.)34 b(As)20 b(an)g(example)i(w)o(e)-76 1638
y(optimize)15 b(the)e(implemen)o(tation)j(of)d(Sharir's)h
(strongly-connected)-76 1680 y(comp)q(onen)o(ts)h(algorithm)g(as)e(giv)
o(en)h(in)g([7,)e(14)q(]:)-76 1763 y Fn(fun)19 b(scc)f(g)h(=)h(dfs)e
(\(rev)g(\(postorder)o(f)356 1804 y(\(dfs)g(\(nodes)f(g\))i(g\)\)\))f
(\(grev)g(g\))-76 1887 y Ft(The)h(algorithm)i(w)o(orks)e(b)o(y)g(p)q
(erforming)i(dfs)e(on)g(a)g(graph)h(with)-76 1929 y(its)14
b(edges)g(rev)o(ersed)g(\()p Fn(grev)k(g)p Ft(\))13 b(while)i(the)e
(argumen)o(t)i(no)q(de)f(list)g(of)-76 1970 y(the)f(tra)o(v)o(ersal)h
(m)o(ust)f(b)q(e)g(a)f(rev)o(erse)i(p)q(ostorder)f(list)h(of)f(the)g
(graph's)-76 2012 y(no)q(des)i(\()p Fn(rev)j(\(postorde)o(rf)e(...)38
b(g\))p Ft(\).)18 b(W)m(e)13 b(can)h(sa)o(v)o(e)g(the)g(in)o(ter-)-76
2053 y(mediate)e(graph)g(resulting)h(from)d(the)h(edge)g(rev)o(ersal)h
(b)o(y)f(fusing)h(the)-76 2095 y(de\014nition)k(of)c
Fn(dfs)f Ft(with)i(that)g(of)g Fn(grev)p Ft(.)i(T)m(o)d(do)h(this)h(w)o
(e)e(use)h(a)g Fs(du-)-76 2136 y(ality)j(the)n(or)n(em)j
Ft(that)e(relates)h Fn(gfold)g(fwd)e Ft(to)h Fn(gfold)g(bwd)p
Ft(.)28 b(\(The)-76 2178 y(pro)q(of)14 b(can)f(b)q(e)g(found)h(in)g
(the)f(App)q(endix.\))-76 2251 y Fe(Theorem)i(3)g(\(Dualit)o(y)f
(Theorem\))-56 2292 y Fn(gfold)j(fwd)i(d)g(b)g(u)h(l)f(\(grev)f(g\))31
b Ft(=)-56 2334 y Fn(gfold)17 b(bwd)i(d)g(b)g(u)h(l)f(g)-76
2407 y Ft(The)d(applicatio)q(n)j(to)d(the)h(function)g
Fn(scc)e Ft(giv)o(es)i(\(using)h(the)e(opti-)-76 2448
y(mized)e(v)o(ersion)h(of)d Fn(topsort)p Ft(\):)-76 2531
y Fn(fun)19 b(scc)f(g)h(=)h(gfold)d(bwd)i(Branch)e(Cons)h([])22
2573 y(\(gfold)g(fwd)g(Cons)g(\(fn)h(\(x,y\)=>y)o(@x\))d([])42
2614 y(\(nodes)h(g\))i(g\))g(g)1020 -34 y Fu(7)52 b(Implem)o(en)n
(tation)1020 44 y Ft(W)m(e)19 b(ha)o(v)o(e)h(implemen)o(ted)h(the)e
(prop)q(osed)h(graph)g(concept)g(as)f(an)1020 86 y(extension)g(of)e
(ML.)g(A)o(t)g(the)h(core)f(is)i(a)e(data)h(structure)g(for)f(p)q(er-)
1020 127 y(sisten)o(t)j(graphs,)i(that)d(is,)i(graphs)f(that)g(are)f
Fs(non)p Ft(-destructiv)o(ely)1020 169 y(up)q(dated)f(through)f
(applicatio)q(ns)i(of)d(the)h Fn(&)e Ft(constructor)j(and)f(b)o(y)1020
210 y(decomp)q(osition.)24 b(T)m(o)15 b(our)f(kno)o(wledge,)j(data)d
(structures)i(for)e(p)q(er-)1020 252 y(sisten)o(t)19
b(graphs)h(ha)o(v)o(e)e(not)h(b)q(een)g(in)o(v)o(estigated)i
(previously)g([20].)1020 293 y(\(The)15 b(metho)q(d)g(of)g([6])f
(cannot)i(b)q(e)f(used)h(since)g(it)f(applies)i(only)f(to)1020
335 y(link)o(ed)c(structures)e(with)g(no)q(des)g(of)f(constan)o(t)i(b)q
(ounded)g(in-degree.\))1076 376 y(Since,)i(ev)o(en)f(for)g(imp)q
(erativ)o(e)h(graphs,)g(no)f(single)h(graph)g(repre-)1020
418 y(sen)o(tation)h(exists)f(that)g(is)f(optimal)j(for)d(all)h(kinds)h
(of)e(application)q(s,)1020 459 y(w)o(e)d(initially)j(fo)q(cus)e(on)f
(a)g(represen)o(tation)i(suited)g(for)d(sparse)i(graphs)1020
501 y(and)j(base)f(our)h(implemen)o(tation)i(on)e(no)q(de-indexed)h
(arra)o(ys)f(of)f(ad-)1020 542 y(jacency)g(lists.)18
b(By)12 b(using)h(functional)h(arra)o(ys)f(w)o(e)e(ensure)i(that)f(an)o
(y)1020 584 y(up)q(date)19 b(to)f(the)h(graph)g(do)q(es)f(not)h(in)o(v)
n(alidate)i(older)e(graph)g(v)o(er-)1020 625 y(sions.)f(W)m(e)13
b(use)f(the)h(v)o(ersion)h(tree)e(implemen)o(tation)k(of)c(functional)
1020 667 y(arra)o(ys)18 b([1])e(in)i(whic)o(h)g(up)q(dates)h(tak)o(e)e
(constan)o(t)h(time)g(and)g(index)1020 708 y(access)e(time)g(dep)q
(ends)g(on)g(the)f(depth)h(of)f(the)h(v)o(ersion)g(tree.)24
b(Ex-)1020 750 y(tending)17 b(v)o(ersion)g(trees)e(b)o(y)h(an)g(\(imp)q
(erativ)o(ely)i(up)q(dated\))e(\\cac)o(he)1020 791 y(arra)o(y")c(that)g
(actually)i(duplicates)g(the)d(arra)o(y)h(represen)o(ted)h(b)o(y)f(the)
1020 833 y(leftmost)f(no)q(de)g(in)g(the)g(v)o(ersion)h(tree,)e(index)i
(access)f(b)q(ecomes)g Fo(O)q Ft(\(1\))1020 874 y(for)i
(single-threaded)j(arra)o(ys.)1076 916 y(Let)10 b(us)g(assume)g(for)f
(a)h(momen)o(t)g(that)g(w)o(e)f(represen)o(t)i(a)e(graph)i(b)o(y)1020
957 y(three)i(arra)o(ys)h Fo(L)p Ft(,)e Fo(S)r Ft(,)h(and)h
Fo(P)k Ft(storing)c(no)q(de)g(lab)q(els,)g(successor)g(and)1020
999 y(predecessor)d(lists.)17 b(Then)10 b(adding)i(a)e(no)q(de)g(con)o
(text)g Fn(\(p,v)o(,l)o(,s)o(\))f Ft(\(of)1020 1040 y(size)k
Fo(c)p Ft(\))f(can)h(b)q(e)g(simply)i(done)e(b)o(y)g(\(i\))g(setting)h
(the)f(no)q(de)g(lab)q(el,)h(\(ii\))1020 1082 y(adding)h(successors,)f
(and)f(\(iii\))i(adding)g(predecessors)f(as)f(follo)o(ws:)1051
1162 y(\(i\))19 b Fo(L)p Ft([)p Fn(v)p Ft(])10 b(:=)g
Fn(l)1040 1207 y Ft(\(ii\))20 b Fo(S)r Ft([)p Fn(v)p
Ft(])10 b(:=)h Fn(s)h Ft(and)i Fi(8)f Fn(u)d Fi(2)g Fn(p)h
Ft(:)f Fo(S)r Ft([)p Fn(u)p Ft(])g(:=)g Fn(v::)o Fo(S)r
Ft([)p Fn(u)p Ft(])1030 1253 y(\(iii\))20 b Fo(P)5 b
Ft([)p Fn(v)o Ft(])11 b(:=)f Fn(p)i Ft(and)i Fi(8)f Fn(w)d
Fi(2)h Fn(s)f Ft(:)g Fo(P)5 b Ft([)p Fn(w)o Ft(])11 b(:=)f
Fn(v)o(::)p Fo(P)5 b Ft([)p Fn(w)o Ft(].)1020 1333 y(Th)o(us,)13
b(adding)h(a)e(no)q(de)i(con)o(text)f(tak)o(es)f Fo(O)q
Ft(\()p Fo(c)p Ft(\))g(steps)h(plus)h(the)f(time)1020
1374 y(to)e(lo)q(cate)h(all)g(the)f(lists)i Fo(S)r Ft([)p
Fn(u)p Ft(])d(and)i Fo(P)5 b Ft([)p Fn(w)o Ft(].)15 b(In)c(the)h(w)o
(orst)e(case,)i(this)g(is)1020 1416 y Fo(O)q Ft(\()p
Fo(cu)p Ft(\))i(where)h Fo(u)f Ft(denotes)h(the)g(n)o(um)o(b)q(er)g(of)
f(up)q(dates)i(to)e Fn(g)o Ft(.)21 b(\(Note)1020 1457
y(that)g Fo(u)f Ft(is)h(generally)h(not)f(ev)o(en)g(b)q(ounded)h(b)o(y)
f(the)f(n)o(um)o(b)q(er)h(of)1020 1499 y(edges.\))30
b(Ho)o(w)o(ev)o(er,)17 b(in)h(single-threaded)i(graphs,)f(an)e
(adjacency)1020 1540 y(list)d(is)g(found)g(in)f Fo(O)q
Ft(\(1\),)g(so)g Fn(&)g Ft(is)g Fo(O)q Ft(\()p Fo(c)p
Ft(\).)1076 1582 y(Graph)40 b(decomp)q(osition)j(as)d(requested)g(b)o
(y)g(a)g(matc)o(h)1020 1623 y Fn(\(p)o(,v,l)o(,s)o(\))19
b(&)p 1216 1630 20 2 v 19 w(g)12 b Ft(is,)h(in)g(general,)g(more)g
(complex:)18 b(not)12 b(only)i(m)o(ust)1020 1665 y(w)o(e)f(return)h
Fn(v)o Ft('s)f(lab)q(el,)i(its)f(successors)g(and)g(predecessors,)g(w)o
(e)f(also)1020 1706 y(ha)o(v)o(e)g(to)g(build)i(the)e(reduced)g(graph)h
(resulting)h(from)d(the)h(deletion)1020 1748 y(of)c(con)o(text)i
Fn(\(p)o(,v)o(,l)o(,s\))o Ft(.)16 b(T)m(o)9 b(do)h(this)h(w)o(e)e
(delete)i Fn(v)o Ft(,)f(and)h(w)o(e)e(remo)o(v)o(e)1020
1789 y Fn(v)17 b Ft(from)g(all)i(successor)f(\(predecessor\))g(lists)h
(of)e Fn(v)p Ft('s)g(predecessors)1020 1831 y(\(successors\),)d(that)f
(is,)1051 1911 y(\(i\))19 b Fo(L)p Ft([)p Fn(v)p Ft(])10
b(:=)p Fi(?)1040 1956 y Ft(\(ii\))20 b Fi(8)13 b Fn(u)e
Fi(2)f Fn(p)g Ft(:)g Fo(S)r Ft([)p Fn(u)p Ft(])h(:=)f
Fn(drop)18 b(v)h Fo(S)r Ft([)p Fn(u)p Ft(])1030 2002
y(\(iii\))h Fi(8)13 b Fn(w)e Fi(2)f Fn(s)g Ft(:)g Fo(P)5
b Ft([)p Fn(w)p Ft(])10 b(:=)g Fn(drop)18 b(v)h Fo(P)5
b Ft([)p Fn(w)p Ft(].)1020 2082 y(The)17 b(costly)h(op)q(erations)h
(are)e(those)g(in)h(steps)f(\(ii\))h(and)f(\(iii\):)27
b(w)o(e)1020 2123 y(ha)o(v)o(e)11 b(to)f(\014nd)i Fo(O)q
Ft(\()p Fo(c)p Ft(\))e(adjacency)h(lists,)h(whic)o(h)g(requires)g
Fo(O)q Ft(\()p Fo(cu)p Ft(\))e(steps)1020 2165 y(in)15
b(general)i(and)e Fo(O)q Ft(\()p Fo(c)p Ft(\))f(steps)h(in)h(the)e
(single-threaded)k(case.)k(The)1020 2206 y(deletion)13
b(of)e Fn(v)g Ft(tak)o(es)h Fo(O)q Ft(\()p Fo(c)p Ft(\))e(time)i(for)f
(eac)o(h)h(list.)17 b(Th)o(us,)12 b Fn(&)p 1833 2213
V 10 w Ft(is)g Fo(O)q Ft(\()p Fo(c)1962 2190 y Fh(2)1979
2206 y Fo(u)p Ft(\))1020 2248 y(in)i(general)g(and)g
Fo(O)q Ft(\()p Fo(c)1334 2232 y Fh(2)1351 2248 y Ft(\))f(in)h(the)f
(single-threaded)j(case.)1076 2289 y(W)m(e)h(can)f(impro)o(v)o(e)i
(this)f(implemen)o(tation)j(b)o(y)c(exploitin)q(g)j(the)1020
2331 y(follo)o(wing)g(observ)n(ation:)25 b(the)17 b(deletion)h(of)e(a)h
(no)q(de)g(in)g(an)o(y)g(adja-)1020 2372 y(cency)h(list)h(can)f(b)q(e)g
(noticed)h(at)e(the)h(earliest)h(when)f(that)g(list)h(is)1020
2414 y(requested)13 b(b)o(y)g(\(another\))f(con)o(text)h(matc)o(h.)k
(So)12 b(in)h(the)f(implemen-)1020 2455 y(tation)17 b(of)f
Fn(&)p 1183 2462 V 15 w Ft(instead)i(of)d(remo)o(ving)j
Fn(v)d Ft(from)h(adjacency)h(lists,)h(w)o(e)1020 2497
y(just)12 b(mark)h Fn(v)f Ft(as)h(deleted.)18 b(\(This)13
b(is)g(done)g(in)g(an)g(additional)j(arra)o(y)1020 2538
y Fo(V)9 b Ft(.\))21 b(But)14 b(no)o(w)h Fn(p)f Ft(and)h
Fn(s)e Ft(cannot)j(simply)g(b)q(e)f(b)q(ound)g(to)g Fo(S)r
Ft([)p Fn(v)p Ft(])e(and)1020 2580 y Fo(P)5 b Ft([)p
Fn(v)o Ft(],)k(resp)q(ectiv)o(ely)m(,)j(instead)e(only)g(those)g(no)q
(des)g(are)f(returned)h(that)1020 2621 y(are)15 b(not)g(mark)o(ed)g(as)
g(deleted)h(in)f Fo(V)9 b Ft(.)22 b(This)15 b(means)g(that)g(building)
961 2747 y(7)p eop
%%Page: 8 8
8 7 bop -76 -34 a Ft(the)15 b(reduced)h(graph)g(is)g
Fo(O)q Ft(\(1\))f(and)g(computing)i Fn(p)p Ft(,)e Fn(l)o
Ft(,)g(and)h Fn(s)e Ft(no)o(w)-76 7 y(tak)o(es)f Fo(O)q
Ft(\()p Fo(u)7 b Ft(+)g Fo(c)p Ft(\))12 b(steps)h(\()p
Fo(O)q Ft(\()p Fo(c)p Ft(\))e(in)j(the)e(single-threaded)j(case\),)e
(and)-76 49 y(this)g(is)g(also)h(the)e(complexit)o(y)j(of)d
Fn(&)p 416 56 20 2 v -1 w Ft(.)17 b(Ev)o(en)c(if)f(this)i(means)e(a)h
(reduc-)-76 90 y(tion)k(in)f(complexit)o(y)i(only)f(for)f(non-sparse)h
(graphs,)g(it)f(is)g(in)h(an)o(y)-76 132 y(case)f(an)h(imp)q(ortan)o(t)
g(impro)o(v)o(emen)o(t)h(in)f(practice,)g(since)g(in)g(addi-)-76
173 y(tion)d(to)f(smaller)h(constan)o(ts)g(within)h(the)e(big-Oh)h
(expressions,)h(w)o(e)-76 215 y(also)f(sa)o(v)o(e)g(a)f(lot)g(of)g
(heap)h(allo)q(cations.)-20 256 y(There)d(remains)h(one)g(problem)g
(with)g(the)f(prop)q(osed)h(approac)o(h:)-76 298 y(assume)17
b(the)f(con)o(text)g(of)f(no)q(de)i Fn(v)e Ft(is)i(deleted)g(and,)g
(for)e(example,)-76 339 y Fo(S)r Ft([)p Fn(w)p Ft(])10
b(con)o(tains)j Fn(v)o Ft(.)j(No)o(w,)11 b(if)g(later)g(on)g
Fn(v)g Ft(is)g(re-inserted)h Fs(without)h Fn(w)d Ft(as)-76
381 y(one)15 b(of)f(its)h(predecessors,)h(then)e Fn(v)g
Ft(still)i(m)o(ust)f(not)g(b)q(e)f(considered)-76 422
y(a)h(successor)h(of)e Fn(w)p Ft(.)22 b(But)15 b(this)h(seems)f(to)g(b)
q(e)g(imp)q(ossible)j(since)e(w)o(e)-76 464 y(cannot)g(mark)g
Fn(v)e Ft(as)h(deleted)i(an)o(ymore.)24 b(A)15 b(solution)i(is)f(to)f
(equip)-76 505 y(no)q(des)h(with)g(a)f(kind)h(of)f(\\time)h(stamps":)21
b(when)16 b(a)f(no)q(de)h Fn(v)e Ft(is)i(in-)-76 547
y(serted)f(the)f(\014rst)g(time,)g(it)h(gets)f(a)g(stamp,)h(sa)o(y)f(1)
g(\(that)g(is,)h(w)o(e)e(set)-76 588 y Fo(V)c Ft([)p
Fn(v)o Ft(])16 b(:=)f(1\))h(and)h(w)o(e)e(store)h(this)h(stamp)g(with)f
(eac)o(h)h(en)o(try)f(in)h(an)-76 630 y(adjacency)g(list.)25
b(When)16 b Fn(v)f Ft(is)g(remo)o(v)o(ed,)i(w)o(e)d(set)i
Fo(V)9 b Ft([)p Fn(v)o Ft(])14 b(:=)g Fi(\000)p Fo(V)9
b Ft([)p Fn(v)o Ft(].)-76 671 y(When)16 b(accessing)g(no)q(des)g(in)g
(an)f(adjacency)g(list,)h(w)o(e)f(return)g(only)-76 713
y(those)i(no)q(des)h(whose)f(stamps)g(in)h(the)f(list)h(are)f(equal)h
(to)e(that)h(in)-76 754 y Fo(V)9 b Ft(.)32 b(So)19 b(deleted)h(no)q
(des)f(will)h(b)q(e)e(\014ltered)h(out.)33 b(No)o(w)18
b(when)h(re-)-76 796 y(inserting)f Fn(v)d Ft(w)o(e)g(set)g
Fo(V)9 b Ft([)p Fn(v)p Ft(])14 b(:=)g Fi(\000)p Fo(V)9
b Ft([)p Fn(v)o Ft(])h(+)g(1)16 b(so)g(that)f(\\old")i(en)o(tries)-76
837 y(in)g(adjacency)g(lists)h(still)g(ha)o(v)o(e)e(non-matc)o(hing)i
(stamps)f(and)g(will)-76 879 y(correctly)d(b)q(e)g(\014ltered)g(out.)
-20 920 y(The)23 b(imp)q(ortance)h(of)e(the)h(structure)g(lies)h(in)f
(its)g(b)q(eha)o(vior)-76 962 y(on)17 b(single-threaded)j(graph)e
(decomp)q(ositions:)628 946 y Fh(2)673 962 y Ft(a)f(function)h(lik)o(e)
-76 1003 y Fn(gfold)12 b Ft(has)i(a)g(running)i(time)f(of)e
Fo(O)q Ft(\()p Fi(j)p Fo(V)c Fi(j)g Ft(+)g Fi(j)p Fo(E)r
Fi(j)p Ft(\),)k(that)h(is,)h(is)f(linear)-76 1045 y(in)j(the)f(size)g
(of)g(the)g(graph.)26 b(As)15 b(an)h(immediate)i(consequence)f(of)-76
1086 y(this,)g(algorithms,)h(suc)o(h)e(as)f(dfs,)h(ha)o(v)o(e)g(the)g
(same)f(complexit)o(y)j(as)-76 1128 y(in)c(the)f(imp)q(erativ)o(e)i
(case.)-20 1169 y(Ho)o(w)o(ev)o(er,)d(the)h(implemen)o(tation)j(of)c
(functional)j(graphs)f(b)q(ears)-76 1211 y(a)i(considerable)j(o)o(v)o
(erhead.)28 b(T)m(o)15 b(get)h(an)h(impression)h(of)e(the)g(real)-76
1253 y(b)q(eha)o(vior,)j(w)o(e)e(compare)g(the)g(functional)i
(algorithms)g(for)d(graph)-76 1294 y(rev)o(ersal,)i(dfs,)f(and)g(D)o(A)
o(G)f(ev)n(aluation)j(with)e(corresp)q(onding)i(im-)-76
1336 y(p)q(erativ)o(e)g(implemen)o(tatio)q(ns.)35 b(W)m(e)18
b(also)h(giv)o(e)g(the)f(measures)g(for)-76 1377 y(a)g(functional)h
(realization)h(of)d(the)h(imp)q(erativ)o(e)h(algorithms)h(with)-76
1419 y(functional)15 b(arra)o(ys.)-20 1460 y(The)i(imp)q(erativ)o(e)h
(algorithms)h(mak)o(e)e(use)g(of)f(the)h(imp)q(erativ)o(e)-76
1502 y(arra)o(ys)g(of)f(ML)g(and)h(represen)o(t)g(a)f(graph)h(simply)h
(b)o(y)f(t)o(w)o(o)f(arra)o(ys)-76 1543 y(for)f(storing)i(no)q(de)f
(lab)q(els)i(and)e(successors.)25 b(The)15 b(functional)j(im-)-76
1585 y(plemen)o(tation)h(of)d(the)h(imp)q(erativ)o(e)i(algorithms)g
(use)d(an)h(e\016cien)o(t)-76 1626 y(implemen)o(tation)e(of)d(balanced)
h(binary)h(searc)o(h)e(trees)g([2])f(to)h(repre-)-76
1668 y(sen)o(t)i(functional)h(arra)o(ys.)j(The)13 b(algorithms)j(are)d
(sligh)o(tly)j(c)o(hanged)-76 1709 y(to)f(exploit)i(the)f(dynamic)h(b)q
(eha)o(vior)g(of)d(searc)o(h)i(trees)f(and)h(to)f(ac-)-76
1751 y(coun)o(t)k(for)f(state)h(threading.)35 b(The)19
b(functional)h(algorithms)h(are)-76 1792 y(those)12 b(de\014ned)h(in)f
(the)g(pap)q(er,)h(that)e(is,)i(they)f(are)f(de\014ned)i(through)-76
1834 y Fn(ufold)n Ft(,)j Fn(gfold)n Ft(,)h(and)f Fn(mfold)e
Ft(whic)o(h)j(are)f(based)h(on)f Fn(&)g Ft(and)g Fn(&)p
825 1841 V 16 w Ft(\(or,)-76 1875 y Fn(context)p Ft(\))c(as)j(pro)o
(vided)i(b)o(y)f(the)f(p)q(ersisten)o(t)h(graph)g(implemen)o(ta-)-76
1917 y(tion)f(describ)q(ed)h(ab)q(o)o(v)o(e.)k(The)13
b(source)i(co)q(de)f(is)h(sho)o(wn)f(in)h(the)f(Ap-)-76
1958 y(p)q(endix.)24 b(As)15 b(exp)q(ected,)h(the)f(functional)i
(algorithms)f(are)f(signi\014-)-76 2000 y(can)o(tly)g(slo)o(w)o(er)f
(than)g(the)g(imp)q(erativ)o(e)h(ones.)k(This)14 b(is)g(mainly)i(due)
-76 2041 y(to)g(the)g(in)o(tensiv)o(e)j(use)d(of)g(the)g(heap)h(caused)
g(b)o(y)g(up)q(dates)g(to)f(the)-76 2083 y(graph)e(represen)o(ting)h
(functional)g(arra)o(ys.)-20 2124 y(W)m(e)d(can)g(impro)o(v)o(e)i(the)d
(running)j(time)f(of)e(the)h(functional)i(algo-)-76 2166
y(rithms)g(b)o(y)e(pro)o(viding)k(prede\014ned)e(graph)f(fold)h(op)q
(erations.)k(Con-)-76 2207 y(sider,)g(for)d(example,)j
Fn(gfold)n Ft(:)23 b(Instead)16 b(of)g(decomp)q(osing)i(the)e(ar-)-76
2249 y(gumen)o(t)e(graph)g(in)g(eac)o(h)g(step,)f(w)o(e)g(can)h(use)f
(a)g(lo)q(cal)i(\(imp)q(erativ)o(e\))-76 2290 y(arra)o(y)h
Fo(M)j Ft(to)d(mark)g(those)f(no)q(des)i(already)g(matc)o(hed)f(during)
h(the)-76 2332 y(curren)o(t)g(run)h(of)e Fn(gfold)n Ft(:)24
b(Initially)n(,)c Fo(M)g Ft(is)e(obtained)g(b)o(y)f(cop)o(ying)-76
2373 y(the)d(stamp)f(arra)o(y)h Fo(V)22 b Ft(of)13 b(the)h(argumen)o(t)
g(graph.)k(Then)c(eac)o(h)g(time)-76 2415 y(the)g(con)o(text)h(of)f(a)g
(no)q(de)h Fn(v)e Ft(is)i(matc)o(hed,)f Fo(M)t Ft([)p
Fn(v)p Ft(])f(is)i(set)f(to)g Fi(\000)p Ft(1,)g(and)-76
2456 y(only)g(those)g(successors)g(and)g(predecessor)g(of)e
Fn(v)h Ft(are)g(selected)h(that)p -76 2486 399 2 v -34
2513 a Fh(2)-16 2526 y Fa(Note)d(that)h(the)g(complexit)o(y)i(of)e(the)
h(general)f(case)f(could)i(b)q(e)f(impro)o(v)o(ed)-76
2559 y(b)o(y)g(emplo)o(ying)f(adv)n(anced)g(data)f(structures)h(for)g
(functional)g(arra)o(ys,)g(suc)o(h)h(as)-76 2592 y([5],)g(although)f
(an)g(implemen)o(tation)i(w)o(ould)f(require)f(considerable)h
(e\013ort.)1020 -34 y Ft(ha)o(v)o(e)j(a)g(stamp)g(equal)h(to)f(that)g
(in)h Fo(M)t Ft(.)22 b(Similarly)m(,)c Fn(mfold)13 b
Ft(can)i(b)q(e)1020 7 y(impro)o(v)o(ed)f(b)o(y)f(lo)q(cally)i(storing)f
(tra)o(v)o(ersed)g(edges)f(in)g(a)g(hash)g(table.)1076
49 y(The)e(case)g(for)f Fn(ufold)f Ft(is)i(more)g(subtle.)18
b(First,)11 b(w)o(e)f(observ)o(e)i(that)1020 90 y(the)h(c)o(hosen)g
(arra)o(y)g(represen)o(tation)i(of)d(a)g(graph)i(forgets)e(ab)q(out)i
(its)1020 132 y(construction)j(history)m(.)25 b(In)16
b(particular,)i(w)o(e)c(do)i(not)g(kno)o(w)f(whic)o(h)1020
173 y(no)q(de)c(\(con)o(text\))g(w)o(as)g(inserted)h(last.)k(This)c
(implies)h(that)d(with)h(this)1020 215 y(implemen)o(tation)18
b Fn(&)d Ft(cannot)g(b)q(e)h(used)f(in)h(pattern)g(matc)o(hing.)24
b(So)1020 256 y(to)11 b(implemen)o(t)h Fn(ufold)c Ft(w)o(e)j(rather)g
(need)g(a)f(function)i(lik)o(e)g Fn(matchany)1020 298
y Ft(that)i(matc)o(hes)g(an)g(arbitrary)i(no)q(de)e(con)o(text.)20
b(No)o(w)14 b(a)f(simple)j(im-)1020 339 y(plemen)o(tation)f(for)d
Fn(matchany)d Ft(will)14 b(searc)o(h)e(for)g(an)o(y)h(\(for)f(example,)
1020 381 y(the)19 b(\014rst\))f(no)q(de)h(that)g(has)g(a)f(v)n(alid)i
(stamp.)33 b(Used)19 b(rep)q(eatedly)m(,)1020 422 y(this)e(leads)h(to)e
(a)g(running)i(time)f(of)f Fn(ufold)e Ft(that)i(is)h(quadratic)h(in)
1020 464 y(the)13 b(n)o(um)o(b)q(er)g(of)f(no)q(des.)18
b(Th)o(us,)13 b(a)f(prede\014ned)j(v)o(ersion)f(that)e(scans)1020
505 y(the)k(no)q(de)h(arra)o(y)g(in)g(a)f(\014xed)h(order)g(ac)o(hiev)o
(es)h(linear)g(complexit)o(y)1020 547 y(for)13 b Fn(ufold)n
Ft(.)j(The)d(implemen)o(tation)j(also)e(uses)g(a)f(lo)q(cal)h(imp)q
(erativ)o(e)1020 588 y(arra)o(y)f Fo(M)k Ft(similar)f(to)d(the)g
(prede\014ned)h Fn(gfold)n Ft(.)1076 630 y(W)m(e)d(ran)h(the)f
(implemen)o(tations)j(of)d Fn(grev)e Ft(and)j Fn(dfs)e
Ft(on)h(a)g(sparse)1020 671 y(graph)g(\(with)f(a)g(degree)g(of)f(8\))h
(with)g(1000,)h(5000,)g(and)f(10000)g(no)q(des.)1020
713 y(The)15 b(user)h(time)g(sp)q(en)o(t)g(b)o(y)g(SML/NJ)f(1.09)h(on)g
(a)f(SP)m(AR)o(Cstation)1020 754 y(10)h(is)h(giv)o(en)g(in)f(Figures)i
(4)e(and)g(5.)26 b(The)15 b(\\functionali)q(zed"-rows)1020
796 y(sho)o(w)e(the)g(times)h(of)f(a)g(functional)i(realization)h(of)d
(the)g(imp)q(erativ)o(e)1020 837 y(algorithms.)p 1372
974 2 46 v 1402 960 a(1000)p 1501 974 V 72 w(5000)p 1648
974 V 52 w(10000)p 1796 974 V 1804 974 V 76 w(ratios)p
1965 974 V 1045 976 922 2 v 1045 985 V 1183 1017 a(functional)p
1372 1031 2 46 v 48 w(0.68s)p 1501 1031 V 45 w(13.04s)p
1648 1031 V 45 w(50.49s)p 1796 1031 V 1804 1031 V 53
w(68..388)p 1965 1031 V 1045 1032 922 2 v 1067 1064 a(prede\014ned)i
Fn(ufold)p 1372 1078 2 46 v 43 w Ft(0.16s)p 1501 1078
V 64 w(0.98s)p 1648 1078 V 65 w(3.25s)p 1796 1078 V 1804
1078 V 72 w(10..25)p 1965 1078 V 1045 1080 922 2 v 1173
1112 a(imp)q(erativ)o(e)p 1372 1125 2 46 v 47 w(0.01s)p
1501 1125 V 64 w(0.10s)p 1648 1125 V 65 w(0.13s)p 1796
1125 V 1804 1125 V 150 w(1)p 1965 1125 V 1045 1127 922
2 v 1117 1159 a(functionalize)q(d)p 1372 1173 2 46 v
48 w(0.30s)p 1501 1173 V 64 w(2.04s)p 1648 1173 V 65
w(4.72s)p 1796 1173 V 1804 1173 V 72 w(20..36)p 1965
1173 V 1045 1174 922 2 v 1238 1246 a(Figure)f(4:)j(Running)f(times)d
(of)g Fn(grev)p Ft(.)1076 1372 y(The)18 b(prede\014ned)h(v)o(ersion)g
(of)f Fn(ufold)d Ft(impro)o(v)o(es)k(the)f(running)1020
1414 y(time)c(of)f Fn(grev)f Ft(b)o(y)i(an)g(order)g(of)g(magnitude,)h
(but)f(it)g(cannot)g(com-)1020 1455 y(p)q(ete)19 b(with)f(the)h(imp)q
(erativ)o(e)h(implemen)o(tation.)36 b(Ho)o(w)o(ev)o(er,)19
b(it)g(is)1020 1497 y(recognizably)d(faster)d(that)g(the)g
(functionalized)k(implemen)o(tation.)p 1395 1634 2 46
v 1425 1620 a(1000)p 1523 1634 V 52 w(5000)p 1651 1634
V 46 w(10000)p 1792 1634 V 1800 1634 V 57 w(ratios)p
1943 1634 V 1067 1635 877 2 v 1067 1644 V 1206 1676 a(functional)p
1395 1690 2 46 v 47 w(0.08s)p 1523 1690 V 45 w(0.72s)p
1651 1690 V 58 w(1.58s)p 1792 1690 V 1800 1690 V 72 w(8..12)p
1943 1690 V 1067 1692 877 2 v 1090 1724 a(prede\014ned)d
Fn(gfold)p 1395 1737 2 46 v 43 w Ft(0.02s)p 1523 1737
V 45 w(0.17s)p 1651 1737 V 58 w(0.26s)p 1792 1737 V 1800
1737 V 91 w(2..3)p 1943 1737 V 1067 1739 877 2 v 1195
1771 a(imp)q(erativ)o(e)p 1395 1785 2 46 v 47 w(0.01s)p
1523 1785 V 45 w(0.06s)p 1651 1785 V 58 w(0.13s)p 1792
1785 V 1800 1785 V 132 w(1)p 1943 1785 V 1067 1786 877
2 v 1140 1818 a(functionalized)p 1395 1832 2 46 v 48
w(0.21s)p 1523 1832 V 45 w(0.76s)p 1651 1832 V 58 w(2.28s)p
1792 1832 V 1800 1832 V 53 w(13..21)p 1943 1832 V 1067
1834 877 2 v 1248 1905 a(Figure)g(5:)j(Running)e(times)f(of)f
Fn(dfs)p Ft(.)1076 2031 y(W)m(e)18 b(can)g(see)g(in)g(Figure)h(5)f
(that)g(the)g(prede\014ned)h(v)o(ersion)g(of)1020 2072
y Fn(gfold)13 b Ft(p)q(erforms)j(quite)g(w)o(ell.)24
b(It)15 b(is)h(striking)h(that)f Fn(gfold)d Ft(seems)1020
2114 y(to)k(run)g(m)o(uc)o(h)g(faster)g(than)g Fn(ufold)n
Ft(.)28 b(This)17 b(is)g(certainly)i(b)q(ecause)1020
2155 y(imp)q(erativ)o(e)e(dfs)d(has)i(to)e(build)j(a)e(dfs-tree)f(on)h
(the)g(heap)h(whereas)1020 2197 y(imp)q(erativ)o(e)j(graph)e(rev)o
(erse)h(only)f(w)o(orks)g(on)g(its)h(imp)q(erativ)o(e)g(ar-)1020
2238 y(ra)o(ys.)1076 2280 y(The)13 b(function)h Fn(evaldag)c
Ft(w)o(as)i(applied)j(to)e(tree-shap)q(ed)h(D)o(A)o(Gs)1020
2321 y(where)g(in)o(ternal)h(no)q(des)f(ha)o(v)o(e)g(t)o(w)o(o)f
(successors)i(and)f(predecessors.)1020 2363 y(The)f(results)h(are)f
(sho)o(wn)h(in)f(Figure)i(6.)1076 2404 y(Again,)c(the)g(basic)g
(functional)h(solution)h(is)d(extremely)h(slo)o(w)g(b)q(e-)1020
2446 y(cause)g Fn(mfold)d Ft(has)i(to)g(mak)o(e)g(in)o(tensiv)o(e)i
(use)f(of)e(graph)i(constructors.)961 2747 y(8)p eop
%%Page: 9 9
9 8 bop 290 8 2 46 v 319 -6 a Ft(5050)p 418 8 V 46 w(11325)p
559 8 V 52 w(20100)p 706 8 V 714 8 V 58 w(ratios)p 856
8 V -38 10 896 2 v -38 19 V 100 51 a(functional)p 290
64 2 46 v 48 w(2.59s)p 418 64 V 58 w(7.41s)p 559 64 V
45 w(15.08s)p 706 64 V 714 64 V 53 w(43..49)p 856 64
V -38 66 896 2 v -16 98 a(prede\014ned)15 b Fn(mfold)p
290 112 2 46 v 43 w Ft(0.32s)p 418 112 V 58 w(0.82s)p
559 112 V 64 w(1.72s)p 706 112 V 714 112 V 132 w(5)p
856 112 V -38 113 896 2 v 90 145 a(imp)q(erativ)o(e)p
290 159 2 46 v 47 w(0.06s)p 418 159 V 58 w(0.15s)p 559
159 V 64 w(0.32s)p 706 159 V 714 159 V 132 w(1)p 856
159 V -38 161 896 2 v 34 193 a(functionaliz)q(ed)p 290
206 2 46 v 48 w(0.46s)p 418 206 V 58 w(1.18s)p 559 206
V 64 w(2.35s)p 706 206 V 714 206 V 91 w(7..8)p 856 206
V -38 208 896 2 v 113 280 a(Figure)f(6:)j(Running)e(times)f(of)f
Fn(evaldag)p Ft(.)-76 442 y Fu(8)53 b(Conclusions)-76
521 y Ft(W)m(e)11 b(ha)o(v)o(e)g(presen)o(ted)h(a)e(new)h(programming)i
(st)o(yle)e(for)f(graphs)i(that)-76 562 y(dra)o(ws)17
b(m)o(uc)o(h)f(of)g(its)h(attraction)g(from)f(b)q(eing)i(based)f(on)g
(pattern)-76 604 y(matc)o(hing)j(and)e(v)n(alue)h(decomp)q(osition,)j
(whic)o(h)d(are)f(w)o(ell-kno)o(wn)-76 645 y(and)d(accepted)h
(programming)h(concepts.)22 b(The)15 b(most)g(signi\014can)o(t)-76
687 y(di\013erence)j(b)q(et)o(w)o(een)d(this)i(and)f(previous)h
(approac)o(hes)g(is)g(the)e(de-)-76 728 y(parture)d(from)f(the)g(imp)q
(erativ)o(e)i Fs(view)i Ft(of)c(graph)h(tra)o(v)o(ersals,)g(giving)-76
770 y(more)19 b(opp)q(ortunities)j(for)d(program)h(transformation)h
(and)e(opti-)-76 812 y(mization.)37 b(Although)20 b(more)g(w)o(ork)e
(is)i(required)h(on)e(functional)-76 853 y(graphs)c(and)g(e\016cien)o
(t)f(graph)h(op)q(erations,)h(exp)q(erimen)o(ts)g(with)e(an)-76
895 y(initial)e(implemen)o(tation)g(are)d(encouraging)j(sho)o(wing)e
(that)f(the)g(pre-)-76 936 y(sen)o(ted)k(approac)o(h)h(is)f(a)f
(reasonable)j(and)e(practical)h(alternativ)o(e)g(to)-76
978 y(imp)q(erativ)o(e)21 b(graphs)e(in)g(functional)i(languages.)35
b(In)18 b(particular,)-76 1019 y(prede\014ned)13 b(graph)f(op)q
(erations)i(o\013er)e(m)o(uc)o(h)f(p)q(oten)o(tial)j(for)d(further)-76
1061 y(e\016ciency)k(impro)o(v)o(emen)o(ts.)-76 1173
y Fu(References)-57 1252 y Ft([1])k(A.)c(Aasa,)j(S.)e(Holstr\177)-19
b(om,)18 b(and)f(C.)f(Nilsson.)29 b(An)17 b(E\016ciency)3
1293 y(Comparison)g(of)f(Some)g(Represen)o(tations)i(of)e(Purely)h(F)m
(unc-)3 1335 y(tional)d(Arra)o(ys.)j Fs(BIT)p Ft(,)c(28:490{503,)h
(1988.)-57 1406 y([2])19 b(S.)c(Adams.)24 b(E\016cien)o(t)16
b(Sets)g({)f(A)g(Balancing)j(Act.)24 b Fs(Journal)3 1448
y(of)13 b(F)m(unctional)d(Pr)n(o)n(gr)n(amming)p Ft(,)i(3:553{561,)i
(1993.)-57 1519 y([3])19 b(R.)9 b(S.)h(Bird.)j(F)m(unctional)f
(Algorithm)g(Design.)h(In)d Fs(Mathemat-)3 1561 y(ics)16
b(of)h(Pr)n(o)n(gr)n(am)h(Construction)p Ft(,)d(LNCS)i(947,)h(pages)g
(2{17,)3 1602 y(1995.)-57 1674 y([4])h(F.)d(W.)h(Burton)h(and)g(H.-K.)e
(Y)m(ang.)30 b(Manipulatin)q(g)20 b(Multi-)3 1715 y(link)o(ed)14
b(Data)e(Structures)h(in)g(a)f(Pure)g(F)m(unctional)i(Language.)3
1757 y Fs(Softwar)n(e)e({)i(Pr)n(actic)n(e)e(and)g(Exp)n(erienc)n(e)p
Ft(,)f(20\(11\):1167{1185,)3 1798 y(1990.)-57 1870 y([5])19
b(P)m(.)14 b(F.)g(Dietz.)23 b(F)m(ully)17 b(P)o(ersisten)o(t)e(Arra)o
(ys.)23 b(In)15 b Fs(Workshop)e(on)3 1911 y(A)o(lgorithms)e(and)i(Data)
g(Structur)n(es)p Ft(,)d(LNCS)j(382,)h(pages)g(67{)3
1953 y(74,)e(1989.)-57 2024 y([6])19 b(J.)10 b(R.)i(Driscoll,)i(N.)d
(Sarnak,)h(D.)g(D.)f(Sleator,)i(and)f(R.)g(E.)f(T)m(ar-)3
2065 y(jan.)32 b(Making)20 b(Data)f(Structures)g(P)o(ersisten)o(t.)34
b Fs(Journal)17 b(of)3 2107 y(Computer)12 b(and)h(System)f(Scienc)n(es)
p Ft(,)e(38:86{124,)k(1989.)-57 2178 y([7])19 b(M.)9
b(Erwig.)j(Graph)e(Algorithms)i(=)d(Iteration)i(+)e(Data)h(Struc-)3
2220 y(tures?)19 b(The)13 b(Structure)h(of)g(Graph)g(Algorithms)h(and)f
(a)g(Cor-)3 2261 y(resp)q(onding)j(St)o(yle)e(of)f(Programming.)23
b(In)14 b Fs(18th)g(Int.)g(Work-)3 2303 y(shop)j(on)g(Gr)n(aph)h(The)n
(or)n(etic)f(Conc)n(epts)f(in)i(Computer)g(Sci-)3 2344
y(enc)n(e)p Ft(,)11 b(LNCS)h(657,)h(pages)h(277{292,)g(1992.)-57
2416 y([8])19 b(M.)c(Erwig.)26 b(Activ)o(e)16 b(P)o(atterns.)26
b(In)15 b Fs(8th)h(Int.)f(Workshop)f(on)3 2457 y(Implementation)e(of)i
(F)m(unctional)f(L)n(anguages)p Ft(,)f(LNCS)i(1268,)3
2499 y(pages)f(21{40,)h(1996.)-57 2570 y([9])19 b(M.)e(Erwig)h(and)g
(B.)f(Mey)o(er.)30 b(Heterogeneous)19 b(Visual)g(Lan-)3
2612 y(guages)12 b({)f(In)o(tegrating)i(Visual)g(and)f(T)m(extual)g
(Programming.)1098 -34 y(In)j Fs(11th)e(IEEE)i(Symp.)f(on)g(Visual)e(L)
n(anguages)p Ft(,)g(pages)j(318{)1098 7 y(325,)f(1995.)1020
79 y([10])k(L.)d(F)m(egaras)h(and)g(T.)e(Sheard.)25 b(Revisiting)18
b(Catamorphisms)1098 120 y(o)o(v)o(er)h(Datat)o(yp)q(es)h(with)g(Em)o
(b)q(edded)g(F)m(unctions.)35 b(In)19 b Fs(A)o(CM)1098
162 y(Symp.)12 b(on)h(Principles)d(of)i(Pr)n(o)n(gr)n(amming)g(L)n
(anguages)p Ft(,)d(pages)1098 203 y(284{294,)14 b(1996.)1020
275 y([11])k(J.)d(Gibb)q(ons.)26 b(An)15 b(Initial)j(Algebra)e(Approac)
o(h)h(to)e(Directed)1098 316 y(Acyclic)f(Graphs.)i(In)d
Fs(Mathematics)d(of)j(Pr)n(o)n(gr)n(am)f(Construc-)1098
358 y(tion)p Ft(,)g(LNCS)g(947,)h(pages)h(282{303,)g(1995.)1020
429 y([12])k(Z.)f(Hu,)g(H.)f(Iw)o(asaki,)i(and)f(M.)g(T)m(ak)o(eic)o
(hi.)29 b(Deriving)19 b(Struc-)1098 470 y(tural)h(Hylomorphisms)i(from)
d(Recursiv)o(e)h(De\014nitions.)38 b(In)1098 512 y Fs(1st)11
b(A)o(CM)h(SIGPLAN)e(Int.)h(Conf.)f(on)h(F)m(unctional)e(Pr)n(o)n(gr)n
(am-)1098 553 y(ming)p Ft(,)j(pages)i(73{82,)f(1996.)1020
625 y([13])18 b(Y.)23 b(Kashiw)o(agi)i(and)f(D.)f(Wise.)48
b(Graph)24 b(Algorithms)h(in)1098 666 y(a)e(Lazy)f(F)m(unctional)i
(Programming)g(Language.)45 b(In)22 b Fs(4th)1098 708
y(Int.)11 b(Symp.)f(on)g(Lucid)g(and)g(Intensiona)o(l)e(Pr)n(o)n(gr)n
(aming)p Ft(,)h(pages)1098 749 y(35{46,)14 b(1991.)1020
821 y([14])k(D.)11 b(J.)f(King)i(and)f(J.)f(Launc)o(h)o(bury)m(.)15
b(Structuring)e(Depth-First)1098 862 y(Searc)o(h)g(Algorithms)h(in)e
(Hask)o(ell.)17 b(In)12 b Fs(A)o(CM)h(Symp.)e(on)h(Prin-)1098
904 y(ciples)e(of)g(Pr)n(o)n(gr)n(amming)g(L)n(anguages)p
Ft(,)d(pages)k(344{354,)h(1995.)1020 975 y([15])18 b(J.)f(Launc)o(h)o
(bury)m(.)31 b(Graph)18 b(Algorithms)h(with)f(a)f(F)m(unctional)1098
1017 y(Fla)o(v)o(our.)24 b(In)14 b Fs(1st)g(Int.)h(Spring)e(Scho)n(ol)g
(on)i(A)n(dvanc)n(e)n(d)d(F)m(unc-)1098 1058 y(tional)g(Pr)n(o)n(gr)n
(amming)p Ft(,)g(LNCS)g(925,)h(pages)h(308{331,)g(1995.)1020
1130 y([16])k(J.)12 b(Launc)o(h)o(bury)j(and)e(T.)f(Sheard.)17
b(W)m(arm)c(F)m(usion:)18 b(Deriving)1098 1171 y(Build-Catas)i(from)e
(Recursiv)o(e)h(De\014nitions.)33 b(In)18 b Fs(Conf.)f(on)1098
1213 y(F)m(unctional)g(Pr)n(o)n(gr)n(amming)i(and)g(Computer)g(A)o(r)n
(chite)n(ctur)n(e)p Ft(,)1098 1254 y(pages)14 b(314{323,)g(1995.)1020
1326 y([17])k(G.)f(Malcom.)31 b(Homomorphisms)19 b(and)f(Promotabilit)o
(y)q(.)32 b(In)1098 1367 y Fs(Mathematics)25 b(of)g(Pr)n(o)n(gr)n(am)h
(Construction)p Ft(,)h(LNCS)f(375,)1098 1409 y(pages)14
b(335{347,)g(1989.)1020 1480 y([18])k(E.)e(Meijer,)g(M.)g(F)m(okkinga,)
h(and)g(R.)e(P)o(aterson.)26 b(F)m(unctional)1098 1522
y(Programming)e(with)e(Bananas,)j(Lenses,)f(En)o(v)o(elop)q(es)f(and)
1098 1563 y(Barb)q(ed)11 b(Wire.)i(In)c Fs(Conf.)h(on)g(F)m(unctional)e
(Pr)n(o)n(gr)n(amming)i(and)1098 1605 y(Computer)j(A)o(r)n(chite)n
(ctur)n(e)p Ft(,)d(pages)k(124{144,)f(1991.)1020 1676
y([19])18 b(R.)13 b(Milner,)i(M.)e(T)m(ofte,)f(and)h(R.)g(Harp)q(er.)18
b Fs(The)13 b(De\014nition)e(of)1098 1717 y(Standar)n(d)h(ML)p
Ft(.)17 b(MIT)12 b(Press,)h(Cam)o(bridge,)h(MA,)f(1990.)1020
1789 y([20])18 b(C.)c(Ok)n(asaki.)23 b(F)m(unctional)17
b(Data)e(Structures.)23 b(In)14 b Fs(A)n(dvanc)n(e)n(d)1098
1830 y(F)m(unctional)g(Pr)n(o)n(gr)n(amming)p Ft(,)h(LNCS)h(1129,)h
(pages)f(131{158,)1098 1872 y(1996.)1020 1943 y([21])i(P)m(.)d(P)o
(alao)h(Gonstanza,)h(R.)e(P)o(e)q(~)-20 b(na,)16 b(and)f(M.)g(N)q(\023)
-20 b(u)q(~)g(nez.)24 b(A)15 b(New)1098 1985 y(Lo)q(ok)f(at)f(P)o
(attern)g(Matc)o(hing)i(in)e(Abstract)h(Data)f(T)o(yp)q(es.)k(In)1098
2026 y Fs(1st)11 b(A)o(CM)h(SIGPLAN)e(Int.)h(Conf.)f(on)h(F)m
(unctional)e(Pr)n(o)n(gr)n(am-)1098 2068 y(ming)p Ft(,)j(pages)i
(110{121,)g(1996.)1020 2139 y([22])k(T.)d(Sheard)h(and)g(L.)f(F)m
(egaras.)24 b(A)15 b(F)m(old)h(for)f(all)h(Seasons.)25
b(In)1098 2181 y Fs(Conf.)16 b(on)h(F)m(unctional)c(Pr)n(o)n(gr)n
(amming)j(and)g(Computer)g(A)o(r-)1098 2222 y(chite)n(ctur)n(e)p
Ft(,)10 b(pages)k(233{242,)g(1993.)1020 2294 y([23])k(P)m(.)h(W)m
(adler.)35 b(Views:)29 b(A)19 b(W)m(a)o(y)g(for)f(P)o(attern)i(Matc)o
(hing)g(to)1098 2335 y(Cohabit)h(with)e(Data)h(Abstraction.)36
b(In)19 b Fs(A)o(CM)h(Symp.)e(on)1098 2377 y(Principles)c(of)g(Pr)n(o)n
(gr)n(amming)h(L)n(anguages)p Ft(,)d(pages)j(307{313,)1098
2418 y(1987.)1020 2490 y([24])j(P)m(.)23 b(W)m(adler.)50
b(Deforestation:)40 b(T)m(ransforming)24 b(Programs)1098
2531 y(to)f(Eliminate)j(T)m(rees.)46 b Fs(The)n(or)n(etic)n(al)21
b(Computer)h(Scienc)n(e)p Ft(,)1098 2573 y(73:231{284,)14
b(1990.)961 2747 y(9)p eop
%%Page: 10 10
10 9 bop -76 -34 a Fu(App)q(endix)-76 44 y Fe(Pro)q(of)15
b(of)g(Theorem)g(2.)j Ft(W)m(e)13 b(p)q(erform)g(an)h(induction)i(on)d
Fn(l)g Ft(and)-76 86 y Fn(g)p Ft(.)-76 165 y Fn(l)d Ft(=)h
Fn([])p -76 175 111 2 v 49 w Ft(F)m(rom)i(the)g(de\014nition)i(of)e
Fn(gfoldn)e Ft(w)o(e)h(see)i(immediately)18 207 y(that)j
Fn(gfoldn)g(h)i(d)g(b)h(u)f([])g(g)d Ft(=)h Fn(\(u,g\))d
Ft(and)k(th)o(us)f Fn(gfold)18 248 y(h)i(d)g(b)g(u)g([])g(g)9
b Ft(=)g Fn(u)o Ft(.)16 b(Lik)o(ewise,)11 b Fn(gfold)18
b(h)h(e)g(f)g(u')g([])g(g)9 b Ft(=)18 290 y Fn(u')p Ft(.)15
b(No)o(w)10 b(the)h(conclusion)j(of)c(the)h(theorem)g(follo)o(ws)h
(directly)18 331 y(from)g(the)h(third)i(premise.)-76
402 y Fn(g)10 b Ft(=)h Fn(Empty)n Fo(;)6 b Fn(l)k Ft(=)h
Fn(v::l')p -76 417 355 2 v 47 w(gfoldn)h Ft(causes)k(a)e(call)i
Fn(gfold1)h(h)j(d)f(b)18 449 y(u)g(v)g(Empty)8 b Ft(raising)j(a)f
Fn(Match)e Ft(exception)j(that)f(is)g(handled)i(to)18
491 y(return)17 b Fn(gfoldn)g(h)j(d)f(b)g(u)g(l')g(Empty)n
Ft(.)29 b(Since)18 b(no)f(elemen)o(t)18 532 y(of)11 b
Fn(l')f Ft(can)i(b)q(e)g(matc)o(hed)h(in)f(the)g(empt)o(y)g(graph,)g(w)
o(e)f(kno)o(w)h(b)o(y)18 574 y(induction)17 b(on)e Fn(l')f
Ft(and)i(b)o(y)f(the)g(previous)i(case)e(that)g Fn(gfold)18
615 y(h)k(d)g(b)g(u)g(l)h(Empty)11 b Ft(=)j Fn(u)o Ft(.)19
b(F)m(or)14 b(the)g(same)g(reason,)g Fn(gfold)k(h)18
657 y(e)h(f)g(u')g(l)g(Empty)13 b Ft(=)i Fn(u')p Ft(,)f(and)i(for)f
(this)h(case)f(the)h(theorem)18 698 y(follo)o(ws)e(from)e(the)i(third)g
(premise.)-76 769 y Fn(g)c Ft(=)h Fn(c)19 b(&)g(g')p
Fo(;)6 b Fn(l)k Ft(=)h Fn(v::l')p -76 784 375 2 v 47
w Ft(Here)30 b Fn(gfold)d Ft(\014rst)j(causes)h(a)f(call)18
816 y Fn(gfold1)17 b(h)i(d)g(b)h(u)f(v)g(g)14 b Ft(whic)o(h)h(either)h
(succeeds)g(or)e(results)18 858 y(in)h(a)f Fn(Match)f
Ft(exception.)23 b(In)15 b(the)g(latter)g(case)g(handling)i(the)18
899 y(exception)i(yields)h Fn(gfoldn)e(h)h(d)g(b)g(u)g(l')g(g)p
Ft(,)g(and)f(since)h(in)18 941 y(that)14 b(case)g(the)g(corresp)q
(onding)j(expression)f Fn(gfold1)h(h)j(e)f(f)18 982 y(u')f(v)i(g)12
b Ft(also)j(raises)f Fn(Match)e Ft(and)i(yields)h Fn(gfoldn)j(h)h(e)g
(f)g(u')18 1024 y(l')f(g)p Ft(,)12 b(w)o(e)h(can)g(assume)h(the)f
(theorem)h(b)o(y)f(induction.)18 1080 y(Otherwise,)24
b(the)e Fn(gfold1)d Ft(expression)24 b(results)f(in)f(a)g(pair)18
1122 y Fn(\(x,g1\))16 b Ft(with)j Fn(x)g Ft(=)f Fn(d)h(\(lab,r\))d
Ft(where)j Fn(lab)f Ft(is)h(the)g(lab)q(el)18 1163 y(of)13
b Fn(v)h Ft(and)h Fn(r)e Ft(is)i(the)f(\014rst)g(comp)q(onen)o(t)h(of)f
(the)g(recursiv)o(e)i(call)18 1205 y Fn(gfoldn)h(h)i(d)g(b)h(u)f(s)g
(g')14 b Ft(\(where)h Fn(s)f Ft(=)g Fn(f)19 b(c)p Ft(\).)k(In)15
b(the)g(same)18 1246 y(w)o(a)o(y)c(w)o(e)f(obtain)j(a)e(v)n(alue)h
Fn(r')f Ft(as)g(the)g(\014rst)h(comp)q(onen)o(t)g(of)f(the)18
1288 y(expression)16 b Fn(gfoldn)h(h)j(e)f(f)g(u')g(s)g(g')p
Ft(,)14 b(and)h(w)o(e)f(can)h(apply)18 1329 y(the)e(induction)i(h)o(yp)
q(othesis)h(to)d(obtain)394 1408 y Fn(N)20 b(r)10 b Ft(=)g
Fn(r')327 b Ft(\(1\))18 1486 y(After)9 b(the)i Fn(gfold1)d
Ft(expression)13 b(has)e(b)q(een)g(ev)n(aluated,)i(a)d(pair)18
1528 y Fn(\(y,g2\))f Ft(is)k(computed)g(b)o(y)f Fn(gfoldn)18
b(h)h(d)g(b)g(u)g(l')g(g1)p Ft(.)d(Simi-)18 1569 y(larly)m(,)c(a)f
(pair)i Fn(\(y',g2\))8 b Ft(is)k(giv)o(en)g(b)o(y)g(the)f(expression)j
Fn(gfoldn)18 1611 y(h)19 b(e)g(f)g(u')g(l')g(g1)p Ft(.)39
b(Note)20 b(that)h(the)g(graphs)g Fn(g1)f Ft(and)h Fn(g2)18
1652 y Ft(are)13 b(actually)j(iden)o(tical)h(in)e(the)e(t)o(w)o(o)h
(folds)g(since)h(the)f(graph)18 1694 y(decomp)q(osition)20
b(is)d(only)i(a\013ected)f(b)o(y)f Fn(h)p Ft(,)g Fn(l)p
Ft(/)p Fn(l')p Ft(,)g(and)g Fn(g)p Ft(/)p Fn(g')18 1735
y Ft(whic)o(h)g(are)f(iden)o(tical)j(in)e(the)f(corresp)q(onding)j
(fold)e(expres-)18 1777 y(sions.)38 b(No)o(w)19 b(w)o(e)g(can)h(apply)i
(the)e(induction)i(h)o(yp)q(othesis)18 1818 y(again)14
b(and)g(get)394 1860 y Fn(N)20 b(y)10 b Ft(=)g Fn(y')327
b Ft(\(2\))18 1924 y(Finally)m(,)13 b(the)d(result)i(of)e
Fn(gfold)18 b(h)h(d)g(b)g(u)h(l)f(g)10 b Ft(is)h Fn(b)19
b(\(x,y\))9 b Ft(=)18 1965 y Fn(b)19 b(\(d)g(\(lab,r\),y)o(\))p
Ft(.)12 b(Lik)o(ewise,)f(the)e(result)h(of)f Fn(gfold)17
b(h)j(e)f(f)18 2007 y(u')f(l)i(g)12 b Ft(is)i Fn(f)19
b(\(e)g(\(lab,r'\),)o(y')o(\))p Ft(.)14 b(No)o(w)e(w)o(e)h(can)g
(conclude:)100 2086 y Fn(N)19 b(\(gfold)e(h)j(d)f(b)g(u)g(l)g(g\))100
2128 y Ft(=)25 b Fn(N)19 b(\(b)g(\(d)g(\(lab,r\),y\))o(\))100
2169 y Ft(=)25 b Fn(f)19 b(\(M)g(\(d)g(\(lab,r\)\),N)d(y\))120
b Ft(\(2nd)13 b(premise\))100 2211 y(=)25 b Fn(f)19 b(\(e)g(\(lab,N)f
(r\)\),N)f(y\))152 b Ft(\(1st)13 b(premise\))100 2252
y(=)25 b Fn(f)19 b(\(e)g(\(lab,r'\)\),)o(y'\))103 b Ft(\(ind.h)o(yp.)19
b(\(1\),)12 b(\(2\)\))100 2294 y(=)25 b Fn(gfold)18 b(h)h(e)g(f)h(u')e
(l)i(g)383 b Fd(2)-76 2373 y Fe(Pro)q(of)15 b(of)f(Theorem)g(3.)j
Ft(The)c(pro)q(of)g(is)g(b)o(y)g(induction)i(on)e Fn(l)f
Ft(and)-76 2415 y Fn(g)p Ft(.)25 b(F)m(or)15 b(\()p Fn(l)g
Ft(=)g Fn([])o Ft(\))h(and)g(\()p Fn(g)f Ft(=)g Fn(Empty)n
Fo(;)6 b Fn(l)14 b Ft(=)i Fn(x::l')n Ft(\))f(the)h(result)g(of)-76
2456 y Fn(gfold)f Ft(is)i(alw)o(a)o(ys)h Fn(u)o Ft(,)f(and)h(th)o(us)f
(the)g(theorem)g(is)g(true)g(for)g(these)-76 2498 y(cases.)-20
2539 y(Th)o(us)e(consider)g(the)g(case)f(\()p Fn(g)e
Fi(6)p Ft(=)h Fn(Empty)n Fo(;)6 b Fn(l)12 b Ft(=)h Fn(v::l')n
Ft(\).)20 b Fn(gfoldn)-76 2581 y(bwd)13 b Ft(computes)i(a)f(pair)i
Fn(\(x,g1\))11 b Ft(through)16 b(a)e(call)h(to)g Fn(gfold1)i(bwd)p
Ft(.)-76 2622 y(There)h Fn(g)f Ft(can)i(b)q(e)f(written)g(\(due)h(to)e
(activ)o(e)i(pattern)g(matc)o(hing\))1020 -34 y(as)1054
-50 y Fh(3)1083 -34 y Fn(\(p,v,lab,)o(s\))d(&)j(g')11
b Ft(whic)o(h)h(means)g(that)g(the)f(pair)h Fn(\(r,g2\))d
Ft(in)1020 7 y Fn(gfold1)17 b(bwd)10 b Ft(is)j(giv)o(en)f(b)o(y)g(the)g
(expression)h Fn(gfoldn)18 b(bwd)g(d)h(b)g(u)h(p)1020
49 y(g')p Ft(.)27 b(Since)18 b Fn(grev)g(g)e Ft(=)h Fn(\(s,v,lab,)o
(p\))f(&)j(\(grev)f(g'\))d Ft(the)i(corre-)1020 90 y(sp)q(onding)g
Fn(gfold1)12 b Ft(expression)k(caused)f(b)o(y)g Fn(gfold)j(fwd)g(d)h(b)
g(u)h(l)1020 132 y(g)15 b Ft(can)h(b)q(e)g(written)f(as)h
Fn(gfold1)h(fwd)i(d)g(b)g(u)g(v)h(\(\(s,v,lab)o(,p)o(\))d(&)1020
173 y(\(grev)h(g'\)\))10 b Ft(if)i Fn(s)f Ft(do)q(es)h(not)g(con)o
(tain)i Fn(v)o Ft(.)j(\(This)12 b(restriction)i(is)e(nec-)1020
215 y(essary)k(b)q(ecause)f(otherwise)h Fn(v)e Ft(w)o(ould)i(b)q(e)f
(\\mo)o(v)o(ed")h(through)g(the)1020 256 y(matc)o(hing)g(from)e
Fn(s)h Ft(in)o(to)g Fn(p)p Ft(.\))21 b(Then)15 b(the)g(pair)g
Fn(\(r,g2\))e Ft(in)i(the)g(call)1020 298 y Fn(gfold)n(1)k(fwd)10
b Ft(is)j(giv)o(en)f(b)o(y)g(the)g(expression)h Fn(gfoldn)18
b(fwd)g(d)h(b)g(u)h(p)1020 339 y(\(grev)e(g'\))p Ft(.)c(No)o(w)d(the)f
(theorem)h(follo)o(ws)h(b)o(y)f(applying)i(the)e(induc-)1020
381 y(tion)g(h)o(yp)q(othesis)h(to)f Fn(gfoldn)17 b(bwd)h(d)i(b)f(u)g
(p)g(g')9 b Ft(and)i Fn(gfoldn)17 b(fwd)1020 422 y(d)i(b)h(u)f(p)g
(\(grev)f(g'\))12 b Ft(and)h(to)h(the)f(remaining)i(calls)g
Fn(gfoldn)i(fwd)1020 464 y(d)i(b)h(u)f(l')g(\(grev)e(g1\))e
Ft(in)h Fn(gfoldn)n Ft(,)f(resp)q(ectiv)o(ely)m(,)k Fn(gfold)e(bwd)i(d)
1020 505 y(b)g(u)h(l')e(g1)12 b Ft(in)i Fn(gfoldn)j(bwd)p
Ft(.)1076 547 y(If,)33 b(on)d(the)g(other)g(hand,)k Fn(v)29
b Ft(is)h(con)o(tained)i(in)e Fn(s)p Ft(,)j(the)1020
588 y Fn(gfold1)12 b Ft(expression)k(caused)g(b)o(y)e
Fn(gfold)k(fwd)g(d)i(b)f(u)g(l)g(g)14 b Ft(can)h(b)q(e)1020
630 y(written)k(as)f Fn(gfold1)f(fwd)i(d)g(b)g(u)h(v)f(\(\(s',v,la)o
(b,p)o('\))d(&)j(\(grev)1020 671 y(g'\)\))d Ft(where)h
Fn(s')g Ft(is)h(equal)h(to)f Fn(s)e Ft(with)i(all)h(o)q(ccurrences)g
(of)e Fn(v)g Ft(re-)1020 713 y(mo)o(v)o(ed)d(and)g Fn(p')f
Ft(is)h Fn(p)f Ft(with)h(all)h(o)q(ccurrences)f(of)f
Fn(v)g Ft(in)i Fn(s)e Ft(app)q(ended,)1020 754 y(sa)o(y)m(.)22
b(This)16 b(means)f(the)g(pair)h Fn(\(r,g2\))c Ft(in)k(the)f(call)h
Fn(gfold)n(1)j(fwd)14 b Ft(is)1020 796 y(giv)o(en)j(b)o(y)g(the)f
(expression)i Fn(gfoldn)f(fwd)i(d)g(b)g(u)g(p')g(\(grev)f(g'\))p
Ft(.)1020 837 y(The)c(di\013erence)i(to)f(the)f(expression)i(ab)q(o)o
(v)o(e)f(is)g(some)g(o)q(ccurrences)1020 879 y(of)i Fn(v)h
Ft(in)g Fn(p')p Ft(.)30 b(No)o(w)17 b(since)i Fn(v)e
Ft(is)h(not)g(con)o(tained)i(in)e Fn(grev)g(g')f Ft(the)1020
920 y(ev)o(en)o(tually)f(caused)f Fn(gfold1)c Ft(calls)k(with)g
Fn(v)e Ft(will)i(all)g(raise)g(a)e Fn(Match)1020 962
y Ft(exception)18 b(\(whic)o(h)f(are)f(handled)i(b)o(y)e(just)g(mo)o
(ving)h(in)g Fn(p')e Ft(to)h(the)1020 1003 y(next)g(no)q(de\).)25
b(Th)o(us,)15 b(the)h(presence)g(of)f Fn(v)g Ft(in)h
Fn(p')e Ft(has)i(actually)i(no)1020 1045 y(impact)12
b(on)g(the)f(result)h(compared)g(with)g(the)f(corresp)q(onding)j(com-)
1020 1086 y(putation)19 b(using)f Fn(p)p Ft(.)28 b(This)18
b(means)g(that)f Fn(gfoldn)g(fwd)h(d)i(b)f(u)g(p')1020
1128 y(\(grev)f(g'\))e Ft(yields)k(the)e(same)g(result)h(as)f
Fn(gfoldn)g(fwd)g(d)h(b)g(u)h(p)1020 1169 y(\(grev)e(g'\))p
Ft(,)10 b(so)i(w)o(e)f(can)h(again)i(apply)f(the)f(induction)i(h)o(yp)q
(othesis,)1020 1211 y(and)g(the)f(theorem)g(is)h(pro)o(v)o(ed.)517
b Fd(2)1020 1328 y Fn(fun)19 b(id)f(x)i(=)f(x)1020 1370
y(fun)g(p1)f(\(x,_\))g(=)h(x)1020 1411 y(fun)g(forceOpt)d(\(SOME)i(x\))
h(=)g(x)1020 1453 y(fun)g(select)e(_)i(_)g([])98 b(=)19
b([])1040 1494 y(|)39 b(select)17 b(f)i(p)g(\(x::l\))f(=)1099
1536 y(if)g(p)i(x)f(then)f(f)h(x::select)d(f)j(p)h(l)1236
1577 y(else)e(select)f(f)i(p)h(l)1244 1702 y Ft(Figure)14
b(7:)j(Some)c(utilit)o(y)i(functions.)1020 1865 y Fn(signature)h
(FUN_ARRAY)g(=)1020 1906 y(sig)1059 1948 y(type)i('a)h(array)1059
1989 y(val)g(array)155 b(:)19 b(int)f(*)i('a)e(->)h('a)g(array)1059
2031 y(val)g(sub)195 b(:)19 b('a)g(array)e(*)j(int)e(->)h('a)1059
2072 y(val)g(size)175 b(:)19 b('a)g(array)e(->)i(int)1059
2114 y(val)g(update)135 b(:)19 b('a)g(array)e(*)j(int)e(*)h('a)g(->)g
('a)g(array)1059 2155 y(val)g(toImpArra)o(y)56 b(:)19
b('a)g(array)e(->)i('a)g(Array.arra)o(y)1059 2197 y(val)g(fromList)95
b(:)19 b('a)g(list)f(->)h('a)g(array)1059 2238 y(val)g(fromImpAr)o(ra)o
(y)e(:)i('a)g(Array.arr)o(ay)d(->)j('a)g(array)1020 2280
y(end)1162 2404 y Ft(Figure)14 b(8:)j(Op)q(erations)e(on)e(functional)i
(arra)o(ys.)p 1020 2583 399 2 v 1062 2610 a Fh(3)1080
2622 y Fa(The)c(case)f(for)h(the)g(Matc)o(h)g(exception)g(is)h(iden)o
(tical)g(to)f(Theorem)g(2.)951 2747 y Ft(10)p eop
%%Page: 11 11
11 10 bop -76 17 a Fn(structure)16 b(FunArray)h(:)i(FUN_ARRAY)d(=)-76
59 y(struct)-37 142 y(datatype)h('a)i(array)e(=)42 183
y(Root)38 b(of)18 b('a)h(Array.arra)o(y)3 225 y(|)g(Node)38
b(of)18 b(int)h(*)g('a)g(*)g('a)g(array)3 266 y(|)g(Cache)f(of)g(int)h
(*)g('a)g(*)g('a)g(array)f(*)h(bool)f(ref)g(*)i('a)e(Array.array)-37
349 y(fun)h(array)f(\(n,x\))f(=)i(Cache)f(\(0,x,Root)e(\(Array.arr)o
(ay)g(\(n,x\)\),)h(ref)i(true,Arra)o(y.)o(arr)o(ay)d(\(n,x\)\))-37
432 y(fun)j(search)e(\(Cache)g(\(_,_,Root)g(a,_,_\),i)o(\))g(=)i
(Array.sub)d(\(a,i\))-17 474 y(|)39 b(search)17 b(\(Cache)g(\(j,x,)38
b(tree,_,_\))o(,i)o(\))17 b(=)i(if)g(i=j)f(then)g(x)i(else)e(search)f
(\(tree,i\))-17 515 y(|)39 b(search)17 b(\(Node)37 b(\(_,_,Root)17
b(a\),i\))96 b(=)19 b(Array.sub)d(\(a,i\))-17 557 y(|)39
b(search)17 b(\(Node)37 b(\(j,x,)h(tree\),i\))95 b(=)19
b(if)g(i=j)f(then)g(x)i(else)e(search)f(\(tree,i\))-37
640 y(and)i(sub)f(\(tree)g(as)h(Cache)f(\(_,_,_,r)o(ef)e(cache,c\),i)o
(\))h(=)i(if)g(cache)e(then)h(Array.sub)f(\(c,i\))g(else)h(search)g
(\(tree,i\))-17 681 y(|)39 b(sub)18 b(\(tree,i\))f(=)i(search)e
(\(tree,i\))-37 764 y(fun)i(size)f(\(Root)g(a\))234 b(=)19
b(Array.lengt)o(h)d(a)-17 806 y(|)39 b(size)18 b(\(Node)g(\(_,_,a\)\))
114 b(=)19 b(size)f(a)-17 847 y(|)39 b(size)18 b(\(Cache)f(\(_,_,_,_,a)
o(\)\))f(=)j(Array.lengt)o(h)d(a)-37 930 y(fun)j(update)e(\(a)i(as)g
(Cache)f(\(_,_,_,c)o(ach)o(e,)o(c\),)o(i,x)o(\))e(=)42
972 y(if)j(!cache)e(then)h(\(cache)f(:=)i(false;)e(Array.updat)o(e)f
(\(c,i,x\);)h(Cache)h(\(i,x,a,re)o(f)e(true,c\)\))h(else)h(Node)g
(\(i,x,a\))-17 1013 y(|)39 b(update)17 b(\(a,i,x\))g(=)i(Node)f
(\(i,x,a\))-37 1096 y(fun)h(fromList)d(l)k(=)f(Cache)f(\(0,hd)f(l,Root)
g(\(Array.from)o(Li)o(st)f(l\),)j(ref)f(true,Array)o(.fr)o(om)o(Lis)o
(t)e(l\))-37 1179 y(fun)j(fromImpAr)o(ray)d(a)j(=)42
1221 y(let)f(val)h(b)g(=)g(Array.arra)o(y)e(\(Array.l)o(eng)o(th)f
(a,Array.su)o(b)h(\(a,0\)\))61 1262 y(in)i(\(Array.cop)o(y)e({src=a,si)
o(=0)o(,le)o(n=)o(NON)o(E,d)o(st)o(=b,)o(di)o(=0})o(;)g(Cache)g
(\(0,Array.s)o(ub)f(\(a,0\),Root)g(a,ref)i(true,b\)\))42
1304 y(end)-37 1387 y(fun)h(toImpArra)o(y)e(\(Cache)g(\(_,_,Root)f
(a,_,_\)\))h(=)39 b(\(*)19 b(is)f(used)h(only)f(on)g(unchanged)f
(arrays)g(*\))42 1428 y(let)h(val)h(b)g(=)g(Array.arra)o(y)e(\(Array.l)
o(eng)o(th)f(a,Array.su)o(b)h(\(a,0\)\))61 1470 y(in)i(\(Array.cop)o(y)
e({src=a,si)o(=0)o(,le)o(n=)o(NON)o(E,d)o(st)o(=b,)o(di)o(=0})o(;)g
(b\))h(end)-76 1511 y(end)483 1636 y Ft(Figure)c(9:)j(Implemen)o
(tation)f(of)c(functional)k(arra)o(ys)d(with)h(cac)o(he.)-76
1798 y Fn(signature)i(GRAPH)i(=)-76 1839 y(sig)-37 1881
y(eqtype)g(node)g(=)h(int)-37 1922 y(type)f('a)h(context)e(=)i(node)g
(list)f(*)h(node)f(*)h('a)g(*)g(node)f(list)-37 1964
y(type)g('a)h(graph)-37 2005 y(exception)e(Node)-37 2047
y(val)i(empty)116 b(:)19 b(int)f(->)h('a)g(graph)-37
2088 y(val)g(&)196 b(:)19 b('a)g(context)e(*)i('a)g(graph)e(->)i('a)g
(graph)-37 2130 y(val)g(context)76 b(:)19 b(node)f(*)h('a)g(graph)f(->)
g('a)h(context)e(*)i('a)g(graph)-37 2171 y(val)g(matchany)56
b(:)19 b('a)g(graph)e(->)i('a)g(context)e(*)i('a)g(graph)-37
2213 y(val)g(noNodes)76 b(:)19 b('a)g(graph)e(->)i(int)-37
2254 y(val)g(gmap)136 b(:)19 b(\('a)f(->)h('b\))g(->)f('a)h(graph)f(->)
h('b)g(graph)-37 2296 y(val)g(ufold)116 b(:)19 b(\('a)f(context)f(*)i
('b)g(->)g('b\))g(->)f('b)h(->)g('a)g(graph)f(->)g('b)-37
2338 y(val)h(gfold)116 b(:)19 b(\(\(node)e(*)i(int\))f(list)g(*)i(node)
e(*)h('a)g(*)g(\(node)f(*)h(int\))f(list)g(->)h(\(node)f(*)h(int\))f
(list\))g(->)297 2379 y(\('a)g(*)i('b)e(->)h('c\))g(->)f(\('c)h(*)g('b)
g(->)g('b\))f(->)h('b)g(->)g(node)f(list)g(->)h('a)g(graph)e(->)i('b)
-37 2421 y(val)g(mfold)116 b(:)19 b(\('a)f(*)i('b)e(->)h('c\))g(->)f
(\('c)h(*)g('b)g(->)g('b\))f(->)h('b)g(->)g(node)f(list)g(->)h('a)g
(graph)e(->)i('b)-76 2462 y(end)600 2587 y Ft(Figure)14
b(10:)j(Op)q(erations)e(on)e(functional)j(graphs.)951
2747 y(11)p eop
%%Page: 12 12
12 11 bop -76 -8 a Fn(functor)17 b(Graph)h(\(FunArray)o(:FU)o(N_)o(ARR)
o(AY)o(\))f(:)i(GRAPH)f(=)-76 33 y(struct)-37 116 y(type)g(node)h(=)g
(int)-37 158 y(type)f('a)h(context)e(=)i(node)g(list)f(*)h(node)f(*)h
('a)g(*)g(node)f(list)-37 199 y(exception)f(Node)-37
241 y(exception)g(Edge)-37 324 y(\(*)i(additional)d(array)i(functions)e
(*\))-37 365 y(open)i(FunArray)-37 407 y(fun)h(apply)f(\(a,i,f\))75
b(=)20 b(update)d(\(a,i,f)g(\(sub)h(\(a,i\)\)\))-37 448
y(fun)h(firstInde)o(x)e(\(a,p\))g(=)j(let)e(fun)g(scan)g(\(i,p\))g(=)h
(if)g(p)g(\(sub)g(\(a,i\)\))e(then)h(i)h(else)f(scan)g(\(i+1,p\))434
490 y(in)h(scan)f(\(0,p\))g(end)-37 531 y(fun)h(arrayToLi)o(st)d(f)j(a)
h(=)f(let)f(fun)h(list)f(\(f,a,i,n\))e(=)j(if)g(i<n)g(then)f(f)h(\(sub)
f(\(a,i\)\)::l)o(ist)e(\(f,a,i+1,)o(n\))g(else)i([])415
573 y(in)g(list)g(\(f,a,0,size)e(a\))j(end)-37 614 y(fun)g(impArrayT)o
(oLi)o(st)d(a)j(=)h(let)e(fun)g(list)g(\(a,i,n\))f(=)j(if)e(i<n)h(then)
f(Array.sub)e(\(a,i\)::lis)o(t)g(\(a,i+1,n\))h(else)h([])434
656 y(in)h(list)f(\(a,0,Array)o(.l)o(eng)o(th)e(a\))j(end)-37
739 y(\(*)g(stamp)f(type)g(and)g(operations)e(*\))-37
780 y(type)i(stamp)g(=)h(int)-37 822 y(fun)g(stampTrue)36
b(i)19 b(=)g(abs)g(i+1)-37 863 y(fun)g(stampFals)o(e)e(i)i(=)g(~\(abs)f
(i+1\))-37 905 y(fun)h(getStamp)d(\(na,n\))77 b(=)19
b(sub)f(\(na,n\))-37 946 y(fun)h(getNegSta)o(mp)d(\(na,n\))i(=)h(let)f
(val)h(s=sub)e(\(na,n\))473 988 y(in)i(if)g(s>0)f(then)h(raise)e(Node)h
(else)g(s)i(end)-37 1029 y(fun)f(getPosSta)o(mp)d(\(na,n\))i(=)h(let)f
(val)h(s=sub)e(\(na,n\))473 1071 y(in)i(if)g(s<=0)f(then)g(raise)g
(Edge)g(else)g(s)h(end)-37 1154 y(datatype)e('a)i(graph)e(=)j(Empty)d
(of)i(int)316 1195 y(|)h(Full)37 b(of)78 b(stamp)18 b(array)f(*)j('a)e
(array)532 1237 y(*)h(\(node)f(*)h(stamp\))f(list)g(array)57
b(\(*)18 b(pred)h(*\))532 1278 y(*)g(\(node)f(*)h(stamp\))f(list)g
(array)57 b(\(*)18 b(suc)39 b(*\))-37 1361 y(\(*)19 b(basic)f(graph)g
(operation)o(s)e(*\))-37 1403 y(fun)j(empty)f(n)h(=)g(Empty)f(n)-37
1486 y(infixr)g(5)h(&)-37 1528 y(fun)g(\(pred,n,l)o(,su)o(c\))o(&\(E)o
(mpt)o(y)d(i\))j(=)42 1569 y(\(pred,n,l)o(,su)o(c\))o(&\(F)o(ull)d
(\(array)h(\(i,0\),arra)o(y)f(\(i,l\),array)g(\(i,[]\),ar)o(ray)g
(\(i,[]\)\)\))-17 1611 y(|)39 b(\(pred,n,l)o(,su)o(c\))o(&\(F)o(ull)16
b(\(na,la,pa)o(,s)o(a\)\))g(=)42 1652 y(let)i(val)h(stampN)115
b(=)19 b(stampTrue)d(\(getNegStam)o(p)g(\(na,n\)\))120
1694 y(val)j(stampedPr)o(ed)d(=)j(map)g(\(fn)f(x=>\(x,getP)o(osS)o(ta)o
(mp)e(\(na,x\)\)\))h(pred)120 1735 y(val)i(stampedSu)o(c)36
b(=)19 b(map)g(\(fn)f(x=>\(x,getP)o(osS)o(ta)o(mp)e(\(na,x\)\)\))h(suc)
120 1777 y(fun)i(updAdj)e(\(a,[]\))57 b(=)19 b(a)140
1818 y(|)39 b(updAdj)17 b(\(a,v::l\))g(=)i(updAdj)e(\(apply)g(\(a,v,fn)
g(adj=>\(n,st)o(amp)o(N\):)o(:a)o(dj\))o(,l)o(\))61 1860
y(in)120 1901 y(Full)h(\(update)f(\(na,n,stam)o(pN\))o(,u)o(pda)o(te)f
(\(la,n,l\),)238 1943 y(updAdj)h(\(update)g(\(pa,n,stam)o(ped)o(Pr)o
(ed\))o(,s)o(uc\))o(,up)o(dA)o(dj)f(\(update)h(\(sa,n,stam)o(pe)o(dSu)o
(c\),)o(pr)o(ed\))o(\))42 1984 y(end)-37 2067 y(fun)i(context)e
(\(n,Empty)f(_\))j(=)g(raise)f(Match)-17 2109 y(|)39
b(context)17 b(\(n,Full)g(\(na,la,pr)o(ed)o(,su)o(c\))o(\))g(=)42
2150 y(if)i(getStamp)d(\(na,n\)>0)h(then)101 2192 y(\(\(select)f(p1)j
(\(fn)g(\(v,i\)=>i)o(=ge)o(tS)o(tam)o(p)e(\(na,v\)\))f(\(sub)j
(\(pred,n\))o(\),n)o(,su)o(b)d(\(la,n\),)140 2233 y(select)h(p1)i(\(fn)
g(\(v,i\)=>i)o(=ge)o(tS)o(tam)o(p)e(\(na,v\)\))f(\(sub)j(\(suc,n\)\))o
(\),)120 2275 y(Full)f(\(apply)g(\(na,n,sta)o(mp)o(Fal)o(se)o(\),l)o
(a,p)o(re)o(d,s)o(uc)o(\)\))42 2316 y(else)101 2358 y(raise)f(Match)-37
2441 y(fun)i(matchany)d(\(Empty)i(_\))h(=)g(raise)e(Match)-17
2482 y(|)39 b(matchany)16 b(\(g)j(as)g(\(Full)f(\(na,la,pr)o(ed)o(,su)o
(c\)\))o(\))e(=)218 2524 y(\(context)h(\(firstInd)o(ex)f(\(na,fn)i
(i=>i>0\),)o(g\))e(handle)i(Subscript)e(=>)j(raise)e(Match\))517
2648 y Ft(Figure)d(11:)j(F)m(unctional)e(graph)f(implemen)o(tation)i
(\(P)o(art)d(1\).)951 2747 y(12)p eop
%%Page: 13 13
13 12 bop -17 223 a Fn(fun)18 b(noNodes)f(\(Empty)h(_\))175
b(=)20 b(0)3 265 y(|)38 b(noNodes)17 b(\(Full)h(\(na,_,_,_\))o(\))e(=)k
(size)e(na)-17 348 y(fun)g(gmap)h(f)g(\(Empty)e(i\))i(=)g(Empty)f(i)3
389 y(|)38 b(gmap)19 b(f)g(\(Full)e(\(na,la,pa,s)o(a\))o(\))g(=)61
431 y(let)i(val)f(x)i(=)f(f)g(\(sub)f(\(la,0\)\))140
472 y(val)g(n)i(=)f(ref)f(\(size)g(la\))140 514 y(val)g(L)i(=)f
(Array.arr)o(ay)d(\(!n,x\))140 555 y(val)i(_)i(=)f(while)f(\(!n>0\))f
(do)i(\(n)f(:=)h(!n-1;Array)o(.up)o(dat)o(e)d(\(L,!n,f)h(\(sub)h
(\(la,!n\)\)\)\))81 597 y(in)140 638 y(Full)g(\(na,fromIm)o(pA)o(rra)o
(y)e(L,pa,sa\))61 680 y(end)-37 763 y(\(*)j(predefined)d(fold)i
(operations)e(*\))-37 804 y(fun)j(ufold)f(f)h(u)g(\(Empty)e(_\))i(=)g
(u)-17 846 y(|)39 b(ufold)18 b(f)h(u)g(\(Full)f(\(na,la,pr)o(ed)o(,su)o
(c\))o(\))f(=)42 887 y(let)h(val)h(V)g(=)g(toImpArray)d(na)120
929 y(val)j(n)g(=)g(Array.leng)o(th)d(V)120 970 y(fun)j(ufoldi)e(x)i(=)
199 1012 y(if)g(x<n)f(then)258 1053 y(let)g(val)h(c)g(=)g(\(select)e
(p1)i(\(fn)f(\(v,_\)=>Arr)o(ay.)o(su)o(b)f(\(V,v\)>0\))f(\(sub)i
(\(pred,x\)\),)513 1095 y(x,sub)f(\(la,x\),)513 1136
y(select)g(p1)i(\(fn)f(\(v,i\)=>Arr)o(ay.)o(su)o(b)f(\(V,v\)>0\))f
(\(sub)i(\(suc,x\)\)\))336 1178 y(val)h(_)g(=)g(Array.upd)o(ate)d
(\(V,x,~1\))336 1219 y(val)j(r)g(=)g(ufoldi)e(\(x+1\))277
1261 y(in)i(f)g(\(c,r\))f(end)218 1302 y(else)277 1344
y(u)81 1385 y(in)h(ufoldi)e(0)i(end)-37 1468 y(fun)g(gfold)f(f)h(d)g(b)
g(u)g(l)h(\(Empty)d(_\))i(=)g(u)-17 1510 y(|)39 b(gfold)18
b(f)h(d)g(b)g(u)g(l)h(\(Full)d(\(na,la,pre)o(d,s)o(uc\))o(\))f(=)42
1551 y(let)i(val)h(V)g(=)g(toImpArray)d(na)120 1593 y(fun)j(gfold1)e(v)
i(=)h(\(Array.u)o(pda)o(te)c(\(V,v,~1\);)434 1634 y(let)j(val)f(l=sub)g
(\(la,v\))454 1676 y(in)513 1717 y(d)h(\(l,gfoldn)d(\(f)j(\(sub)f
(\(pred,v\),)o(v,l)o(,s)o(ub)e(\(suc,v\)\)\)\))434 1759
y(end\))120 1800 y(and)j(gfoldn)e([])176 b(=)19 b(u)140
1842 y(|)39 b(gfoldn)17 b(\(\(v,i\)::l\))f(=)199 1883
y(let)i(val)h(j)g(=)g(Array.sub)d(\(V,v\))218 1925 y(in)277
1967 y(if)j(j<0)g(orelse)e(i<>j)h(then)g(gfoldn)f(l)i(else)g(b)g
(\(gfold1)e(v,gfoldn)f(l\))199 2008 y(end)120 2050 y(and)j(gfoldm)e([])
97 b(=)20 b(u)140 2091 y(|)39 b(gfoldm)17 b(\(v::l\))g(=)j(if)e
(Array.sub)f(\(V,v\)<0)f(then)j(gfoldm)e(l)924 2133 y(else)i(b)g
(\(gfold1)e(v,gfoldm)f(l\))81 2174 y(in)140 2216 y(gfoldm)h(l)61
2257 y(end)517 2382 y Ft(Figure)d(12:)j(F)m(unctional)e(graph)f
(implemen)o(tation)i(\(P)o(art)d(2\).)951 2747 y(13)p
eop
%%Page: 14 14
14 13 bop -37 8 a Fn(fun)19 b(mfold)f(d)h(b)g(u)g(l)g(\(Empty)f(_\))h
(=)g(u)-17 49 y(|)39 b(mfold)18 b(d)h(b)g(u)g(l)g(\(Full)f(\(na,la,pre)
o(d,)o(suc)o(\)\))e(=)42 91 y(let)i(val)h(V)g(=)g(toImpArray)d(na)120
132 y(val)j(n)g(=)g(Array.leng)o(th)d(V)120 174 y(val)j(U)g(=)g
(Array.arra)o(y)e(\(n,false)o(\))120 215 y(val)i(L)g(=)g(Array.arra)o
(y)e(\(n,NONE\))120 257 y(exception)f(NotFound)120 298
y(fun)j(e2word)e(\(v,w\))h(=)h(Word.from)o(Int)d(\(v*5+w\))120
340 y(val)j(E)g(=)g(HashTable.)o(mkT)o(ab)o(le)d(\(e2word,fn)g
(\(v,w\)=>v=w)o(\))g(\(5*n+1,NotF)o(ou)o(nd\))120 381
y(fun)j(mfold1)e(\(pred,v\))g(=)199 423 y(\(case)g(pred)i(of)f(SOME)g
(z)i(=>)e(HashTable.i)o(ns)o(ert)e(E)j(\(\(z,v\),tru)o(e\))d(|)j(NONE)f
(=>)h(\(\);)218 464 y(if)g(Array.sub)d(\(U,v\))i(then)g(forceOpt)f
(\(Array.su)o(b)f(\(L,v\)\))218 506 y(else)i(\(Array.upda)o(te)e
(\(U,v,true\))o(;)336 547 y(let)j(val)f(x=d)g(\(sub)g(\(la,v\),mfol)o
(dn)e(\(v,sub)h(\(suc,v\)\)\))356 589 y(in)i(\(Array.u)o(pda)o(te)d
(\(L,v,SOME)g(x\);)j(x\))g(end\)\))120 630 y(and)g(mfoldn)e(\(_,[]\))
135 b(=)19 b(u)140 672 y(|)39 b(mfoldn)17 b(\(z,\(v,i\)::)o(l\))f(=)199
713 y(let)i(val)h(j)g(=)g(Array.sub)d(\(V,v\))277 755
y(val)j(e)g(=)g(getOpt)e(\(HashTable.)o(fi)o(nd)f(E)j(\(z,v\),false)o
(\))218 796 y(in)277 838 y(if)g(j<0)g(orelse)e(i<>j)h(orelse)f(e)i
(then)f(mfoldn)g(\(z,l\))277 879 y(else)g(b)i(\(mfold1)c(\(SOME)i
(z,v\),mfold)o(n)e(\(z,l\)\))199 921 y(end)120 962 y(and)j(mfoldm)e([])
97 b(=)20 b(u)140 1004 y(|)39 b(mfoldm)17 b(\(v::l\))g(=)j(if)e
(Array.sub)f(\(V,v\)<0)f(then)j(mfoldm)e(l)i(else)f(b)h(\(mfold1)e
(\(NONE,v\),m)o(fol)o(dm)f(l\))81 1045 y(in)140 1087
y(mfoldm)h(l)61 1128 y(end)-76 1170 y(end)i(\(*)f(functor)f(Graph)h
(*\))517 1295 y Ft(Figure)c(13:)j(F)m(unctional)e(graph)f(implemen)o
(tation)i(\(P)o(art)d(3\).)-76 1437 y Fn(fun)19 b(dfs')f(d)h(b)g(u)g
(\(N,Suc\))e(=)3 1478 y(let)h(val)h(V)g(=)g(Array.arra)o(y)d
(\(Array.len)o(gth)g(N,false\))81 1520 y(fun)j(dfs1)f(v)h(=)g
(\(Array.upd)o(at)o(e)e(\(V,v,true)o(\);)f(d)j(\(Array.sub)d
(\(N,v\),dfsn)g(\(Array.su)o(b)g(\(Suc,v\)\)\)\))81 1561
y(and)j(dfsn)f([])97 b(=)19 b(u)101 1603 y(|)39 b(dfsn)18
b(\(v::l\))f(=)i(if)g(Array.sub)d(\(V,v\))i(then)g(dfsn)g(l)h(else)f(b)
h(\(dfs1)f(v,dfsn)f(l\))22 1644 y(in)i(dfsn)f(\(List.tabu)o(lat)o(e)e
(\(Array.len)o(gth)g(N-1,id\)\))g(end)-76 1686 y(fun)j(dfs)f(g)h(=)h
(dfs')e(Branch)f(\(op)h(::\))h([])g(g)-76 1769 y(fun)g(evaldag)e
(\(N,Suc\))f(=)3 1810 y(let)i(val)h(R)g(=)g(Array.arra)o(y)d
(\(Array.len)o(gth)g(N,Array.s)o(ub)g(\(N,0\)\))81 1852
y(val)j(_)g(=)g(Array.copy)d({src=N,si)o(=0)o(,le)o(n=N)o(ON)o(E,d)o
(st)o(=R,)o(di=)o(0})o(;)81 1893 y(fun)j(eval1)e(v)i(=)160
1935 y(case)f(Array.sub)e(\(R,v\))h(of)258 1976 y(CON)h(i)h(=>)g(i)218
2018 y(|)h(OP)38 b(f)19 b(=>)g(let)g(val)f(result)f(=)j(f)f(\(\(fn)f
([x,y])g(=>)g(\(x,y\)\))g(\(evaln)f(\(Array.su)o(b)g(\(Suc,v\)\)\))o
(\))454 2059 y(in)i(\(Array.u)o(pda)o(te)d(\(R,v,CON)h(result\);r)o(es)
o(ult)o(\))g(end)81 2101 y(and)i(evaln)e([])98 b(=)19
b([])101 2142 y(|)39 b(evaln)17 b(\(x::l\))h(=)h(eval1)e(x::evaln)g(l)
22 2184 y(in)i(evaln)f(\(roots)f(\(N,Suc\)\))g(end)-76
2267 y(fun)i(grev)f(\(N,Suc\))f(=)3 2308 y(let)h(val)h(R)g(=)g
(Array.arra)o(y)d(\(Array.len)o(gth)g(N,[]:int)g(list\))81
2350 y(fun)j(scan)f(\(i,[]\))56 b(=)19 b(\(\))101 2391
y(|)39 b(scan)18 b(\(i,v::l\))e(=)j(\(Array.upd)o(ate)d(\(R,v,i::A)o
(rra)o(y.s)o(ub)g(\(R,v\)\);)h(scan)h(\(i,l\)\))81 2433
y(val)h(_)g(=)g(Array.appi)d(scan)i(\(Suc,0,NO)o(NE\))22
2474 y(in)h(\(N,R\))f(end)631 2599 y Ft(Figure)c(14:)j(Imp)q(erativ)o
(e)e(graph)e(algorithms.)951 2747 y(14)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
